<html><head></head><body><div hidden="" by-polymer-bundler=""><dom-module id="paper-toast" assetpath="../bower_components/paper-toast/"><template><style>:host{display:block;position:fixed;background-color:var(--paper-toast-background-color, #323232);color:var(--paper-toast-color, #f1f1f1);min-height:48px;min-width:288px;padding:16px 24px;box-sizing:border-box;box-shadow:0 2px 5px 0 rgba(0, 0, 0, 0.26);border-radius:2px;margin:12px;font-size:14px;cursor:default;-webkit-transition:-webkit-transform 0.3s, opacity 0.3s;transition:transform 0.3s, opacity 0.3s;opacity:0;-webkit-transform:translateY(100px);transform:translateY(100px);@apply --paper-font-common-base;}:host(.capsule){border-radius:24px;}:host(.fit-bottom){width:100%;min-width:0;border-radius:0;margin:0;}:host(.paper-toast-open){opacity:1;-webkit-transform:translateY(0px);transform:translateY(0px);}</style><span id="label">{{text}}</span><slot></slot></template><script>(function(){'use strict';var a=null;Polymer({is:'paper-toast',behaviors:[Polymer.IronOverlayBehavior],properties:{fitInto:{type:Object,value:window,observer:'_onFitIntoChanged'},horizontalAlign:{type:String,value:'left'},verticalAlign:{type:String,value:'bottom'},duration:{type:Number,value:3e3},text:{type:String,value:''},noCancelOnOutsideClick:{type:Boolean,value:!0},noAutoFocus:{type:Boolean,value:!0}},listeners:{transitionend:'__onTransitionEnd'},get visible(){return Polymer.Base._warn('`visible` is deprecated, use `opened` instead'),this.opened},get _canAutoClose(){return 0<this.duration&&this.duration!==Infinity},created:function(){this._autoClose=null,Polymer.IronA11yAnnouncer.requestAvailability()},show:function(c){for(var d in'string'==typeof c&&(c={text:c}),c)0===d.indexOf('_')?Polymer.Base._warn('The property "'+d+'" is private and was not set.'):d in this?this[d]=c[d]:Polymer.Base._warn('The property "'+d+'" is not valid.');this.open()},hide:function(){this.close()},__onTransitionEnd:function(c){c&&c.target===this&&'opacity'===c.propertyName&&(this.opened?this._finishRenderOpened():this._finishRenderClosed())},_openedChanged:function(){null!==this._autoClose&&(this.cancelAsync(this._autoClose),this._autoClose=null),this.opened?(a&&a!==this&&a.close(),a=this,this.fire('iron-announce',{text:this.text}),this._canAutoClose&&(this._autoClose=this.async(this.close,this.duration))):a===this&&(a=null),Polymer.IronOverlayBehaviorImpl._openedChanged.apply(this,arguments)},_renderOpened:function(){this.classList.add('paper-toast-open')},_renderClosed:function(){this.classList.remove('paper-toast-open')},_onFitIntoChanged:function(c){this.positionTarget=c}})})();</script></dom-module><dom-module id="pouchdb"><script>(function(E){if("object"===("undefined"===typeof exports?"undefined":babelHelpers.typeof(exports))&&"undefined"!==typeof module)module.exports=E();else if("function"===typeof define&&define.amd)define([],E);else{var w;w="undefined"===typeof window?"undefined"===typeof global?"undefined"===typeof self?this:self:global:window,w.PouchDB=E()}})(function(){var E;return function C(L,O,D){function I($,P){if(!O[$]){if(!L[$]){var F="function"==typeof require&&require;if(!P&&F)return F($,!0);if(N)return N($,!0);var B=new Error("Cannot find module '"+$+"'");throw B.code="MODULE_NOT_FOUND",B}var U=O[$]={exports:{}};L[$][0].call(U.exports,function(M){var W=L[$][1][M];return I(W?W:M)},U,U.exports,C,L,O,D)}return O[$].exports}for(var N="function"==typeof require&&require,R=0;R<D.length;R++)I(D[R]);return I}({1:[function(C,L){"use strict";L.exports=function(I){return function(){var N=arguments.length;if(N){for(var R=[],$=-1;++$<N;)R[$]=arguments[$];return I.call(this,R)}return I.call(this,[])}}},{}],2:[function(C,L,O){(function(D){function P(){var B;try{B=O.storage.debug}catch(U){}return!B&&"undefined"!==typeof D&&"env"in D&&(B=D.env.DEBUG),B}O=L.exports=C(3),O.log=function(){return"object"===("undefined"===typeof console?"undefined":babelHelpers.typeof(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},O.formatArgs=function(B){var U=this.useColors;if(B[0]=(U?"%c":"")+this.namespace+(U?" %c":" ")+B[0]+(U?"%c ":" ")+"+"+O.humanize(this.diff),!!U){var M="color: "+this.color;B.splice(1,0,M,"color: inherit");var W=0,H=0;B[0].replace(/%[a-zA-Z%]/g,function(z){"%%"===z||(W++,"%c"===z&&(H=W))}),B.splice(H,0,M)}},O.save=function(B){try{null==B?O.storage.removeItem("debug"):O.storage.debug=B}catch(U){}},O.load=P,O.useColors=function(){return"undefined"!==typeof window&&window&&"undefined"!==typeof window.process&&"renderer"===window.process.type||"undefined"!==typeof document&&document&&"WebkitAppearance"in document.documentElement.style||"undefined"!==typeof window&&window&&window.console&&(console.firebug||console.exception&&console.table)||"undefined"!==typeof navigator&&navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!==typeof navigator&&navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},O.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(B){}}(),O.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],O.formatters.j=function(B){try{return JSON.stringify(B)}catch(U){return"[UnexpectedJSONParseError]: "+U.message}},O.enable(P())}).call(this,C(9))},{3:3,9:9}],3:[function(C,L,O){function D(B){var U=0,M;for(M in B)U=(U<<5)-U+B.charCodeAt(M),U|=0;return O.colors[Math.abs(U)%O.colors.length]}function I(B){function U(){if(U.enabled){var M=U,W=+new Date,H=W-(F||W);M.diff=H,M.prev=F,M.curr=W,F=W;for(var z=Array(arguments.length),X=0;X<z.length;X++)z[X]=arguments[X];z[0]=O.coerce(z[0]),"string"!==typeof z[0]&&z.unshift("%O");var G=0;z[0]=z[0].replace(/%([a-zA-Z%])/g,function(K,Q){if("%%"===K)return K;G++;var J=O.formatters[Q];if("function"===typeof J){var Y=z[G];K=J.call(M,Y),z.splice(G,1),G--}return K}),O.formatArgs.call(M,z);var V=U.log||O.log||console.log.bind(console);V.apply(M,z)}}return U.namespace=B,U.enabled=O.enabled(B),U.useColors=O.useColors(),U.color=D(B),"function"===typeof O.init&&O.init(U),U}O=L.exports=I.debug=I["default"]=I,O.coerce=function(B){return B instanceof Error?B.stack||B.message:B},O.disable=function(){O.enable("")},O.enable=function(B){O.save(B),O.names=[],O.skips=[];for(var U=("string"===typeof B?B:"").split(/[\s,]+/),M=U.length,W=0;W<M;W++)U[W]&&(B=U[W].replace(/\*/g,".*?"),"-"===B[0]?O.skips.push(new RegExp("^"+B.substr(1)+"$")):O.names.push(new RegExp("^"+B+"$")))},O.enabled=function(B){var U,M;for(U=0,M=O.skips.length;U<M;U++)if(O.skips[U].test(B))return!1;for(U=0,M=O.names.length;U<M;U++)if(O.names[U].test(B))return!0;return!1},O.humanize=C(8),O.names=[],O.skips=[],O.formatters={};var F},{8:8}],4:[function(C,L){function D(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function I(P){return"function"===typeof P}function N(P){return"number"===typeof P}function R(P){return"object"===("undefined"===typeof P?"undefined":babelHelpers.typeof(P))&&null!==P}function $(P){return void 0===P}L.exports=D,D.EventEmitter=D,D.prototype._events=void 0,D.prototype._maxListeners=void 0,D.defaultMaxListeners=10,D.prototype.setMaxListeners=function(P){if(!N(P)||0>P||isNaN(P))throw TypeError("n must be a positive number");return this._maxListeners=P,this},D.prototype.emit=function(P){var F,B,U,M,W,H;if(this._events||(this._events={}),"error"===P&&(!this._events.error||R(this._events.error)&&!this._events.error.length))if(F=arguments[1],F instanceof Error)throw F;else{var z=new Error("Uncaught, unspecified \"error\" event. ("+F+")");throw z.context=F,z}if(B=this._events[P],$(B))return!1;if(I(B))switch(arguments.length){case 1:B.call(this);break;case 2:B.call(this,arguments[1]);break;case 3:B.call(this,arguments[1],arguments[2]);break;default:M=Array.prototype.slice.call(arguments,1),B.apply(this,M);}else if(R(B))for(M=Array.prototype.slice.call(arguments,1),H=B.slice(),U=H.length,W=0;W<U;W++)H[W].apply(this,M);return!0},D.prototype.addListener=function(P,F){var B;if(!I(F))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",P,I(F.listener)?F.listener:F),this._events[P]?R(this._events[P])?this._events[P].push(F):this._events[P]=[this._events[P],F]:this._events[P]=F,R(this._events[P])&&!this._events[P].warned&&(B=$(this._maxListeners)?D.defaultMaxListeners:this._maxListeners,B&&0<B&&this._events[P].length>B&&(this._events[P].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[P].length),"function"===typeof console.trace&&console.trace())),this},D.prototype.on=D.prototype.addListener,D.prototype.once=function(P,F){function B(){this.removeListener(P,B),U||(U=!0,F.apply(this,arguments))}if(!I(F))throw TypeError("listener must be a function");var U=!1;return B.listener=F,this.on(P,B),this},D.prototype.removeListener=function(P,F){var B,U,M,W;if(!I(F))throw TypeError("listener must be a function");if(!this._events||!this._events[P])return this;if(B=this._events[P],M=B.length,U=-1,B===F||I(B.listener)&&B.listener===F)delete this._events[P],this._events.removeListener&&this.emit("removeListener",P,F);else if(R(B)){for(W=M;0<W--;)if(B[W]===F||B[W].listener&&B[W].listener===F){U=W;break}if(0>U)return this;1===B.length?(B.length=0,delete this._events[P]):B.splice(U,1),this._events.removeListener&&this.emit("removeListener",P,F)}return this},D.prototype.removeAllListeners=function(P){var F,B;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[P]&&delete this._events[P],this;if(0===arguments.length){for(F in this._events)"removeListener"!==F&&this.removeAllListeners(F);return this.removeAllListeners("removeListener"),this._events={},this}if(B=this._events[P],I(B))this.removeListener(P,B);else if(B)for(;B.length;)this.removeListener(P,B[B.length-1]);return delete this._events[P],this},D.prototype.listeners=function(P){var F;return F=this._events&&this._events[P]?I(this._events[P])?[this._events[P]]:this._events[P].slice():[],F},D.prototype.listenerCount=function(P){if(this._events){var F=this._events[P];if(I(F))return 1;if(F)return F.length}return 0},D.listenerCount=function(P,F){return P.listenerCount(F)}},{}],5:[function(C,L){(function(D){"use strict";function I(){M=!0;for(var X=W.length,H,z;X;){for(z=W,W=[],H=-1;++H<X;)z[H]();X=W.length}M=!1}var R=D.MutationObserver||D.WebKitMutationObserver,$;if(R){var P=0,F=new R(I),B=D.document.createTextNode("");F.observe(B,{characterData:!0}),$=function(){B.data=P=++P%2}}else if(!D.setImmediate&&"undefined"!==typeof D.MessageChannel){var U=new D.MessageChannel;U.port1.onmessage=I,$=function(){U.port2.postMessage(0)}}else $="document"in D&&"onreadystatechange"in D.document.createElement("script")?function(){var z=D.document.createElement("script");z.onreadystatechange=function(){I(),z.onreadystatechange=null,z.parentNode.removeChild(z),z=null},D.document.documentElement.appendChild(z)}:function(){setTimeout(I,0)};var M,W=[];L.exports=function(H){1!==W.push(H)||M||$()}}).call(this,"undefined"===typeof global?"undefined"===typeof self?"undefined"===typeof window?{}:window:self:global)},{}],6:[function(C,L){L.exports="function"===typeof Object.create?function(I,N){I.super_=N,I.prototype=Object.create(N.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}})}:function(I,N){I.super_=N;var R=function(){};R.prototype=N.prototype,I.prototype=new R,I.prototype.constructor=I}},{}],7:[function(C,L){"use strict";function D(){}function I(K){if("function"!==typeof K)throw new TypeError("resolver must be a function");this.state=V,this.queue=[],this.outcome=void 0,K!==D&&P(this,K)}function N(K,Q,J){this.promise=K,"function"===typeof Q&&(this.onFulfilled=Q,this.callFulfilled=this.otherCallFulfilled),"function"===typeof J&&(this.onRejected=J,this.callRejected=this.otherCallRejected)}function R(K,Q,J){H(function(){var Y;try{Y=Q(J)}catch(Z){return z.reject(K,Z)}Y===K?z.reject(K,new TypeError("Cannot resolve promise with itself")):z.resolve(K,Y)})}function $(K){var Q=K&&K.then;if(K&&("object"===("undefined"===typeof K?"undefined":babelHelpers.typeof(K))||"function"===typeof K)&&"function"===typeof Q)return function(){Q.apply(K,arguments)}}function P(K,Q){function J(se){te||(te=!0,z.reject(K,se))}function Y(se){te||(te=!0,z.resolve(K,se))}var te=!1,ne=F(function(){Q(Y,J)});"error"===ne.status&&J(ne.value)}function F(K,Q){var J={};try{J.value=K(Q),J.status="success"}catch(Y){J.status="error",J.value=Y}return J}var H=C(5),z={},X=["REJECTED"],G=["FULFILLED"],V=["PENDING"];L.exports=I,I.prototype["catch"]=function(K){return this.then(null,K)},I.prototype.then=function(K,Q){if("function"!==typeof K&&this.state===G||"function"!==typeof Q&&this.state===X)return this;var J=new this.constructor(D);if(this.state!==V){var Y=this.state===G?K:Q;R(J,Y,this.outcome)}else this.queue.push(new N(J,K,Q));return J},N.prototype.callFulfilled=function(K){z.resolve(this.promise,K)},N.prototype.otherCallFulfilled=function(K){R(this.promise,this.onFulfilled,K)},N.prototype.callRejected=function(K){z.reject(this.promise,K)},N.prototype.otherCallRejected=function(K){R(this.promise,this.onRejected,K)},z.resolve=function(K,Q){var J=F($,Q);if("error"===J.status)return z.reject(K,J.value);var Y=J.value;if(Y)P(K,Y);else{K.state=G,K.outcome=Q;for(var Z=-1,te=K.queue.length;++Z<te;)K.queue[Z].callFulfilled(Q)}return K},z.reject=function(K,Q){K.state=X,K.outcome=Q;for(var J=-1,Y=K.queue.length;++J<Y;)K.queue[J].callRejected(Q);return K},I.resolve=function(K){return K instanceof this?K:z.resolve(new this(D),K)},I.reject=function(K){var Q=new this(D);return z.reject(Q,K)},I.all=function(K){function Q(oe,ie){J.resolve(oe).then(function(ce){te[ie]=ce,++ne!==Y||Z||(Z=!0,z.resolve(ae,te))},function(ce){Z||(Z=!0,z.reject(ae,ce))})}var J=this;if("[object Array]"!==Object.prototype.toString.call(K))return this.reject(new TypeError("must be an array"));var Y=K.length,Z=!1;if(!Y)return this.resolve([]);for(var te=Array(Y),ne=0,se=-1,ae=new this(D);++se<Y;)Q(K[se],se);return ae},I.race=function(K){function Q(se){J.resolve(se).then(function(ae){Z||(Z=!0,z.resolve(ne,ae))},function(ae){Z||(Z=!0,z.reject(ne,ae))})}var J=this;if("[object Array]"!==Object.prototype.toString.call(K))return this.reject(new TypeError("must be an array"));var Y=K.length,Z=!1;if(!Y)return this.resolve([]);for(var te=-1,ne=new this(D);++te<Y;)Q(K[te]);return ne}},{5:5}],8:[function(C,L){function D(M){if(M+="",!(1e4<M.length)){var W=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(M);if(W){var H=parseFloat(W[1]),z=(W[2]||"ms").toLowerCase();return"years"===z||"year"===z||"yrs"===z||"yr"===z||"y"===z?H*U:"days"===z||"day"===z||"d"===z?H*B:"hours"===z||"hour"===z||"hrs"===z||"hr"===z||"h"===z?H*F:"minutes"===z||"minute"===z||"mins"===z||"min"===z||"m"===z?H*P:"seconds"===z||"second"===z||"secs"===z||"sec"===z||"s"===z?H*$:"milliseconds"===z||"millisecond"===z||"msecs"===z||"msec"===z||"ms"===z?H:void 0}}}function I(M){return M>=B?Math.round(M/B)+"d":M>=F?Math.round(M/F)+"h":M>=P?Math.round(M/P)+"m":M>=$?Math.round(M/$)+"s":M+"ms"}function N(M){return R(M,B,"day")||R(M,F,"hour")||R(M,P,"minute")||R(M,$,"second")||M+" ms"}function R(M,W,H){return M<W?void 0:M<1.5*W?Math.floor(M/W)+" "+H:Math.ceil(M/W)+" "+H+"s"}var $=1e3,P=60*$,F=60*P,B=24*F,U=365.25*B;L.exports=function(M,W){W=W||{};var H="undefined"===typeof M?"undefined":babelHelpers.typeof(M);if("string"===H&&0<M.length)return D(M);if("number"===H&&!1===isNaN(M))return W.long?N(M):I(M);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(M))}},{}],9:[function(C,L){function D(){throw new Error("setTimeout has not been defined")}function I(){throw new Error("clearTimeout has not been defined")}function N(V){if(M===setTimeout)return setTimeout(V,0);if((M===D||!M)&&setTimeout)return M=setTimeout,setTimeout(V,0);try{return M(V,0)}catch(K){try{return M.call(null,V,0)}catch(Q){return M.call(this,V,0)}}}function R(V){if(W===clearTimeout)return clearTimeout(V);if((W===I||!W)&&clearTimeout)return W=clearTimeout,clearTimeout(V);try{return W(V)}catch(K){try{return W.call(null,V)}catch(Q){return W.call(this,V)}}}function $(){z&&X&&(z=!1,X.length?H=X.concat(H):G=-1,H.length&&P())}function P(){if(!z){var V=N($);z=!0;for(var K=H.length;K;){for(X=H,H=[];++G<K;)X&&X[G].run();G=-1,K=H.length}X=null,z=!1,R(V)}}function F(V,K){this.fun=V,this.array=K}function B(){}var U=L.exports={},M,W;(function(){try{M="function"===typeof setTimeout?setTimeout:D}catch(V){M=D}try{W="function"===typeof clearTimeout?clearTimeout:I}catch(V){W=I}})();var H=[],z=!1,X,G=-1;U.nextTick=function(V){var K=Array(arguments.length-1);if(1<arguments.length)for(var Q=1;Q<arguments.length;Q++)K[Q-1]=arguments[Q];H.push(new F(V,K)),1!==H.length||z||N(P)},F.prototype.run=function(){this.fun.apply(null,this.array)},U.title="browser",U.browser=!0,U.env={},U.argv=[],U.version="",U.versions={},U.on=B,U.addListener=B,U.once=B,U.off=B,U.removeListener=B,U.removeAllListeners=B,U.emit=B,U.prependListener=B,U.prependOnceListener=B,U.listeners=function(){return[]},U.binding=function(){throw new Error("process.binding is not supported")},U.cwd=function(){return"/"},U.chdir=function(){throw new Error("process.chdir is not supported")},U.umask=function(){return 0}},{}],10:[function(C,L,O){(function(D){if("object"===("undefined"===typeof O?"undefined":babelHelpers.typeof(O)))L.exports=D();else if("function"===typeof E&&E.amd)E(D);else{var I;try{I=window}catch(N){I=self}I.SparkMD5=D()}})(function(D){"use strict";function N(Q,J){var Y=Q[0],Z=Q[1],te=Q[2],ne=Q[3];Y+=0|(Z&te|~Z&ne)+J[0]-680876936,Y=0|(Y<<7|Y>>>25)+Z,ne+=0|(Y&Z|~Y&te)+J[1]-389564586,ne=0|(ne<<12|ne>>>20)+Y,te+=0|(ne&Y|~ne&Z)+J[2]+606105819,te=0|(te<<17|te>>>15)+ne,Z+=0|(te&ne|~te&Y)+J[3]-1044525330,Z=0|(Z<<22|Z>>>10)+te,Y+=0|(Z&te|~Z&ne)+J[4]-176418897,Y=0|(Y<<7|Y>>>25)+Z,ne+=0|(Y&Z|~Y&te)+J[5]+1200080426,ne=0|(ne<<12|ne>>>20)+Y,te+=0|(ne&Y|~ne&Z)+J[6]-1473231341,te=0|(te<<17|te>>>15)+ne,Z+=0|(te&ne|~te&Y)+J[7]-45705983,Z=0|(Z<<22|Z>>>10)+te,Y+=0|(Z&te|~Z&ne)+J[8]+1770035416,Y=0|(Y<<7|Y>>>25)+Z,ne+=0|(Y&Z|~Y&te)+J[9]-1958414417,ne=0|(ne<<12|ne>>>20)+Y,te+=0|(ne&Y|~ne&Z)+J[10]-42063,te=0|(te<<17|te>>>15)+ne,Z+=0|(te&ne|~te&Y)+J[11]-1990404162,Z=0|(Z<<22|Z>>>10)+te,Y+=0|(Z&te|~Z&ne)+J[12]+1804603682,Y=0|(Y<<7|Y>>>25)+Z,ne+=0|(Y&Z|~Y&te)+J[13]-40341101,ne=0|(ne<<12|ne>>>20)+Y,te+=0|(ne&Y|~ne&Z)+J[14]-1502002290,te=0|(te<<17|te>>>15)+ne,Z+=0|(te&ne|~te&Y)+J[15]+1236535329,Z=0|(Z<<22|Z>>>10)+te,Y+=0|(Z&ne|te&~ne)+J[1]-165796510,Y=0|(Y<<5|Y>>>27)+Z,ne+=0|(Y&te|Z&~te)+J[6]-1069501632,ne=0|(ne<<9|ne>>>23)+Y,te+=0|(ne&Z|Y&~Z)+J[11]+643717713,te=0|(te<<14|te>>>18)+ne,Z+=0|(te&Y|ne&~Y)+J[0]-373897302,Z=0|(Z<<20|Z>>>12)+te,Y+=0|(Z&ne|te&~ne)+J[5]-701558691,Y=0|(Y<<5|Y>>>27)+Z,ne+=0|(Y&te|Z&~te)+J[10]+38016083,ne=0|(ne<<9|ne>>>23)+Y,te+=0|(ne&Z|Y&~Z)+J[15]-660478335,te=0|(te<<14|te>>>18)+ne,Z+=0|(te&Y|ne&~Y)+J[4]-405537848,Z=0|(Z<<20|Z>>>12)+te,Y+=0|(Z&ne|te&~ne)+J[9]+568446438,Y=0|(Y<<5|Y>>>27)+Z,ne+=0|(Y&te|Z&~te)+J[14]-1019803690,ne=0|(ne<<9|ne>>>23)+Y,te+=0|(ne&Z|Y&~Z)+J[3]-187363961,te=0|(te<<14|te>>>18)+ne,Z+=0|(te&Y|ne&~Y)+J[8]+1163531501,Z=0|(Z<<20|Z>>>12)+te,Y+=0|(Z&ne|te&~ne)+J[13]-1444681467,Y=0|(Y<<5|Y>>>27)+Z,ne+=0|(Y&te|Z&~te)+J[2]-51403784,ne=0|(ne<<9|ne>>>23)+Y,te+=0|(ne&Z|Y&~Z)+J[7]+1735328473,te=0|(te<<14|te>>>18)+ne,Z+=0|(te&Y|ne&~Y)+J[12]-1926607734,Z=0|(Z<<20|Z>>>12)+te,Y+=0|(Z^te^ne)+J[5]-378558,Y=0|(Y<<4|Y>>>28)+Z,ne+=0|(Y^Z^te)+J[8]-2022574463,ne=0|(ne<<11|ne>>>21)+Y,te+=0|(ne^Y^Z)+J[11]+1839030562,te=0|(te<<16|te>>>16)+ne,Z+=0|(te^ne^Y)+J[14]-35309556,Z=0|(Z<<23|Z>>>9)+te,Y+=0|(Z^te^ne)+J[1]-1530992060,Y=0|(Y<<4|Y>>>28)+Z,ne+=0|(Y^Z^te)+J[4]+1272893353,ne=0|(ne<<11|ne>>>21)+Y,te+=0|(ne^Y^Z)+J[7]-155497632,te=0|(te<<16|te>>>16)+ne,Z+=0|(te^ne^Y)+J[10]-1094730640,Z=0|(Z<<23|Z>>>9)+te,Y+=0|(Z^te^ne)+J[13]+681279174,Y=0|(Y<<4|Y>>>28)+Z,ne+=0|(Y^Z^te)+J[0]-358537222,ne=0|(ne<<11|ne>>>21)+Y,te+=0|(ne^Y^Z)+J[3]-722521979,te=0|(te<<16|te>>>16)+ne,Z+=0|(te^ne^Y)+J[6]+76029189,Z=0|(Z<<23|Z>>>9)+te,Y+=0|(Z^te^ne)+J[9]-640364487,Y=0|(Y<<4|Y>>>28)+Z,ne+=0|(Y^Z^te)+J[12]-421815835,ne=0|(ne<<11|ne>>>21)+Y,te+=0|(ne^Y^Z)+J[15]+530742520,te=0|(te<<16|te>>>16)+ne,Z+=0|(te^ne^Y)+J[2]-995338651,Z=0|(Z<<23|Z>>>9)+te,Y+=0|(te^(Z|~ne))+J[0]-198630844,Y=0|(Y<<6|Y>>>26)+Z,ne+=0|(Z^(Y|~te))+J[7]+1126891415,ne=0|(ne<<10|ne>>>22)+Y,te+=0|(Y^(ne|~Z))+J[14]-1416354905,te=0|(te<<15|te>>>17)+ne,Z+=0|(ne^(te|~Y))+J[5]-57434055,Z=0|(Z<<21|Z>>>11)+te,Y+=0|(te^(Z|~ne))+J[12]+1700485571,Y=0|(Y<<6|Y>>>26)+Z,ne+=0|(Z^(Y|~te))+J[3]-1894986606,ne=0|(ne<<10|ne>>>22)+Y,te+=0|(Y^(ne|~Z))+J[10]-1051523,te=0|(te<<15|te>>>17)+ne,Z+=0|(ne^(te|~Y))+J[1]-2054922799,Z=0|(Z<<21|Z>>>11)+te,Y+=0|(te^(Z|~ne))+J[8]+1873313359,Y=0|(Y<<6|Y>>>26)+Z,ne+=0|(Z^(Y|~te))+J[15]-30611744,ne=0|(ne<<10|ne>>>22)+Y,te+=0|(Y^(ne|~Z))+J[6]-1560198380,te=0|(te<<15|te>>>17)+ne,Z+=0|(ne^(te|~Y))+J[13]+1309151649,Z=0|(Z<<21|Z>>>11)+te,Y+=0|(te^(Z|~ne))+J[4]-145523070,Y=0|(Y<<6|Y>>>26)+Z,ne+=0|(Z^(Y|~te))+J[11]-1120210379,ne=0|(ne<<10|ne>>>22)+Y,te+=0|(Y^(ne|~Z))+J[2]+718787259,te=0|(te<<15|te>>>17)+ne,Z+=0|(ne^(te|~Y))+J[9]-343485551,Z=0|(Z<<21|Z>>>11)+te,Q[0]=0|Y+Q[0],Q[1]=0|Z+Q[1],Q[2]=0|te+Q[2],Q[3]=0|ne+Q[3]}function R(Q){var J=[],Y;for(Y=0;64>Y;Y+=4)J[Y>>2]=Q.charCodeAt(Y)+(Q.charCodeAt(Y+1)<<8)+(Q.charCodeAt(Y+2)<<16)+(Q.charCodeAt(Y+3)<<24);return J}function $(Q){var J=[],Y;for(Y=0;64>Y;Y+=4)J[Y>>2]=Q[Y]+(Q[Y+1]<<8)+(Q[Y+2]<<16)+(Q[Y+3]<<24);return J}function P(Q){var J=Q.length,Y=[1732584193,-271733879,-1732584194,271733878],Z,te,ne,se,ae,oe;for(Z=64;Z<=J;Z+=64)N(Y,R(Q.substring(Z-64,Z)));for(Q=Q.substring(Z-64),te=Q.length,ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Z=0;Z<te;Z+=1)ne[Z>>2]|=Q.charCodeAt(Z)<<(Z%4<<3);if(ne[Z>>2]|=128<<(Z%4<<3),55<Z)for(N(Y,ne),Z=0;16>Z;Z+=1)ne[Z]=0;return se=8*J,se=se.toString(16).match(/(.*?)(.{0,8})$/),ae=parseInt(se[2],16),oe=parseInt(se[1],16)||0,ne[14]=ae,ne[15]=oe,N(Y,ne),Y}function F(Q){var J=Q.length,Y=[1732584193,-271733879,-1732584194,271733878],Z,te,ne,se,ae,oe;for(Z=64;Z<=J;Z+=64)N(Y,$(Q.subarray(Z-64,Z)));for(Q=Z-64<J?Q.subarray(Z-64):new Uint8Array(0),te=Q.length,ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Z=0;Z<te;Z+=1)ne[Z>>2]|=Q[Z]<<(Z%4<<3);if(ne[Z>>2]|=128<<(Z%4<<3),55<Z)for(N(Y,ne),Z=0;16>Z;Z+=1)ne[Z]=0;return se=8*J,se=se.toString(16).match(/(.*?)(.{0,8})$/),ae=parseInt(se[2],16),oe=parseInt(se[1],16)||0,ne[14]=ae,ne[15]=oe,N(Y,ne),Y}function B(Q){var J="",Y;for(Y=0;4>Y;Y+=1)J+=K[15&Q>>8*Y+4]+K[15&Q>>8*Y];return J}function U(Q){var J;for(J=0;J<Q.length;J+=1)Q[J]=B(Q[J]);return Q.join("")}function M(Q){return /[\u0080-\uFFFF]/.test(Q)&&(Q=unescape(encodeURIComponent(Q))),Q}function W(Q,J){var Y=Q.length,Z=new ArrayBuffer(Y),te=new Uint8Array(Z),ne;for(ne=0;ne<Y;ne+=1)te[ne]=Q.charCodeAt(ne);return J?te:Z}function H(Q){return String.fromCharCode.apply(null,new Uint8Array(Q))}function z(Q,J,Y){var Z=new Uint8Array(Q.byteLength+J.byteLength);return Z.set(new Uint8Array(Q)),Z.set(new Uint8Array(J),Q.byteLength),Y?Z:Z.buffer}function X(Q){var J=[],Y=Q.length,Z;for(Z=0;Z<Y-1;Z+=2)J.push(parseInt(Q.substr(Z,2),16));return String.fromCharCode.apply(String,J)}function G(){this.reset()}var V=function(J,Y){return 4294967295&J+Y},K=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return"5d41402abc4b2a76b9719d911017c592"!==U(P("hello"))&&(V=function(J,Y){var Z=(65535&J)+(65535&Y);return(J>>16)+(Y>>16)+(Z>>16)<<16|65535&Z}),"undefined"===typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function Q(J,Y){return J=0|J||0,0>J?Math.max(J+Y,0):Math.min(J,Y)}ArrayBuffer.prototype.slice=function(J,Y){var Z=this.byteLength,te=Q(J,Z),ne=Z,se,ae,oe,ie;return(Y!==D&&(ne=Q(Y,Z)),te>ne)?new ArrayBuffer(0):(se=ne-te,ae=new ArrayBuffer(se),oe=new Uint8Array(ae),ie=new Uint8Array(this,te,se),oe.set(ie),ae)}}(),G.prototype.append=function(Q){return this.appendBinary(M(Q)),this},G.prototype.appendBinary=function(Q){this._buff+=Q,this._length+=Q.length;var J=this._buff.length,Y;for(Y=64;Y<=J;Y+=64)N(this._hash,R(this._buff.substring(Y-64,Y)));return this._buff=this._buff.substring(Y-64),this},G.prototype.end=function(Q){var J=this._buff,Y=J.length,te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Z,ne;for(Z=0;Z<Y;Z+=1)te[Z>>2]|=J.charCodeAt(Z)<<(Z%4<<3);return this._finish(te,Y),ne=U(this._hash),Q&&(ne=X(ne)),this.reset(),ne},G.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},G.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},G.prototype.setState=function(Q){return this._buff=Q.buff,this._length=Q.length,this._hash=Q.hash,this},G.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},G.prototype._finish=function(Q,J){var Y=J,Z,te,ne;if(Q[Y>>2]|=128<<(Y%4<<3),55<Y)for(N(this._hash,Q),Y=0;16>Y;Y+=1)Q[Y]=0;Z=8*this._length,Z=Z.toString(16).match(/(.*?)(.{0,8})$/),te=parseInt(Z[2],16),ne=parseInt(Z[1],16)||0,Q[14]=te,Q[15]=ne,N(this._hash,Q)},G.hash=function(Q,J){return G.hashBinary(M(Q),J)},G.hashBinary=function(Q,J){var Y=P(Q),Z=U(Y);return J?X(Z):Z},G.ArrayBuffer=function(){this.reset()},G.ArrayBuffer.prototype.append=function(Q){var J=z(this._buff.buffer,Q,!0),Y=J.length,Z;for(this._length+=Q.byteLength,Z=64;Z<=Y;Z+=64)N(this._hash,$(J.subarray(Z-64,Z)));return this._buff=Z-64<Y?new Uint8Array(J.buffer.slice(Z-64)):new Uint8Array(0),this},G.ArrayBuffer.prototype.end=function(Q){var J=this._buff,Y=J.length,Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te,ne;for(te=0;te<Y;te+=1)Z[te>>2]|=J[te]<<(te%4<<3);return this._finish(Z,Y),ne=U(this._hash),Q&&(ne=X(ne)),this.reset(),ne},G.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},G.ArrayBuffer.prototype.getState=function(){var Q=G.prototype.getState.call(this);return Q.buff=H(Q.buff),Q},G.ArrayBuffer.prototype.setState=function(Q){return Q.buff=W(Q.buff,!0),G.prototype.setState.call(this,Q)},G.ArrayBuffer.prototype.destroy=G.prototype.destroy,G.ArrayBuffer.prototype._finish=G.prototype._finish,G.ArrayBuffer.hash=function(Q,J){var Y=F(new Uint8Array(Q)),Z=U(Y);return J?X(Z):Z},G})},{}],11:[function(C,L){var D=C(14),I=C(15),N=I;N.v1=D,N.v4=I,L.exports=N},{14:14,15:15}],12:[function(C,L){for(var I=[],N=0;256>N;++N)I[N]=(N+256).toString(16).substr(1);L.exports=function(R,$){var P=$||0,F=I;return F[R[P++]]+F[R[P++]]+F[R[P++]]+F[R[P++]]+"-"+F[R[P++]]+F[R[P++]]+"-"+F[R[P++]]+F[R[P++]]+"-"+F[R[P++]]+F[R[P++]]+"-"+F[R[P++]]+F[R[P++]]+F[R[P++]]+F[R[P++]]+F[R[P++]]+F[R[P++]]}},{}],13:[function(C,L){(function(D){var I,N=D.crypto||D.msCrypto;if(N&&N.getRandomValues){var R=new Uint8Array(16);I=function(){return N.getRandomValues(R),R}}if(!I){var $=Array(16);I=function(){for(var F=0,B;16>F;F++)0===(3&F)&&(B=4294967296*Math.random()),$[F]=255&B>>>((3&F)<<3);return $}}L.exports=I}).call(this,"undefined"===typeof global?"undefined"===typeof self?"undefined"===typeof window?{}:window:self:global)},{}],14:[function(C,L){var I=C(13),N=C(12),R=I(),$=[1|R[0],R[1],R[2],R[3],R[4],R[5]],P=16383&(R[6]<<8|R[7]),F=0,B=0;L.exports=function(U,M,W){var H=M&&W||0,z=M||[];U=U||{};var X=void 0===U.clockseq?P:U.clockseq,G=void 0===U.msecs?new Date().getTime():U.msecs,V=void 0===U.nsecs?B+1:U.nsecs,K=G-F+(V-B)/1e4;if(0>K&&void 0===U.clockseq&&(X=16383&X+1),(0>K||G>F)&&void 0===U.nsecs&&(V=0),1e4<=V)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");F=G,B=V,P=X,G+=1.22192928e13;var Q=(1e4*(268435455&G)+V)%4294967296;z[H++]=255&Q>>>24,z[H++]=255&Q>>>16,z[H++]=255&Q>>>8,z[H++]=255&Q;var J=268435455&1e4*(G/4294967296);z[H++]=255&J>>>8,z[H++]=255&J,z[H++]=16|15&J>>>24,z[H++]=255&J>>>16,z[H++]=128|X>>>8,z[H++]=255&X;for(var Y=U.node||$,Z=0;6>Z;++Z)z[H+Z]=Y[Z];return M?M:N(z)}},{12:12,13:13}],15:[function(C,L){var I=C(13),N=C(12);L.exports=function(R,$,P){var F=$&&P||0;"string"==typeof R&&($="binary"==R?Array(16):null,R=null),R=R||{};var B=R.random||(R.rng||I)();if(B[6]=64|15&B[6],B[8]=128|63&B[8],$)for(var U=0;16>U;++U)$[F+U]=B[U];return $||N(B)}},{12:12,13:13}],16:[function(C,L,O){"use strict";function D(I,N,R){var $=R[R.length-1];I===$.element&&(R.pop(),$=R[R.length-1]);var P=$.element,F=$.index;if(Array.isArray(P))P.push(I);else if(F===N.length-2){var B=N.pop();P[B]=I}else N.push(I)}O.stringify=function(N){for(var R=[{obj:N}],$="",P,F,B,U,M,W,H,z,X,G,V;P=R.pop();)if(F=P.obj,B=P.prefix||"",U=P.val||"",$+=B,U)$+=U;else if("object"!==("undefined"===typeof F?"undefined":babelHelpers.typeof(F)))$+="undefined"===typeof F?null:JSON.stringify(F);else if(null===F)$+="null";else if(Array.isArray(F)){for(R.push({val:"]"}),M=F.length-1;0<=M;M--)W=0===M?"":",",R.push({obj:F[M],prefix:W});R.push({val:"["})}else{for(z in H=[],F)F.hasOwnProperty(z)&&H.push(z);for(R.push({val:"}"}),M=H.length-1;0<=M;M--)X=H[M],G=F[X],V=0<M?",":"",V+=JSON.stringify(X)+":",R.push({obj:G,prefix:V});R.push({val:"{"})}return $},O.parse=function(I){for(var N=[],R=[],$=0,P,F,B,U,M,W,H,z,X;;){if(P=I[$++],"}"===P||"]"===P||"undefined"===typeof P){if(1===N.length)return N.pop();D(N.pop(),N,R);continue}switch(P){case" ":case"\t":case"\n":case":":case",":break;case"n":$+=3,D(null,N,R);break;case"t":$+=3,D(!0,N,R);break;case"f":$+=4,D(!1,N,R);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(F="",$--;;)if(B=I[$++],/[\d\.\-e\+]/.test(B))F+=B;else{$--;break}D(parseFloat(F),N,R);break;case"\"":for(U="",M=void 0,W=0;H=I[$++],"\""!==H||"\\"===M&&1===W%2;)U+=H,M=H,"\\"===M?W++:W=0;D(JSON.parse("\""+U+"\""),N,R);break;case"[":z={element:[],index:N.length},N.push(z.element),R.push(z);break;case"{":X={element:{},index:N.length},N.push(X.element),R.push(X);break;default:throw new Error("unexpectedly reached end of input: "+P);}}}},{}],17:[function(C,L){(function(D){"use strict";function I(di){return di&&"object"===("undefined"===typeof di?"undefined":babelHelpers.typeof(di))&&"default"in di?di["default"]:di}function N(di){return"undefined"!==typeof ArrayBuffer&&di instanceof ArrayBuffer||"undefined"!==typeof Blob&&di instanceof Blob}function R(di){if("function"===typeof di.slice)return di.slice(0);var ci=new ArrayBuffer(di.byteLength),li=new Uint8Array(ci),ui=new Uint8Array(di);return li.set(ui),ci}function $(di){if(di instanceof ArrayBuffer)return R(di);var ci=di.size,li=di.type;return"function"===typeof di.slice?di.slice(0,ci,li):di.webkitSlice(0,ci,li)}function P(di){var ci=Object.getPrototypeOf(di);if(null===ci)return!0;var li=ci.constructor;return"function"==typeof li&&li instanceof li&&ta.call(li)==na}function F(di){var ci,li,ui;if(!di||"object"!==("undefined"===typeof di?"undefined":babelHelpers.typeof(di)))return di;if(Array.isArray(di)){for(ci=[],li=0,ui=di.length;li<ui;li++)ci[li]=F(di[li]);return ci}if(di instanceof Date)return di.toISOString();if(N(di))return $(di);if(!P(di))return di;for(li in ci={},di)if(Object.prototype.hasOwnProperty.call(di,li)){var pi=F(di[li]);"undefined"!==typeof pi&&(ci[li]=pi)}return ci}function B(di){var ci=!1;return Gr(function(li){if(ci)throw new Error("once called more than once");else ci=!0,di.apply(this,li)})}function U(di){return Gr(function(ci){ci=F(ci);var li=this,ui="function"===typeof ci[ci.length-1]&&ci.pop(),pi=new ea(function(fi,_i){var mi;try{var gi=B(function(yi,vi){yi?_i(yi):fi(vi)});ci.push(gi),mi=di.apply(li,ci),mi&&"function"===typeof mi.then&&fi(mi)}catch(yi){_i(yi)}});return ui&&pi.then(function(fi){ui(null,fi)},ui),pi})}function M(di,ci,li){if(di.constructor.listeners("debug").length){for(var ui=["api",di.name,ci],pi=0;pi<li.length-1;pi++)ui.push(li[pi]);di.constructor.emit("debug",ui);var fi=li[li.length-1];li[li.length-1]=function(_i,mi){var gi=["api",di.name,ci];gi=gi.concat(_i?["error",_i]:["success",mi]),di.constructor.emit("debug",gi),fi(_i,mi)}}}function W(di,ci){return U(Gr(function(li){if(this._closed)return ea.reject(new Error("database is closed"));if(this._destroyed)return ea.reject(new Error("database is destroyed"));var ui=this;return M(ui,di,li),this.taskqueue.isReady?ci.apply(this,li):new ea(function(pi,fi){ui.taskqueue.addTask(function(_i){_i?fi(_i):pi(ui[di].apply(ui,li))})})}))}function H(di){return"$"+di}function z(di){return di.substring(1)}function X(){this._store={}}function G(di){if(this._store=new X,di&&Array.isArray(di))for(var ci=0,li=di.length;ci<li;ci++)this.add(di[ci])}function K(di,ci){for(var li={},ui=0,pi=ci.length,fi;ui<pi;ui++)fi=ci[ui],fi in di&&(li[fi]=di[fi]);return li}function Q(di){return di}function J(di){return[{ok:di}]}function Y(di,ci,li){function ui(){var wi=[];ki.forEach(function(xi){xi.docs.forEach(function(Ti){wi.push({id:xi.id,docs:[Ti]})})}),li(null,{results:wi})}function pi(){++Ei===vi&&ui()}function fi(wi,xi,Ti){ki[wi]={id:xi,docs:Ti},pi()}function _i(){if(!(qi>=Si.length)){var wi=Math.min(qi+aa,Si.length),xi=Si.slice(qi,wi);mi(xi,qi),qi+=xi.length}}function mi(wi,xi){wi.forEach(function(Ti,Ai){var Li=yi.get(Ti),ji=K(Li[0],["atts_since","attachments"]);ji.open_revs=Li.map(function(Di){return Di.rev}),ji.open_revs=ji.open_revs.filter(Q);var Oi=Q;0===ji.open_revs.length&&(delete ji.open_revs,Oi=J),["revs","attachments","binary","ajax","latest"].forEach(function(Di){Di in ci&&(ji[Di]=ci[Di])}),di.get(Ti,ji,function(Di,Ii){var Ni;Ni=Di?[{error:Di}]:Oi(Ii),fi(xi+Ai,Ti,Ni),_i()})})}var gi=ci.docs,yi=new ra;gi.forEach(function(wi){yi.has(wi.id)?yi.get(wi.id).push(wi):yi.set(wi.id,[wi])});var vi=yi.size,Ei=0,ki=Array(vi),Si=[];yi.forEach(function(wi,xi){Si.push(xi)});var qi=0;_i()}function Z(){return"undefined"!==typeof chrome&&"undefined"!==typeof chrome.storage&&"undefined"!==typeof chrome.storage.local}function te(){return oa}function ne(di){Z()?chrome.storage.onChanged.addListener(function(ci){null!=ci.db_name&&di.emit(ci.dbName.newValue)}):te()&&("undefined"===typeof addEventListener?window.attachEvent("storage",function(ci){di.emit(ci.key)}):addEventListener("storage",function(ci){di.emit(ci.key)}))}function se(){Vr.EventEmitter.call(this),this._listeners={},ne(this)}function ae(di){if("undefined"!==console&&di in console){var ci=Array.prototype.slice.call(arguments,1);console[di].apply(console,ci)}}function oe(di,ci){var li=6e5;di=parseInt(di,10)||0,ci=parseInt(ci,10),ci!==ci||ci<=di?ci=(di||1)<<1:++ci,ci>li&&(di=li>>1,ci=li);var ui=Math.random(),pi=ci-di;return~~(pi*ui+di)}function ie(di){var ci=0;return di||(ci=2e3),oe(di,ci)}function de(di,ci){ae("info","The above "+di+" is totally normal. "+ci)}function ce(di,ci,li){Error.call(this,li),this.status=di,this.name=ci,this.message=li,this.error=!0}function le(di,ci){function li(ui){for(var pi in di)"function"!==typeof di[pi]&&(this[pi]=di[pi]);void 0!==ui&&(this.reason=ui)}return li.prototype=ce.prototype,new li(ci)}function ue(di){if("object"!==("undefined"===typeof di?"undefined":babelHelpers.typeof(di))){var ci=di;di=ya,di.data=ci}return"error"in di&&"conflict"===di.error&&(di.name="conflict",di.status=409),"name"in di||(di.name=di.error||"unknown"),"status"in di||(di.status=500),"message"in di||(di.message=di.message||di.reason),di}function pe(di,ci,li){try{return!di(ci,li)}catch(pi){var ui="Filter function threw: "+pi.toString();return le(Sa,ui)}}function he(di){var ci={},li=di.filter&&"function"===typeof di.filter;return ci.query=di.query_params,function(pi){pi.doc||(pi.doc={});var fi=li&&pe(di.filter,pi.doc,ci);if("object"===("undefined"===typeof fi?"undefined":babelHelpers.typeof(fi)))return fi;if(fi)return!1;if(!di.include_docs)delete pi.doc;else if(!di.attachments)for(var _i in pi.doc._attachments)pi.doc._attachments.hasOwnProperty(_i)&&(pi.doc._attachments[_i].stub=!0);return!0}}function fe(di){for(var ci=[],li=0,ui=di.length;li<ui;li++)ci=ci.concat(di[li]);return ci}function me(di){var ci;if(di?"string"===typeof di?/^_/.test(di)&&!/^_(design|local)/.test(di)&&(ci=le(ma)):ci=le(fa):ci=le(_a),ci)throw ci}function ge(di){return"boolean"===typeof di._remote?di._remote:!("function"!==typeof di.type)&&(ae("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===di.type())}function ye(di,ci){return"listenerCount"in di?di.listenerCount(ci):Vr.EventEmitter.listenerCount(di,ci)}function ve(di){if(!di)return null;var ci=di.split("/");return 2===ci.length?ci:1===ci.length?[di,di]:null}function be(di){var ci=ve(di);return ci?ci.join("/"):null}function Ee(di){for(var ci=Fa.exec(di),li={},ui=14;ui--;){var pi=Ra[ui],fi=ci[ui]||"",_i=-1!==["user","password"].indexOf(pi);li[pi]=_i?decodeURIComponent(fi):fi}return li[$a]={},li[Ra[12]].replace(Pa,function(mi,gi,yi){gi&&(li[$a][gi]=yi)}),li}function ke(di,ci){var li=[],ui=[];for(var pi in ci)ci.hasOwnProperty(pi)&&(li.push(pi),ui.push(ci[pi]));return li.push(di),Function.apply(null,li).apply(null,ui)}function Se(di,ci,li){return new ea(function(ui,pi){di.get(ci,function(fi,_i){if(fi){if(404!==fi.status)return pi(fi);_i={}}var mi=_i._rev,gi=li(_i);return gi?void(gi._id=ci,gi._rev=mi,ui(qe(di,gi,li))):ui({updated:!1,rev:mi})})})}function qe(di,ci,li){return di.put(ci).then(function(ui){return{updated:!0,rev:ui.rev}},function(ui){if(409!==ui.status)throw ui;return Se(di,ci._id,li)})}function we(){return zr.v4().replace(/-/g,"").toLowerCase()}function xe(di){for(var pi=di.rev_tree.slice(),ci,li,ui,fi;fi=pi.pop();){var _i=fi.ids,mi=_i[2],gi=fi.pos;if(mi.length){for(var yi=0,vi=mi.length;yi<vi;yi++)pi.push({pos:gi+1,ids:mi[yi]});continue}var Ei=!!_i[1].deleted,ki=_i[0];(!ci||(ui===Ei?li===gi?ci<ki:li<gi:ui))&&(ci=ki,li=gi,ui=Ei)}return li+"-"+ci}function Te(di,ci){for(var li=di.slice(),ui;ui=li.pop();)for(var pi=ui.pos,fi=ui.ids,_i=fi[2],mi=ci(0===_i.length,pi,fi[0],ui.ctx,fi[1]),gi=0,yi=_i.length;gi<yi;gi++)li.push({pos:pi+1,ids:_i[gi],ctx:mi})}function Ae(di,ci){return di.pos-ci.pos}function Ce(di){var ci=[];Te(di,function(pi,fi,_i,mi,gi){pi&&ci.push({rev:fi+"-"+_i,pos:fi,opts:gi})}),ci.sort(Ae).reverse();for(var li=0,ui=ci.length;li<ui;li++)delete ci[li].pos;return ci}function Le(di){for(var ci=xe(di),li=Ce(di.rev_tree),ui=[],pi=0,fi=li.length,_i;pi<fi;pi++)_i=li[pi],_i.rev===ci||_i.opts.deleted||ui.push(_i.rev);return ui}function je(di){var ci=[];return Te(di.rev_tree,function(li,ui,pi,fi,_i){"available"!==_i.status||li||(ci.push(ui+"-"+pi),_i.status="missing")}),ci}function Oe(di){for(var ci=[],li=di.slice(),ui;ui=li.pop();){var pi=ui.pos,fi=ui.ids,_i=fi[0],mi=fi[1],gi=fi[2],yi=0===gi.length,vi=ui.history?ui.history.slice():[];vi.push({id:_i,opts:mi}),yi&&ci.push({pos:pi+1-vi.length,ids:vi});for(var Ei=0,ki=gi.length;Ei<ki;Ei++)li.push({pos:pi+1,ids:gi[Ei],history:vi})}return ci.reverse()}function De(di,ci){return di.pos-ci.pos}function Ie(di,ci,li){for(var ui=0,pi=di.length,fi;ui<pi;)fi=ui+pi>>>1,0>li(di[fi],ci)?ui=fi+1:pi=fi;return ui}function Ne(di,ci,li){var ui=Ie(di,ci,li);di.splice(ui,0,ci)}function Re(di,ci){for(var pi=ci,fi=di.length,li,ui;pi<fi;pi++){var _i=di[pi],mi=[_i.id,_i.opts,[]];ui?(ui[2].push(mi),ui=mi):li=ui=mi}return li}function $e(di,ci){return di[0]<ci[0]?-1:1}function Pe(di,ci){for(var li=[{tree1:di,tree2:ci}],ui=!1;0<li.length;){var pi=li.pop(),fi=pi.tree1,_i=pi.tree2;(fi[1].status||_i[1].status)&&(fi[1].status="available"===fi[1].status||"available"===_i[1].status?"available":"missing");for(var mi=0;mi<_i[2].length;mi++){if(!fi[2][0]){ui="new_leaf",fi[2][0]=_i[2][mi];continue}for(var gi=!1,yi=0;yi<fi[2].length;yi++)fi[2][yi][0]===_i[2][mi][0]&&(li.push({tree1:fi[2][yi],tree2:_i[2][mi]}),gi=!0);gi||(ui="new_branch",Ne(fi[2],_i[2][mi],$e))}}return{conflicts:ui,tree:di}}function Fe(di,ci,li){var ui=[],pi=!1,fi=!1,_i;if(!di.length)return{tree:[ci],conflicts:"new_leaf"};for(var mi=0,gi=di.length,yi;mi<gi;mi++)if(yi=di[mi],yi.pos===ci.pos&&yi.ids[0]===ci.ids[0])_i=Pe(yi.ids,ci.ids),ui.push({pos:yi.pos,ids:_i.tree}),pi=pi||_i.conflicts,fi=!0;else if(!0!==li){var vi=yi.pos<ci.pos?yi:ci,Ei=yi.pos<ci.pos?ci:yi,ki=Ei.pos-vi.pos,Si=[],qi=[];for(qi.push({ids:vi.ids,diff:ki,parent:null,parentIdx:null});0<qi.length;){var wi=qi.pop();if(0===wi.diff){wi.ids[0]===Ei.ids[0]&&Si.push(wi);continue}for(var xi=wi.ids[2],Ti=0,Ai=xi.length;Ti<Ai;Ti++)qi.push({ids:xi[Ti],diff:wi.diff-1,parent:wi.ids,parentIdx:Ti})}var Ci=Si[0];Ci?(_i=Pe(Ci.ids,Ei.ids),Ci.parent[2][Ci.parentIdx]=_i.tree,ui.push({pos:vi.pos,ids:vi.ids}),pi=pi||_i.conflicts,fi=!0):ui.push(yi)}else ui.push(yi);return fi||ui.push(ci),ui.sort(De),{tree:ui,conflicts:pi||"internal_node"}}function Be(di,ci){for(var li=Oe(di),fi=0,_i=li.length,ui,pi;fi<_i;fi++){var mi=li[fi],gi=mi.ids,yi;if(gi.length>ci){ui||(ui={});var vi=gi.length-ci;yi={pos:mi.pos+vi,ids:Re(gi,vi)};for(var Ei=0,ki;Ei<vi;Ei++)ki=mi.pos+Ei+"-"+gi[Ei].id,ui[ki]=!0}else yi={pos:mi.pos,ids:Re(gi,0)};pi=pi?Fe(pi,yi,!0).tree:[yi]}return ui&&Te(pi,function(Si,qi,wi){delete ui[qi+"-"+wi]}),{tree:pi,revs:ui?Object.keys(ui):[]}}function Ue(di,ci,li){var ui=Fe(di,ci),pi=Be(ui.tree,li);return{tree:pi.tree,stemmedRevs:pi.revs,conflicts:ui.conflicts}}function Me(di,ci){for(var li=di.slice(),ui=ci.split("-"),pi=parseInt(ui[0],10),fi=ui[1],_i;_i=li.pop();){if(_i.pos===pi&&_i.ids[0]===fi)return!0;for(var mi=_i.ids[2],gi=0,yi=mi.length;gi<yi;gi++)li.push({pos:_i.pos+1,ids:mi[gi]})}return!1}function We(di){return di.ids}function He(di,ci){ci||(ci=xe(di));for(var li=ci.substring(ci.indexOf("-")+1),ui=di.rev_tree.map(We),pi;pi=ui.pop();){if(pi[0]===li)return!!pi[1].deleted;ui=ui.concat(pi[2])}}function ze(di){return /^_local/.test(di)}function Xe(di,ci){for(var li=ci.rev_tree.slice(),ui;ui=li.pop();){var pi=ui.pos,fi=ui.ids,_i=fi[0],mi=fi[1],gi=fi[2],yi=0===gi.length,vi=ui.history?ui.history.slice():[];if(vi.push({id:_i,pos:pi,opts:mi}),yi)for(var Ei=0,ki=vi.length;Ei<ki;Ei++){var Si=vi[Ei],qi=Si.pos+"-"+Si.id;if(qi===di)return pi+"-"+_i}for(var wi=0,xi=gi.length;wi<xi;wi++)li.push({pos:pi+1,ids:gi[wi],history:vi})}throw new Error("Unable to resolve latest revision for id "+ci.id+", rev "+di)}function Ge(di,ci){try{di.emit("change",ci)}catch(li){ae("error","Error in .on(\"change\", function):",li)}}function Ve(di,ci,li){function ui(){pi.cancel()}Vr.EventEmitter.call(this);var pi=this;this.db=di,ci=ci?F(ci):{};var fi=ci.complete=B(function(mi,gi){mi?0<ye(pi,"error")&&pi.emit("error",mi):pi.emit("complete",gi),pi.removeAllListeners(),di.removeListener("destroyed",ui)});li&&(pi.on("complete",function(mi){li(null,mi)}),pi.on("error",li)),di.once("destroyed",ui),ci.onChange=function(mi){pi.isCancelled||Ge(pi,mi)};var _i=new ea(function(mi,gi){ci.complete=function(yi,vi){yi?gi(yi):mi(vi)}});pi.once("cancel",function(){di.removeListener("destroyed",ui),ci.complete(null,{status:"cancelled"})}),this.then=_i.then.bind(_i),this["catch"]=_i["catch"].bind(_i),this.then(function(mi){fi(null,mi)},fi),di.taskqueue.isReady?pi.validateChanges(ci):di.taskqueue.addTask(function(mi){mi?ci.complete(mi):pi.isCancelled?pi.emit("cancel"):pi.validateChanges(ci)})}function Ke(di,ci,li){var ui=[{rev:di._rev}];"all_docs"===li.style&&(ui=Ce(ci.rev_tree).map(function(fi){return{rev:fi.rev}}));var pi={id:ci.id,changes:ui,doc:di};return He(ci,di._rev)&&(pi.deleted=!0),li.conflicts&&(pi.doc._conflicts=Le(ci),!pi.doc._conflicts.length&&delete pi.doc._conflicts),pi}function Qe(di,ci){return di<ci?-1:di>ci?1:0}function Je(di,ci){return function(li,ui){li||ui[0]&&ui[0].error?(li=li||ui[0],li.docId=ci,di(li)):di(null,ui.length?ui[0]:ui)}}function Ye(di){for(var ci=0,li;ci<di.length;ci++)if(li=di[ci],li._deleted)delete li._attachments;else if(li._attachments)for(var ui=Object.keys(li._attachments),pi=0,fi;pi<ui.length;pi++)fi=ui[pi],li._attachments[fi]=K(li._attachments[fi],["data","digest","content_type","length","revpos","stub"])}function Ze(di,ci){var li=Qe(di._id,ci._id);if(0!==li)return li;var ui=di._revisions?di._revisions.start:0,pi=ci._revisions?ci._revisions.start:0;return Qe(ui,pi)}function et(di){var ci={},li=[];return Te(di,function(ui,pi,fi,_i){var mi=pi+"-"+fi;return ui&&(ci[mi]=0),void 0!==_i&&li.push({from:_i,to:mi}),mi}),li.reverse(),li.forEach(function(ui){ci[ui.from]=void 0===ci[ui.from]?1+ci[ui.to]:Math.min(ci[ui.from],1+ci[ui.to])}),ci}function tt(di,ci,li){var ui="limit"in ci?ci.keys.slice(ci.skip,ci.limit+ci.skip):0<ci.skip?ci.keys.slice(ci.skip):ci.keys;if(ci.descending&&ui.reverse(),!ui.length)return di._allDocs({limit:0},li);var pi={offset:ci.skip};return ea.all(ui.map(function(fi){var _i=da({key:fi,deleted:"ok"},ci);return["limit","skip","keys"].forEach(function(mi){delete _i[mi]}),new ea(function(mi,gi){di._allDocs(_i,function(yi,vi){return yi?gi(yi):void(pi.total_rows=vi.total_rows,mi(vi.rows[0]||{key:fi,error:"not_found"}))})})})).then(function(fi){return pi.rows=fi,pi})}function nt(di){var ci=di._compactionQueue[0],li=ci.opts,ui=ci.callback;di.get("_local/compaction")["catch"](function(){return!1}).then(function(pi){pi&&pi.last_seq&&(li.last_seq=pi.last_seq),di._compact(li,function(fi,_i){fi?ui(fi):ui(null,_i),Qr(function(){di._compactionQueue.shift(),di._compactionQueue.length&&nt(di)})})})}function st(di){return!("_"!==di.charAt(0))&&di+" is not a valid attachment name, attachment names cannot start with '_'"}function rt(){Vr.EventEmitter.call(this)}function at(){this.isReady=!1,this.failed=!1,this.queue=[]}function ot(di,ci){var li=di.match(/([a-z-]*):\/\/(.*)/);if(li)return{name:/https?/.test(li[1])?li[1]+"://"+li[2]:li[2],adapter:li[1]};var ui=ct.adapters,pi=ct.preferredAdapters,fi=ct.prefix,_i=ci.adapter;if(!_i)for(var mi=0;mi<pi.length;++mi){if(_i=pi[mi],"idb"===_i&&"websql"in ui&&te()&&localStorage["_pouch__websqldb_"+fi+di]){ae("log","PouchDB is downgrading \""+di+"\" to WebSQL to avoid data loss, because it was already opened with WebSQL.");continue}break}var gi=ui[_i],yi=gi&&"use_prefix"in gi?gi.use_prefix:!0;return{name:yi?fi+di:di,adapter:_i}}function it(di){function ci(ui){di.removeListener("closed",li),ui||di.constructor.emit("destroyed",di.name)}function li(){di.removeListener("destroyed",ci),di.constructor.emit("unref",di)}di.once("destroyed",ci),di.once("closed",li),di.constructor.emit("ref",di)}function ct(di,ci){if(!(this instanceof ct))return new ct(di,ci);var li=this;if(ci=ci||{},di&&"object"===("undefined"===typeof di?"undefined":babelHelpers.typeof(di))&&(ci=di,di=ci.name,delete ci.name),this.__opts=ci=F(ci),li.auto_compaction=ci.auto_compaction,li.prefix=ct.prefix,"string"!==typeof di)throw new Error("Missing/invalid DB name");var ui=(ci.prefix||"")+di,pi=ot(ui,ci);if(ci.name=pi.name,ci.adapter=ci.adapter||pi.adapter,li.name=di,li._adapter=ci.adapter,ct.emit("debug",["adapter","Picked adapter: ",ci.adapter]),!ct.adapters[ci.adapter]||!ct.adapters[ci.adapter].valid())throw new Error("Invalid Adapter: "+ci.adapter);rt.call(li),li.taskqueue=new at,li.adapter=ci.adapter,ct.adapters[ci.adapter].call(li,ci,function(fi){return fi?li.taskqueue.fail(fi):void(it(li),li.emit("created",li),ct.emit("created",li.name),li.taskqueue.ready(li))})}function pt(di,ci){for(var li=di,ui=0,pi=ci.length,fi;ui<pi&&(fi=ci[ui],li=li[fi],!!li);ui++);return li}function ht(di,ci){return di<ci?-1:di>ci?1:0}function ft(di){for(var ci=[],li="",ui=0,pi=di.length,fi;ui<pi;ui++)fi=di[ui],"."===fi?0<ui&&"\\"===di[ui-1]?li=li.substring(0,li.length-1)+".":(ci.push(li),li=""):li+=fi;return ci.push(li),ci}function _t(di){return-1<Wa.indexOf(di)}function mt(di){return Object.keys(di)[0]}function gt(di){return di[mt(di)]}function yt(di){var ci={};return di.forEach(function(li){Object.keys(li).forEach(function(ui){var pi=li[ui];if("object"!==("undefined"===typeof pi?"undefined":babelHelpers.typeof(pi))&&(pi={$eq:pi}),_t(ui))ci[ui]=pi instanceof Array?pi.map(function(_i){return yt([_i])}):yt([pi]);else{var fi=ci[ui]=ci[ui]||{};Object.keys(pi).forEach(function(_i){var mi=pi[_i];return"$gt"===_i||"$gte"===_i?vt(_i,mi,fi):"$lt"===_i||"$lte"===_i?bt(_i,mi,fi):"$ne"===_i?Et(mi,fi):"$eq"===_i?kt(mi,fi):void(fi[_i]=mi)})}})}),ci}function vt(di,ci,li){"undefined"!==typeof li.$eq||("undefined"===typeof li.$gte?"undefined"===typeof li.$gt?li[di]=ci:"$gte"===di?ci>li.$gt&&(delete li.$gt,li.$gte=ci):ci>li.$gt&&(li.$gt=ci):"$gte"===di?ci>li.$gte&&(li.$gte=ci):ci>=li.$gte&&(delete li.$gte,li.$gt=ci))}function bt(di,ci,li){"undefined"!==typeof li.$eq||("undefined"===typeof li.$lte?"undefined"===typeof li.$lt?li[di]=ci:"$lte"===di?ci<li.$lt&&(delete li.$lt,li.$lte=ci):ci<li.$lt&&(li.$lt=ci):"$lte"===di?ci<li.$lte&&(li.$lte=ci):ci<=li.$lte&&(delete li.$lte,li.$lt=ci))}function Et(di,ci){"$ne"in ci?ci.$ne.push(di):ci.$ne=[di]}function kt(di,ci){delete ci.$gt,delete ci.$gte,delete ci.$lt,delete ci.$lte,delete ci.$ne,ci.$eq=di}function St(di){var ci=F(di),li=!1;"$and"in ci&&(ci=yt(ci.$and),li=!0),["$or","$nor"].forEach(function(mi){mi in ci&&ci[mi].forEach(function(gi){for(var yi=Object.keys(gi),vi=0;vi<yi.length;vi++){var Ei=yi[vi],ki=gi[Ei];("object"!==("undefined"===typeof ki?"undefined":babelHelpers.typeof(ki))||null===ki)&&(gi[Ei]={$eq:ki})}})}),"$not"in ci&&(ci.$not=yt([ci.$not]));for(var ui=Object.keys(ci),pi=0;pi<ui.length;pi++){var fi=ui[pi],_i=ci[fi];"object"!==("undefined"===typeof _i?"undefined":babelHelpers.typeof(_i))||null===_i?_i={$eq:_i}:"$ne"in _i&&!li&&(_i.$ne=[_i.$ne]),ci[fi]=_i}return ci}function qt(di,ci,li){for(var ui="",pi=li-di.length;ui.length<pi;)ui+=ci;return ui}function wt(di,ci,li){var ui=qt(di,ci,li);return ui+di}function xt(di,ci){if(di===ci)return 0;di=Tt(di),ci=Tt(ci);var li=Rt(di),ui=Rt(ci);if(0!==li-ui)return li-ui;switch("undefined"===typeof di?"undefined":babelHelpers.typeof(di)){case"number":return di-ci;case"boolean":return di<ci?-1:1;case"string":return It(di,ci);}return Array.isArray(di)?Dt(di,ci):Nt(di,ci)}function Tt(di){switch("undefined"===typeof di?"undefined":babelHelpers.typeof(di)){case"undefined":return null;case"number":return di===Infinity||di===-Infinity||isNaN(di)?null:di;case"object":var ci=di;if(Array.isArray(di)){var li=di.length;di=Array(li);for(var ui=0;ui<li;ui++)di[ui]=Tt(ci[ui])}else{if(di instanceof Date)return di.toJSON();if(null!==di)for(var pi in di={},ci)if(ci.hasOwnProperty(pi)){var fi=ci[pi];"undefined"!==typeof fi&&(di[pi]=Tt(fi))}}}return di}function At(di){if(null!==di)switch("undefined"===typeof di?"undefined":babelHelpers.typeof(di)){case"boolean":return di?1:0;case"number":return $t(di);case"string":return di.replace(/\u0002/g,"\x02\x02").replace(/\u0001/g,"\x01\x02").replace(/\u0000/g,"\x01\x01");case"object":var ci=Array.isArray(di),li=ci?di:Object.keys(di),ui=-1,pi=li.length,fi="";if(ci)for(;++ui<pi;)fi+=Ct(li[ui]);else for(;++ui<pi;){var _i=li[ui];fi+=Ct(_i)+Ct(di[_i])}return fi;}return""}function Ct(di){return di=Tt(di),Rt(di)+Xa+At(di)+"\0"}function Lt(di,ci){var li=ci,ui,pi="1"===di[ci];if(pi)ui=0,ci++;else{var fi="0"===di[ci];ci++;var _i="",mi=di.substring(ci,ci+za),gi=parseInt(mi,10)+Ha;for(fi&&(gi=-gi),ci+=za;;){var yi=di[ci];if("\0"===yi)break;else _i+=yi;ci++}_i=_i.split("."),ui=1===_i.length?parseInt(_i,10):parseFloat(_i[0]+"."+_i[1]),fi&&(ui-=10),0!==gi&&(ui=parseFloat(ui+"e"+gi))}return{num:ui,length:ci-li}}function jt(di,ci){var li=di.pop();if(ci.length){var ui=ci[ci.length-1];li===ui.element&&(ci.pop(),ui=ci[ci.length-1]);var pi=ui.element,fi=ui.index;if(Array.isArray(pi))pi.push(li);else if(fi===di.length-2){var _i=di.pop();pi[_i]=li}else di.push(li)}}function Ot(di){for(var ci=[],li=[],ui=0,pi;;){if(pi=di[ui++],"\0"===pi){if(1===ci.length)return ci.pop();jt(ci,li);continue}switch(pi){case"1":ci.push(null);break;case"2":ci.push("1"===di[ui]),ui++;break;case"3":var fi=Lt(di,ui);ci.push(fi.num),ui+=fi.length;break;case"4":for(var _i="",mi;mi=di[ui],"\0"!==mi;)_i+=mi,ui++;_i=_i.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"\x01").replace(/\u0002\u0002/g,"\x02"),ci.push(_i);break;case"5":var gi={element:[],index:ci.length};ci.push(gi.element),li.push(gi);break;case"6":var yi={element:{},index:ci.length};ci.push(yi.element),li.push(yi);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+pi);}}}function Dt(di,ci){for(var li=Math.min(di.length,ci.length),ui=0,pi;ui<li;ui++)if(pi=xt(di[ui],ci[ui]),0!==pi)return pi;return di.length===ci.length?0:di.length>ci.length?1:-1}function It(di,ci){return di===ci?0:di>ci?1:-1}function Nt(di,ci){for(var li=Object.keys(di),ui=Object.keys(ci),pi=Math.min(li.length,ui.length),fi=0,_i;fi<pi;fi++){if(_i=xt(li[fi],ui[fi]),0!==_i)return _i;if(_i=xt(di[li[fi]],ci[ui[fi]]),0!==_i)return _i}return li.length===ui.length?0:li.length>ui.length?1:-1}function Rt(di){var li=["boolean","number","string","object"].indexOf("undefined"===typeof di?"undefined":babelHelpers.typeof(di));return~li?null===di?1:Array.isArray(di)?5:3>li?li+2:li+3:Array.isArray(di)?5:void 0}function $t(di){if(0===di)return"1";var ci=di.toExponential().split(/e\+?/),li=parseInt(ci[1],10),ui=0>di,pi=ui?"0":"2",fi=(ui?-li:li)-Ha,_i=wt(fi.toString(),"0",za);pi+=Xa+_i;var mi=Math.abs(parseFloat(ci[0]));ui&&(mi=10-mi);var gi=mi.toFixed(20);return gi=gi.replace(/\.?0+$/,""),pi+=Xa+gi,pi}function Pt(di){function ci(li){return di.map(function(ui){var pi=mt(ui),fi=ft(pi),_i=pt(li,fi);return _i})}return function(li,ui){var pi=ci(li.doc),fi=ci(ui.doc),_i=xt(pi,fi);return 0===_i?ht(li.doc._id,ui.doc._id):_i}}function Ft(di,ci,li){if(di=di.filter(function(_i){return Bt(_i.doc,ci.selector,li)}),ci.sort){var ui=Pt(ci.sort);di=di.sort(ui),"string"!==typeof ci.sort[0]&&"desc"===gt(ci.sort[0])&&(di=di.reverse())}if("limit"in ci||"skip"in ci){var pi=ci.skip||0,fi=("limit"in ci?ci.limit:di.length)+pi;di=di.slice(pi,fi)}return di}function Bt(di,ci,li){return li.every(function(ui){var pi=ci[ui],fi=ft(ui),_i=pt(di,fi);return _t(ui)?Mt(ui,pi,di):Ut(pi,di,fi,_i)})}function Ut(di,ci,li,ui){return!di||Object.keys(di).every(function(pi){var fi=di[pi];return Wt(pi,ci,fi,li,ui)})}function Mt(di,ci,li){return"$or"===di?ci.some(function(ui){return Bt(li,ui,Object.keys(ui))}):"$not"===di?!Bt(li,ci,Object.keys(ci)):!ci.find(function(ui){return Bt(li,ui,Object.keys(ui))})}function Wt(di,ci,li,ui,pi){if(!Ga[di])throw new Error("unknown operator \""+di+"\" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all");return Ga[di](ci,li,ui,pi)}function Ht(di){return"undefined"!==typeof di&&null!==di}function zt(di){return"undefined"!==typeof di}function Xt(di,ci){var li=ci[0],ui=ci[1];if(0===li)throw new Error("Bad divisor, cannot divide by zero");if(parseInt(li,10)!==li)throw new Error("Divisor is not an integer");if(parseInt(ui,10)!==ui)throw new Error("Modulus is not an integer");return parseInt(di,10)===di&&di%li===ui}function Gt(di,ci){return ci.some(function(li){return di instanceof Array?-1<di.indexOf(li):di===li})}function Vt(di,ci){return ci.every(function(li){return-1<di.indexOf(li)})}function Kt(di,ci){return di.length===ci}function Qt(di,ci){var li=new RegExp(ci);return li.test(di)}function Jt(di,ci){switch(ci){case"null":return null===di;case"boolean":return"boolean"===typeof di;case"number":return"number"===typeof di;case"string":return"string"===typeof di;case"array":return di instanceof Array;case"object":return"[object Object]"==={}.toString.call(di);}throw new Error(ci+" not supported as a type.Please use one of object, string, array, number, boolean or null.")}function Yt(di,ci){if("object"!==("undefined"===typeof ci?"undefined":babelHelpers.typeof(ci)))throw new Error("Selector error: expected a JSON object");ci=St(ci);var ui=Ft([{doc:di}],{selector:ci},Object.keys(ci));return ui&&1===ui.length}function Zt(di){return ke("\"use strict\";\nreturn "+di+";",{})}function en(di){var ci=["return function(doc) {","  \"use strict\";","  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+di+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join("\n");return ke(ci,{})}function tn(di,ci){if(di.selector&&di.filter&&"_selector"!==di.filter){var li="string"===typeof di.filter?di.filter:"function";return ci(new Error("selector invalid for filter \""+li+"\""))}ci()}function nn(di){di.view&&!di.filter&&(di.filter="_view"),di.selector&&!di.filter&&(di.filter="_selector"),di.filter&&"string"===typeof di.filter&&("_view"===di.filter?di.view=be(di.view):di.filter=be(di.filter))}function sn(di,ci){return ci.filter&&"string"===typeof ci.filter&&!ci.doc_ids&&!ge(di.db)}function rn(di,ci){var li=ci.complete;if("_view"===ci.filter){if(!ci.view||"string"!==typeof ci.view){var ui=le(Sa,"`view` filter parameter not found or invalid.");return li(ui)}var pi=ve(ci.view);di.db.get("_design/"+pi[0],function(_i,mi){if(di.isCancelled)return li(null,{status:"cancelled"});if(_i)return li(ue(_i));var gi=mi&&mi.views&&mi.views[pi[1]]&&mi.views[pi[1]].map;return gi?void(ci.filter=en(gi),di.doChanges(ci)):li(le(pa,mi.views?"missing json key: "+pi[1]:"missing json key: views"))})}else if(ci.selector)ci.filter=function(_i){return Yt(_i,ci.selector)},di.doChanges(ci);else{var fi=ve(ci.filter);di.db.get("_design/"+fi[0],function(_i,mi){if(di.isCancelled)return li(null,{status:"cancelled"});if(_i)return li(ue(_i));var gi=mi&&mi.filters&&mi.filters[fi[1]];return gi?void(ci.filter=Zt(gi),di.doChanges(ci)):li(le(pa,mi&&mi.filters?"missing json key: "+fi[1]:"missing json key: filters"))})}}function on(di){return di.reduce(function(ci,li){return ci[li]=!0,ci},{})}function dn(di){if(!/^\d+-./.test(di))return le(La);var ci=di.indexOf("-"),li=di.substring(0,ci),ui=di.substring(ci+1);return{prefix:parseInt(li,10),id:ui}}function cn(di,ci){for(var li=di.start-di.ids.length+1,ui=di.ids,pi=[ui[0],ci,[]],fi=1,_i=ui.length;fi<_i;fi++)pi=[ui[fi],{status:"missing"},[pi]];return[{pos:li,ids:pi}]}function ln(di,ci){var fi={status:"available"},li,ui,pi;if(di._deleted&&(fi.deleted=!0),ci){if(di._id||(di._id=Ba()),ui=we(),di._rev){if(pi=dn(di._rev),pi.error)return pi;di._rev_tree=[{pos:pi.prefix,ids:[pi.id,{status:"missing"},[[ui,fi,[]]]]}],li=pi.prefix+1}else di._rev_tree=[{pos:1,ids:[ui,fi,[]]}],li=1;}else if(di._revisions&&(di._rev_tree=cn(di._revisions,fi),li=di._revisions.start,ui=di._revisions.ids[0]),!di._rev_tree){if(pi=dn(di._rev),pi.error)return pi;li=pi.prefix,ui=pi.id,di._rev_tree=[{pos:li,ids:[ui,fi,[]]}]}me(di._id),di._rev=li+"-"+ui;var _i={metadata:{},data:{}};for(var mi in di)if(Object.prototype.hasOwnProperty.call(di,mi)){var gi="_"===mi[0];if(gi&&!Va[mi]){var yi=le(ka,mi);throw yi.message=ka.message+": "+mi,yi}else gi&&!Ka[mi]?_i.metadata[mi.slice(1)]=di[mi]:_i.data[mi]=di[mi]}return _i}function un(di,ci){di=di||[],ci=ci||{};try{return new Blob(di,ci)}catch(fi){if("TypeError"!==fi.name)throw fi;for(var li="undefined"===typeof BlobBuilder?"undefined"===typeof MSBlobBuilder?"undefined"===typeof MozBlobBuilder?WebKitBlobBuilder:MozBlobBuilder:MSBlobBuilder:BlobBuilder,ui=new li,pi=0;pi<di.length;pi+=1)ui.append(di[pi]);return ui.getBlob(ci.type)}}function pn(di){for(var ci=di.length,li=new ArrayBuffer(ci),ui=new Uint8Array(li),pi=0;pi<ci;pi++)ui[pi]=di.charCodeAt(pi);return li}function hn(di,ci){return un([pn(di)],{type:ci})}function fn(di,ci){return hn(Qa(di),ci)}function _n(di){for(var ci="",li=new Uint8Array(di),ui=li.byteLength,pi=0;pi<ui;pi++)ci+=String.fromCharCode(li[pi]);return ci}function mn(di,ci){if("undefined"===typeof FileReader)return ci(_n(new FileReaderSync().readAsArrayBuffer(di)));var li=new FileReader,ui="function"===typeof li.readAsBinaryString;li.onloadend=function(pi){var fi=pi.target.result||"";return ui?ci(fi):void ci(_n(fi))},ui?li.readAsBinaryString(di):li.readAsArrayBuffer(di)}function gn(di,ci){mn(di,function(li){ci(li)})}function yn(di,ci){gn(di,function(li){ci(Ja(li))})}function vn(di,ci){if("undefined"===typeof FileReader)return ci(new FileReaderSync().readAsArrayBuffer(di));var li=new FileReader;li.onloadend=function(ui){var pi=ui.target.result||new ArrayBuffer(0);ci(pi)},li.readAsArrayBuffer(di)}function bn(di){return Ja(di)}function En(di,ci,li){return di.webkitSlice?di.webkitSlice(ci,li):di.slice(ci,li)}function kn(di,ci,li,ui,pi){(0<li||ui<ci.size)&&(ci=En(ci,li,ui)),vn(ci,function(fi){di.append(fi),pi()})}function Sn(di,ci,li,ui,pi){(0<li||ui<ci.length)&&(ci=ci.substring(li,ui)),di.appendBinary(ci),pi()}function qn(di,ci){function li(){Ya(pi)}function ui(){var ki=vi.end(!0),Si=bn(ki);ci(Si),vi.destroy()}function pi(){var ki=yi*mi,Si=ki+mi;yi++,yi<gi?Ei(vi,di,ki,Si,li):Ei(vi,di,ki,Si,ui)}var fi="string"===typeof di,_i=fi?di.length:di.size,mi=Math.min(Za,_i),gi=Math.ceil(_i/mi),yi=0,vi=fi?new Yr:new Yr.ArrayBuffer,Ei=fi?Sn:kn;pi()}function wn(di){return Yr.hash(di)}function xn(di){try{return Qa(di)}catch(li){var ci=le(va,"Attachment is not a valid base64 string");return{error:ci}}}function Tn(di,ci,li){var ui=xn(di.data);return ui.error?li(ui.error):void(di.length=ui.length,di.data="blob"===ci?hn(ui,di.content_type):"base64"===ci?Ja(ui):ui,qn(ui,function(pi){di.digest="md5-"+pi,li()}))}function An(di,ci,li){qn(di.data,function(ui){di.digest="md5-"+ui,di.length=di.data.size||di.data.length||0,"binary"===ci?gn(di.data,function(pi){di.data=pi,li()}):"base64"===ci?yn(di.data,function(pi){di.data=pi,li()}):li()})}function Cn(di,ci,li){return di.stub?li():void("string"===typeof di.data?Tn(di,ci,li):An(di,ci,li))}function Ln(di,ci,li){function ui(){pi++,di.length===pi&&(fi?li(fi):li())}if(!di.length)return li();var pi=0,fi;di.forEach(function(_i){function mi(Ei){fi=Ei,yi++,yi===gi.length&&ui()}var gi=_i.data&&_i.data._attachments?Object.keys(_i.data._attachments):[],yi=0;if(!gi.length)return ui();for(var vi in _i.data._attachments)_i.data._attachments.hasOwnProperty(vi)&&Cn(_i.data._attachments[vi],ci,mi)})}function jn(di,ci,li,ui,pi,fi,_i,mi){if(Me(ci.rev_tree,li.metadata.rev))return ui[pi]=li,fi();var gi=ci.winningRev||xe(ci),yi="deleted"in ci?ci.deleted:He(ci,gi),vi="deleted"in li.metadata?li.metadata.deleted:He(li.metadata),Ei=/^1-/.test(li.metadata.rev);if(yi&&!vi&&mi&&Ei){var ki=li.data;ki._rev=gi,ki._id=li.metadata.id,li=ln(ki,mi)}var Si=Ue(ci.rev_tree,li.metadata.rev_tree[0],di),qi=mi&&(yi&&vi&&"new_leaf"!==Si.conflicts||!yi&&"new_leaf"!==Si.conflicts||yi&&!vi&&"new_branch"===Si.conflicts);if(qi){var wi=le(ha);return ui[pi]=wi,fi()}var xi=li.metadata.rev;li.metadata.rev_tree=Si.tree,li.stemmedRevs=Si.stemmedRevs||[],ci.rev_map&&(li.metadata.rev_map=ci.rev_map);var Ti=xe(li.metadata),Ai=He(li.metadata,Ti),Ci=yi===Ai?0:yi<Ai?-1:1,Li;Li=xi===Ti?Ai:He(li.metadata,xi),_i(li,Ti,Ai,Li,!0,Ci,pi,fi)}function On(di){return"missing"===di.metadata.rev_tree[0].ids[1].status}function Dn(di,ci,li,ui,pi,fi,_i,mi,gi){function yi(wi,xi,Ti){var Ai=xe(wi.metadata),Ci=He(wi.metadata,Ai);if("was_delete"in mi&&Ci)return fi[xi]=le(pa,"deleted"),Ti();var Li=Ei&&On(wi);if(Li){var ji=le(ha);return fi[xi]=ji,Ti()}var Oi=Ci?0:1;_i(wi,Ai,Ci,Ci,!1,Oi,xi,Ti)}function vi(){++Si===qi&&gi&&gi()}di=di||1e3;var Ei=mi.new_edits,ki=new ra,Si=0,qi=ci.length;ci.forEach(function(wi,xi){if(wi._id&&ze(wi._id)){var Ti=wi._deleted?"_removeLocal":"_putLocal";return void li[Ti](wi,{ctx:pi},function(Ci,Li){fi[xi]=Ci||Li,vi()})}var Ai=wi.metadata.id;ki.has(Ai)?(qi--,ki.get(Ai).push([wi,xi])):ki.set(Ai,[[wi,xi]])}),ki.forEach(function(wi,xi){function Ti(){++Ci<wi.length?Ai():vi()}function Ai(){var Li=wi[Ci],ji=Li[0],Oi=Li[1];if(ui.has(xi))jn(di,ui.get(xi),ji,fi,Oi,Ti,_i,Ei);else{var Di=Ue([],ji.metadata.rev_tree[0],di);ji.metadata.rev_tree=Di.tree,ji.stemmedRevs=Di.stemmedRevs||[],yi(ji,Oi,Ti)}}var Ci=0;Ai()})}function In(di){try{return JSON.parse(di)}catch(ci){return Zr.parse(di)}}function Nn(di){try{return JSON.stringify(di)}catch(ci){return Zr.stringify(di)}}function Rn(di){return function(ci){var li="unknown_error";ci.target&&ci.target.error&&(li=ci.target.error.name||ci.target.error.message),di(le(xa,li,ci.type))}}function $n(di,ci,li){return{data:Nn(di),winningRev:ci,deletedOrLocal:li?"1":"0",seq:di.seq,id:di.id}}function Pn(di){if(!di)return null;var ci=In(di.data);return ci.winningRev=di.winningRev,ci.deleted="1"===di.deletedOrLocal,ci.seq=di.seq,ci}function Fn(di){if(!di)return di;var ci=di._doc_id_rev.lastIndexOf(":");return di._id=di._doc_id_rev.substring(0,ci-1),di._rev=di._doc_id_rev.substring(ci+1),delete di._doc_id_rev,di}function Bn(di,ci,li,ui){li?di?"string"===typeof di?ui(fn(di,ci)):ui(di):ui(un([""],{type:ci})):di?"string"===typeof di?ui(di):mn(di,function(pi){ui(Ja(pi))}):ui("")}function Un(di,ci,li,ui){function pi(){++mi===_i.length&&ui&&ui()}function fi(gi,yi){var vi=gi._attachments[yi],Ei=vi.digest,ki=li.objectStore(ro).get(Ei);ki.onsuccess=function(Si){vi.body=Si.target.result.body,pi()}}var _i=Object.keys(di._attachments||{});if(!_i.length)return ui&&ui();var mi=0;_i.forEach(function(gi){ci.attachments&&ci.include_docs?fi(di,gi):(di._attachments[gi].stub=!0,pi())})}function Mn(di,ci){return ea.all(di.map(function(li){if(li.doc&&li.doc._attachments){var ui=Object.keys(li.doc._attachments);return ea.all(ui.map(function(pi){var fi=li.doc._attachments[pi];if("body"in fi){var _i=fi.body,mi=fi.content_type;return new ea(function(gi){Bn(_i,mi,ci,function(yi){li.doc._attachments[pi]=da(K(fi,["digest","content_type"]),{data:yi}),gi()})})}}))}}))}function Wn(di,ci,li){function ui(){yi--,yi||pi()}function pi(){fi.length&&fi.forEach(function(vi){var Ei=gi.index("digestSeq").count(IDBKeyRange.bound(vi+"::",vi+"::\uFFFF",!1,!1));Ei.onsuccess=function(ki){var Si=ki.target.result;Si||mi["delete"](vi)}})}var fi=[],_i=li.objectStore(so),mi=li.objectStore(ro),gi=li.objectStore(ao),yi=di.length;di.forEach(function(vi){var Ei=_i.index("_doc_id_rev");Ei.getKey(ci+"::"+vi).onsuccess=function(Si){var qi=Si.target.result;if("number"!==typeof qi)return ui();_i["delete"](qi);var wi=gi.index("seq").openCursor(IDBKeyRange.only(qi));wi.onsuccess=function(xi){var Ti=xi.target.result;if(Ti){var Ai=Ti.value.digestSeq.split("::")[0];fi.push(Ai),gi["delete"](Ti.primaryKey),Ti["continue"]()}else ui()}}})}function Hn(di,ci,li){try{return{txn:di.transaction(ci,li)}}catch(ui){return{error:ui}}}function zn(di,ci,li,ui,pi,fi){function _i(){var Vi=Hn(pi,[no,so,ro,io,ao,oo],"readwrite");return Vi.error?fi(Vi.error):void(Li=Vi.txn,Li.onabort=Rn(fi),Li.ontimeout=Rn(fi),Li.oncomplete=Ei,ji=Li.objectStore(no),Oi=Li.objectStore(so),Di=Li.objectStore(ro),Ii=Li.objectStore(ao),Ni=Li.objectStore(oo),Ni.get(oo).onsuccess=function(Ki){$i=Ki.target.result,yi()},Si(function(Ki){return Ki?(zi=!0,fi(Ki)):void vi()}))}function mi(){Ui=!0,yi()}function gi(){Dn(di.revs_limit,Ci,ui,Hi,Li,Wi,qi,li,mi)}function yi(){$i&&Ui&&($i.docCount+=Mi,Ni.put($i))}function vi(){function Gi(){++Ki===Ci.length&&gi()}function Vi(ed){var td=Pn(ed.target.result);td&&Hi.set(td.id,td),Gi()}if(Ci.length)for(var Ki=0,Qi=0,Ji=Ci.length,Yi;Qi<Ji;Qi++){if(Yi=Ci[Qi],Yi._id&&ze(Yi._id)){Gi();continue}var Zi=ji.get(Yi.metadata.id);Zi.onsuccess=Vi}}function Ei(){zi||(uo.notify(ui._meta.name),fi(null,Wi))}function ki(Gi,Vi){var Ki=Di.get(Gi);Ki.onsuccess=function(Qi){if(!Qi.target.result){var Ji=le(Oa,"unknown stub attachment with digest "+Gi);Ji.status=412,Vi(Ji)}else Vi()}}function Si(Gi){function Vi(){++Qi===Ki.length&&Gi(Ji)}var Ki=[];if(Ci.forEach(function(Yi){Yi.data&&Yi.data._attachments&&Object.keys(Yi.data._attachments).forEach(function(Zi){var ed=Yi.data._attachments[Zi];ed.stub&&Ki.push(ed.digest)})}),!Ki.length)return Gi();var Qi=0,Ji;Ki.forEach(function(Yi){ki(Yi,function(Zi){Zi&&!Ji&&(Ji=Zi),Vi()})})}function qi(Gi,Vi,Ki,Qi,Ji,Yi,Zi,ed){Gi.metadata.winningRev=Vi,Gi.metadata.deleted=Ki;var td=Gi.data;td._id=Gi.metadata.id,td._rev=Gi.metadata.rev,Qi&&(td._deleted=!0);var nd=td._attachments&&Object.keys(td._attachments).length;return nd?xi(Gi,Vi,Ki,Ji,Zi,ed):void(Mi+=Yi,yi(),wi(Gi,Vi,Ki,Ji,Zi,ed))}function wi(Gi,Vi,Ki,Qi,Ji,Yi){function Zi(ad){var od=Gi.stemmedRevs||[];Qi&&ui.auto_compaction&&(od=od.concat(je(Gi.metadata))),od&&od.length&&Wn(od,Gi.metadata.id,Li),sd.seq=ad.target.result;var dd=$n(sd,Vi,Ki),cd=ji.put(dd);cd.onsuccess=td}function td(){Wi[Ji]={ok:!0,id:sd.id,rev:sd.rev},Hi.set(Gi.metadata.id,Gi.metadata),Ti(Gi,sd.seq,Yi)}var nd=Gi.data,sd=Gi.metadata;nd._doc_id_rev=sd.id+"::"+sd.rev,delete nd._id,delete nd._rev;var rd=Oi.put(nd);rd.onsuccess=Zi,rd.onerror=function(ad){ad.preventDefault(),ad.stopPropagation();var od=Oi.index("_doc_id_rev"),dd=od.getKey(nd._doc_id_rev);dd.onsuccess=function(cd){var ld=Oi.put(nd,cd.target.result);ld.onsuccess=Zi}}}function xi(Gi,Vi,Ki,Qi,Ji,Yi){function Zi(){nd===sd.length&&wi(Gi,Vi,Ki,Qi,Ji,Yi)}function ed(){nd++,Zi()}var td=Gi.data,nd=0,sd=Object.keys(td._attachments);sd.forEach(function(rd){var ad=Gi.data._attachments[rd];if(!ad.stub){var od=ad.data;delete ad.data,ad.revpos=parseInt(Vi,10);var dd=ad.digest;Ai(dd,od,ed)}else nd++,Zi()})}function Ti(Gi,Vi,Ki){function Qi(){++Yi===Zi.length&&Ki()}function Ji(td){var nd=Gi.data._attachments[td].digest,sd=Ii.put({seq:Vi,digestSeq:nd+"::"+Vi});sd.onsuccess=Qi,sd.onerror=function(rd){rd.preventDefault(),rd.stopPropagation(),Qi()}}var Yi=0,Zi=Object.keys(Gi.data._attachments||{});if(!Zi.length)return Ki();for(var ed=0;ed<Zi.length;ed++)Ji(Zi[ed])}function Ai(Gi,Vi,Ki){var Qi=Di.count(Gi);Qi.onsuccess=function(Ji){var Yi=Ji.target.result;if(Yi)return Ki();var ed=Di.put({digest:Gi,body:Vi});ed.onsuccess=Ki}}for(var Ci=ci.docs,Pi=0,Fi=Ci.length,Li,ji,Oi,Di,Ii,Ni,Ri,$i,Bi;Pi<Fi;Pi++)(Bi=Ci[Pi],!(Bi._id&&ze(Bi._id)))&&(Bi=Ci[Pi]=ln(Bi,li.new_edits),Bi.error&&!Ri&&(Ri=Bi));if(Ri)return fi(Ri);var Ui=!1,Mi=0,Wi=Array(Ci.length),Hi=new ra,zi=!1,Xi=ui._meta.blobSupport?"blob":"base64";Ln(Ci,Xi,function(Gi){return Gi?fi(Gi):void _i()})}function Xn(di,ci,li,ui,pi){function fi(Si){Ei=Si.target.result,vi&&pi(vi,Ei,ki)}function _i(Si){vi=Si.target.result,Ei&&pi(vi,Ei,ki)}function gi(Si){var qi=Si.target.result;return qi?void pi([qi.key],[qi.value],qi):pi()}var yi="function"===typeof di.getAll&&"function"===typeof di.getAllKeys&&1<ui&&!li,vi,Ei,ki;yi?(ki={continue:function(){if(!vi.length)return pi();var Si=vi[vi.length-1],qi;if(ci&&ci.upper)try{qi=IDBKeyRange.bound(Si,ci.upper,!0,ci.upperOpen)}catch(wi){if("DataError"===wi.name&&0===wi.code)return pi()}else qi=IDBKeyRange.lowerBound(Si,!0);ci=qi,vi=null,Ei=null,di.getAll(ci,ui).onsuccess=fi,di.getAllKeys(ci,ui).onsuccess=_i}},di.getAll(ci,ui).onsuccess=fi,di.getAllKeys(ci,ui).onsuccess=_i):li?di.openCursor(ci,"prev").onsuccess=gi:di.openCursor(ci).onsuccess=gi}function Gn(di,ci,li){if("function"===typeof di.getAll)return void(di.getAll(ci).onsuccess=li);var pi=[];di.openCursor(ci).onsuccess=function(fi){var _i=fi.target.result;_i?(pi.push(_i.value),_i["continue"]()):li({target:{result:pi}})}}function Vn(di,ci,li,ui,pi){try{if(di&&ci)return pi?IDBKeyRange.bound(ci,di,!li,!1):IDBKeyRange.bound(di,ci,!1,!li);if(di)return pi?IDBKeyRange.upperBound(di):IDBKeyRange.lowerBound(di);if(ci)return pi?IDBKeyRange.lowerBound(ci,!li):IDBKeyRange.upperBound(ci,!li);if(ui)return IDBKeyRange.only(ui)}catch(fi){return{error:fi}}return null}function Kn(di,ci,li){function ui($i,Pi,Fi){var Bi=$i.id+"::"+Fi;Ii.get(Bi).onsuccess=function(Mi){if(Pi.doc=Fn(Mi.target.result),di.conflicts){var Wi=Le($i);Wi.length&&(Pi.doc._conflicts=Wi)}Un(Pi.doc,di,Li)}}function pi($i,Pi){var Fi={id:Pi.id,key:Pi.id,value:{rev:$i}},Bi=Pi.deleted;"ok"===di.deleted?(Ni.push(Fi),Bi?(Fi.value.deleted=!0,Fi.doc=null):di.include_docs&&ui(Pi,Fi,$i)):!Bi&&0>=Si--&&(Ni.push(Fi),di.include_docs&&ui(Pi,Fi,$i))}function fi($i){for(var Pi=0,Fi=$i.length;Pi<Fi&&Ni.length!==qi;Pi++){var Bi=$i[Pi],Ui=Pn(Bi),Mi=Ui.winningRev;pi(Mi,Ui)}}function gi(){li(null,{total_rows:Ri,offset:di.skip,rows:Ni})}var vi=!!("startkey"in di)&&di.startkey,Ei=!!("endkey"in di)&&di.endkey,ki=!!("key"in di)&&di.key,Si=di.skip||0,qi="number"===typeof di.limit?di.limit:-1,wi=!1!==di.inclusive_end,xi=Vn(vi,Ei,wi,ki,di.descending),Ti=xi&&xi.error;if(Ti&&("DataError"!==Ti.name||0!==Ti.code))return li(le(xa,Ti.name,Ti.message));var Ai=[no,so,oo];di.attachments&&Ai.push(ro);var Ci=Hn(ci,Ai,"readonly");if(Ci.error)return li(Ci.error);var Li=Ci.txn;Li.oncomplete=function(){di.attachments?Mn(Ni,di.binary).then(gi):gi()},Li.onabort=Rn(li);var ji=Li.objectStore(no),Oi=Li.objectStore(so),Di=Li.objectStore(oo),Ii=Oi.index("_doc_id_rev"),Ni=[],Ri;return Di.get(oo).onsuccess=function($i){Ri=$i.target.result.docCount},Ti||0===qi?void 0:-1===qi?Gn(ji,xi,function($i){var Pi=$i.target.result;di.descending&&(Pi=Pi.reverse()),fi(Pi)}):void Xn(ji,xi,di.descending,qi+Si,function($i,Pi,Fi){Fi&&(fi(Pi),Ni.length<qi&&Fi["continue"]())})}function Qn(di){return new ea(function(ci){var li=un([""]),ui=di.objectStore(co).put(li,"key");ui.onsuccess=function(){var pi=navigator.userAgent.match(/Chrome\/(\d+)/),fi=navigator.userAgent.match(/Edge\//);ci(fi||!pi||43<=parseInt(pi[1],10))},di.onabort=function(pi){pi.preventDefault(),pi.stopPropagation(),ci(!1)}})["catch"](function(){return!1})}function Jn(di,ci){var li=di.objectStore(no).index("deletedOrLocal");li.count(IDBKeyRange.only("0")).onsuccess=function(ui){ci(ui.target.result)}}function Yn(di,ci,li,ui){try{di(ci,li)}catch(pi){ui.emit("error",pi)}}function Zn(){po||!ho.length||(po=!0,ho.shift()())}function es(di,ci,li){ho.push(function(){di(function(fi,_i){Yn(ci,fi,_i,li),po=!1,Qr(function(){Zn(li)})})}),Zn()}function ts(di,ci,li,ui){function fi(Ni,Ri,$i,Pi){if($i.seq!==Ri)return Pi();if($i.winningRev===Ni._rev)return Pi($i,Ni);var Fi=Ni._id+"::"+$i.winningRev,Bi=ji.get(Fi);Bi.onsuccess=function(Ui){Pi($i,Fn(Ui.target.result))}}function _i(Ni,Ri,$i){if(vi&&!vi.has(Ni._id))return $i();var Pi=Ti.get(Ni._id);return Pi?fi(Ni,Ri,Pi,$i):void(Li.get(Ni._id).onsuccess=function(Fi){Pi=Pn(Fi.target.result),Ti.set(Ni._id,Pi),fi(Ni,Ri,Pi,$i)})}function mi(){di.complete(null,{results:qi,last_seq:Ei})}if(di=F(di),di.continuous){var yi=li+":"+Ba();return uo.addListener(li,yi,ci,di),uo.notify(li),{cancel:function(){uo.removeListener(li,yi)}}}var vi=di.doc_ids&&new sa(di.doc_ids);di.since=di.since||0;var Ei=di.since,ki="limit"in di?di.limit:-1;0===ki&&(ki=1);var Si="return_docs"in di?di.return_docs:!("returnDocs"in di)||di.returnDocs;var qi=[],wi=0,xi=he(di),Ti=new ra,Oi=[no,so],Ai,Ci,Li,ji;di.attachments&&Oi.push(ro);var Di=Hn(ui,Oi,"readonly");if(Di.error)return di.complete(Di.error);Ai=Di.txn,Ai.onabort=Rn(di.complete),Ai.oncomplete=function(){!di.continuous&&di.attachments?Mn(qi).then(mi):mi()},Ci=Ai.objectStore(so),Li=Ai.objectStore(no),ji=Ci.index("_doc_id_rev");var Ii=di.since&&!di.descending?IDBKeyRange.lowerBound(di.since,!0):null;Xn(Ci,Ii,di.descending,ki,function(Ni,Ri,$i){function Pi(Wi,Hi){var zi=di.processChange(Hi,Wi,di);Ei=zi.seq=Wi.seq;var Xi=xi(zi);return"object"===("undefined"===typeof Xi?"undefined":babelHelpers.typeof(Xi))?di.complete(Xi):void(Xi&&(wi++,Si&&qi.push(zi),di.attachments&&di.include_docs?Un(Hi,di,Ai,function(){Mn([zi],di.binary).then(function(){di.onChange(zi)})}):di.onChange(zi)))}function Fi(){for(var Wi=0,Hi=Bi.length,zi;Wi<Hi&&wi!==ki;Wi++)if(zi=Bi[Wi],zi){var Xi=Ui[Wi];Pi(Xi,zi)}wi!==ki&&$i["continue"]()}if($i&&Ni.length){var Bi=Array(Ni.length),Ui=Array(Ni.length),Mi=0;Ri.forEach(function(Wi,Hi){var zi=Fn(Wi),Xi=Ni[Hi];_i(zi,Xi,function(Gi,Vi){Ui[Hi]=Gi,Bi[Hi]=Vi,++Mi===Ni.length&&Fi()})})}})}function ns(di,ci){var li=this;es(function(ui){ss(li,di,ui)},ci,li.constructor)}function ss(di,ci,li){function ui(qi){var wi=qi.createObjectStore(no,{keyPath:"id"});qi.createObjectStore(so,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),qi.createObjectStore(ro,{keyPath:"digest"}),qi.createObjectStore(oo,{keyPath:"id",autoIncrement:!1}),qi.createObjectStore(co),wi.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),qi.createObjectStore(io,{keyPath:"_id"});var xi=qi.createObjectStore(ao,{autoIncrement:!0});xi.createIndex("seq","seq"),xi.createIndex("digestSeq","digestSeq",{unique:!0})}function pi(qi,wi){var xi=qi.objectStore(no);xi.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),xi.openCursor().onsuccess=function(Ti){var Ai=Ti.target.result;if(Ai){var Ci=Ai.value,Li=He(Ci);Ci.deletedOrLocal=Li?"1":"0",xi.put(Ci),Ai["continue"]()}else wi()}}function fi(qi){qi.createObjectStore(io,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}function _i(qi,wi){var xi=qi.objectStore(io),Ti=qi.objectStore(no),Ai=qi.objectStore(so),Ci=Ti.openCursor();Ci.onsuccess=function(Li){var ji=Li.target.result;if(ji){var Oi=ji.value,Di=Oi.id,Ii=ze(Di),Ni=xe(Oi);if(Ii){var Fi=Ai.index("_doc_id_rev"),Bi=IDBKeyRange.bound(Di+"::",Di+"::~",!1,!1),Ui=Fi.openCursor(Bi);Ui.onsuccess=function(Mi){if(Ui=Mi.target.result,!Ui)Ti["delete"](ji.primaryKey),ji["continue"]();else{var Wi=Ui.value;Wi._doc_id_rev===Di+"::"+Ni&&xi.put(Wi),Ai["delete"](Ui.primaryKey),Ui["continue"]()}}}else ji["continue"]()}else wi&&wi()}}function mi(qi){var wi=qi.createObjectStore(ao,{autoIncrement:!0});wi.createIndex("seq","seq"),wi.createIndex("digestSeq","digestSeq",{unique:!0})}function gi(qi,wi){var xi=qi.objectStore(so),Ti=qi.objectStore(ro),Ai=qi.objectStore(ao),Ci=Ti.count();Ci.onsuccess=function(Li){var ji=Li.target.result;return ji?void(xi.openCursor().onsuccess=function(Oi){var Di=Oi.target.result;if(!Di)return wi();for(var Ii=Di.value,Ni=Di.primaryKey,Ri=Object.keys(Ii._attachments||{}),$i={},Pi=0,Fi;Pi<Ri.length;Pi++)Fi=Ii._attachments[Ri[Pi]],$i[Fi.digest]=!0;var Bi=Object.keys($i);for(Pi=0;Pi<Bi.length;Pi++){var Ui=Bi[Pi];Ai.put({seq:Ni,digestSeq:Ui+"::"+Ni})}Di["continue"]()}):wi()}}function yi(qi){function wi(Ci){return Ci.data?Pn(Ci):(Ci.deleted="1"===Ci.deletedOrLocal,Ci)}var xi=qi.objectStore(so),Ti=qi.objectStore(no),Ai=Ti.openCursor();Ai.onsuccess=function(Ci){function Li(){var Ii=Di.id+"::",Ni=Di.id+"::\uFFFF",Ri=xi.index("_doc_id_rev").openCursor(IDBKeyRange.bound(Ii,Ni)),$i=0;Ri.onsuccess=function(Pi){var Fi=Pi.target.result;if(!Fi)return Di.seq=$i,ji();var Bi=Fi.primaryKey;Bi>$i&&($i=Bi),Fi["continue"]()}}function ji(){var Ii=$n(Di,Di.winningRev,Di.deleted),Ni=Ti.put(Ii);Ni.onsuccess=function(){Oi["continue"]()}}var Oi=Ci.target.result;if(Oi){var Di=wi(Oi.value);return Di.winningRev=Di.winningRev||xe(Di),Di.seq?ji():void Li()}}}var vi=ci.name,Ei=null;di._meta=null,di._remote=!1,di.type=function(){return"idb"},di._id=U(function(qi){qi(null,di._meta.instanceId)}),di._bulkDocs=function(wi,xi,Ti){zn(ci,wi,xi,di,Ei,Ti)},di._get=function(wi,xi,Ti){function Ai(){Ti(ji,{doc:Ci,metadata:Li,ctx:Oi})}var Ci,Li,ji,Oi=xi.ctx;if(!Oi){var Di=Hn(Ei,[no,so,ro],"readonly");if(Di.error)return Ti(Di.error);Oi=Di.txn}Oi.objectStore(no).get(wi).onsuccess=function(Ii){if(Li=Pn(Ii.target.result),!Li)return ji=le(pa,"missing"),Ai();var Ni;if(!xi.rev){Ni=Li.winningRev;var Ri=He(Li);if(Ri)return ji=le(pa,"deleted"),Ai()}else Ni=xi.latest?Xe(xi.rev,Li):xi.rev;var $i=Oi.objectStore(so),Pi=Li.id+"::"+Ni;$i.index("_doc_id_rev").get(Pi).onsuccess=function(Fi){return Ci=Fi.target.result,Ci&&(Ci=Fn(Ci)),Ci?void Ai():(ji=le(pa,"missing"),Ai())}}},di._getAttachment=function(qi,wi,xi,Ti,Ai){var Ci;if(Ti.ctx)Ci=Ti.ctx;else{var Li=Hn(Ei,[no,so,ro],"readonly");if(Li.error)return Ai(Li.error);Ci=Li.txn}var ji=xi.digest,Oi=xi.content_type;Ci.objectStore(ro).get(ji).onsuccess=function(Di){var Ii=Di.target.result.body;Bn(Ii,Oi,Ti.binary,function(Ni){Ai(null,Ni)})}},di._info=function(wi){var xi,Ti,Ai=Hn(Ei,[oo,so],"readonly");if(Ai.error)return wi(Ai.error);var Ci=Ai.txn;Ci.objectStore(oo).get(oo).onsuccess=function(Li){Ti=Li.target.result.docCount},Ci.objectStore(so).openCursor(null,"prev").onsuccess=function(Li){var ji=Li.target.result;xi=ji?ji.key:0},Ci.oncomplete=function(){wi(null,{doc_count:Ti,update_seq:xi,idb_attachment_format:di._meta.blobSupport?"binary":"base64"})}},di._allDocs=function(wi,xi){Kn(wi,Ei,xi)},di._changes=function(wi){return ts(wi,di,vi,Ei)},di._close=function(qi){Ei.close(),fo["delete"](vi),qi()},di._getRevisionTree=function(qi,wi){var xi=Hn(Ei,[no],"readonly");if(xi.error)return wi(xi.error);var Ti=xi.txn,Ai=Ti.objectStore(no).get(qi);Ai.onsuccess=function(Ci){var Li=Pn(Ci.target.result);Li?wi(null,Li.rev_tree):wi(le(pa))}},di._doCompaction=function(qi,wi,xi){var Ai=Hn(Ei,[no,so,ro,ao],"readwrite");if(Ai.error)return xi(Ai.error);var Ci=Ai.txn,Li=Ci.objectStore(no);Li.get(qi).onsuccess=function(ji){var Oi=Pn(ji.target.result);Te(Oi.rev_tree,function(Ni,Ri,$i,Pi,Fi){-1!==wi.indexOf(Ri+"-"+$i)&&(Fi.status="missing")}),Wn(wi,qi,Ci);var Di=Oi.winningRev,Ii=Oi.deleted;Ci.objectStore(no).put($n(Oi,Di,Ii))},Ci.onabort=Rn(xi),Ci.oncomplete=function(){xi()}},di._getLocal=function(qi,wi){var xi=Hn(Ei,[io],"readonly");if(xi.error)return wi(xi.error);var Ti=xi.txn,Ai=Ti.objectStore(io).get(qi);Ai.onerror=Rn(wi),Ai.onsuccess=function(Ci){var Li=Ci.target.result;Li?(delete Li._doc_id_rev,wi(null,Li)):wi(le(pa))}},di._putLocal=function(qi,wi,xi){"function"===typeof wi&&(xi=wi,wi={}),delete qi._revisions;var Ti=qi._rev,Ai=qi._id;qi._rev=Ti?"0-"+(parseInt(Ti.split("-")[1],10)+1):"0-1";var Ci=wi.ctx,Li;if(!Ci){var ji=Hn(Ei,[io],"readwrite");if(ji.error)return xi(ji.error);Ci=ji.txn,Ci.onerror=Rn(xi),Ci.oncomplete=function(){Li&&xi(null,Li)}}var Oi=Ci.objectStore(io),Di;Ti?(Di=Oi.get(Ai),Di.onsuccess=function(Ii){var Ni=Ii.target.result;if(!Ni||Ni._rev!==Ti)xi(le(ha));else{var Ri=Oi.put(qi);Ri.onsuccess=function(){Li={ok:!0,id:qi._id,rev:qi._rev},wi.ctx&&xi(null,Li)}}}):(Di=Oi.add(qi),Di.onerror=function(Ii){xi(le(ha)),Ii.preventDefault(),Ii.stopPropagation()},Di.onsuccess=function(){Li={ok:!0,id:qi._id,rev:qi._rev},wi.ctx&&xi(null,Li)})},di._removeLocal=function(qi,wi,xi){"function"===typeof wi&&(xi=wi,wi={});var Ti=wi.ctx;if(!Ti){var Ai=Hn(Ei,[io],"readwrite");if(Ai.error)return xi(Ai.error);Ti=Ai.txn,Ti.oncomplete=function(){Ci&&xi(null,Ci)}}var Ci,Li=qi._id,ji=Ti.objectStore(io),Oi=ji.get(Li);Oi.onerror=Rn(xi),Oi.onsuccess=function(Di){var Ii=Di.target.result;Ii&&Ii._rev===qi._rev?(ji["delete"](Li),Ci={ok:!0,id:Li,rev:"0-0"},wi.ctx&&xi(null,Ci)):xi(le(pa))}},di._destroy=function(qi,wi){uo.removeAllListeners(vi);var xi=mo.get(vi);xi&&xi.result&&(xi.result.close(),fo["delete"](vi));var Ti=indexedDB.deleteDatabase(vi);Ti.onsuccess=function(){mo["delete"](vi),te()&&vi in localStorage&&delete localStorage[vi],wi(null,{ok:!0})},Ti.onerror=Rn(wi)};var ki=fo.get(vi);if(ki)return Ei=ki.idb,di._meta=ki.global,Qr(function(){li(null,di)});var Si;Si=ci.storage?rs(vi,ci.storage):indexedDB.open(vi,eo),mo.set(vi,Si),Si.onupgradeneeded=function(qi){function wi(){var Li=Ai[Ci-1];Ci++,Li&&Li(Ti,wi)}var xi=qi.target.result;if(1>qi.oldVersion)return ui(xi);var Ti=qi.currentTarget.transaction;3>qi.oldVersion&&fi(xi),4>qi.oldVersion&&mi(xi);var Ai=[pi,_i,gi,yi],Ci=qi.oldVersion;wi()},Si.onsuccess=function(qi){function wi(){"undefined"!==typeof ji&&Ai&&(di._meta={name:vi,instanceId:Oi,blobSupport:ji},fo.set(vi,{idb:Ei,global:di._meta}),li(null,di))}function xi(){if("undefined"!==typeof Li&&"undefined"!==typeof Ci){var Di=vi+"_id";Di in Ci?Oi=Ci[Di]:Ci[Di]=Oi=Ba(),Ci.docCount=Li,Ti.objectStore(oo).put(Ci)}}Ei=qi.target.result,Ei.onversionchange=function(){Ei.close(),fo["delete"](vi)},Ei.onabort=function(Di){ae("error","Database has a global failure",Di.target.error),Ei.close(),fo["delete"](vi)};var Ti=Ei.transaction([oo,co,no],"readwrite"),Ai=!1,Ci,Li,ji,Oi;Ti.objectStore(oo).get(oo).onsuccess=function(Di){Ci=Di.target.result||{id:oo},xi()},Jn(Ti,function(Di){Li=Di,xi()}),_o||(_o=Qn(Ti)),_o.then(function(Di){ji=Di,wi()}),Ti.oncomplete=function(){Ai=!0,wi()}},Si.onerror=function(){var qi="Failed to open indexedDB, are you in private browsing mode?";ae("error",qi),li(le(xa,qi))}}function rs(di,ci){try{return indexedDB.open(di,{version:eo,storage:ci})}catch(li){return indexedDB.open(di,eo)}}function as(di){return decodeURIComponent(escape(di))}function os(di){return 65>di?di-48:di-55}function is(di,ci,li){for(var ui="";ci<li;)ui+=String.fromCharCode(os(di.charCodeAt(ci++))<<4|os(di.charCodeAt(ci++)));return ui}function ds(di,ci,li){for(var ui="";ci<li;)ui+=String.fromCharCode(os(di.charCodeAt(ci+2))<<12|os(di.charCodeAt(ci+3))<<8|os(di.charCodeAt(ci))<<4|os(di.charCodeAt(ci+1))),ci+=4;return ui}function cs(di,ci){return"UTF-8"===ci?as(is(di,0,di.length)):ds(di,0,di.length)}function ls(di){return"'"+di+"'"}function us(di){return di.replace(/\u0002/g,"\x02\x02").replace(/\u0001/g,"\x01\x02").replace(/\u0000/g,"\x01\x01")}function ps(di){return di.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"\x01").replace(/\u0002\u0002/g,"\x02")}function hs(di){return delete di._id,delete di._rev,JSON.stringify(di)}function fs(di,ci,li){return di=JSON.parse(di),di._id=ci,di._rev=li,di}function _s(di){for(var ci="(";di--;)ci+="?",di&&(ci+=",");return ci+")"}function gs(di,ci,li,ui,pi){return"SELECT "+di+" FROM "+("string"===typeof ci?ci:ci.join(" JOIN "))+(li?" ON "+li:"")+(ui?" WHERE "+("string"===typeof ui?ui:ui.join(" AND ")):"")+(pi?" ORDER BY "+pi:"")}function ys(di,ci,li){function ui(){++fi===di.length&&pi()}function pi(){if(_i.length){var mi="SELECT DISTINCT digest AS digest FROM "+qo+" WHERE seq IN "+_s(_i.length);li.executeSql(mi,_i,function(gi,yi){for(var vi=[],Ei=0;Ei<yi.rows.length;Ei++)vi.push(yi.rows.item(Ei).digest);if(vi.length){var ki="DELETE FROM "+qo+" WHERE seq IN ("+_i.map(function(){return"?"}).join(",")+")";gi.executeSql(ki,_i,function(Si){var qi="SELECT digest FROM "+qo+" WHERE digest IN ("+vi.map(function(){return"?"}).join(",")+")";Si.executeSql(qi,vi,function(wi,xi){for(var Ti=new sa,Ai=0;Ai<xi.rows.length;Ai++)Ti.add(xi.rows.item(Ai).digest);vi.forEach(function(Ci){Ti.has(Ci)||(wi.executeSql("DELETE FROM "+qo+" WHERE digest=?",[Ci]),wi.executeSql("DELETE FROM "+Eo+" WHERE digest=?",[Ci]))})})})}})}}if(di.length){var fi=0,_i=[];di.forEach(function(mi){li.executeSql("SELECT seq FROM "+bo+" WHERE doc_id=? AND rev=?",[ci,mi],function(yi,vi){if(!vi.rows.length)return ui();var Ei=vi.rows.item(0).seq;_i.push(Ei),yi.executeSql("DELETE FROM "+bo+" WHERE seq=?",[Ei],ui)})})}}function vs(di){return function(ci){ae("error","WebSQL threw an error",ci);var li=ci&&ci.constructor.toString().match(/function ([^(]+)/),ui=li&&li[1]||ci.type,pi=ci.target||ci.message;di(le(Ta,pi,ui))}}function bs(di){if("size"in di)return 1e6*di.size;var ci="undefined"!==typeof navigator&&/Android/.test(navigator.userAgent);return ci?5e6:1}function Es(di,ci,li,ui,pi,fi,_i){function mi(){return ji?_i(ji):void(fi.notify(ui._name),_i(null,Ci))}function gi(Oi,Di){Ai.executeSql("SELECT count(*) as cnt FROM "+Eo+" WHERE digest=?",[Oi],function(Ni,Ri){if(0===Ri.rows.item(0).cnt){var $i=le(Oa,"unknown stub attachment with digest "+Oi);Di($i)}else Di()})}function yi(Oi){function Di(){++Ni===Ii.length&&Oi(Ri)}var Ii=[];if(xi.forEach(function($i){$i.data&&$i.data._attachments&&Object.keys($i.data._attachments).forEach(function(Pi){var Fi=$i.data._attachments[Pi];Fi.stub&&Ii.push(Fi.digest)})}),!Ii.length)return Oi();var Ni=0,Ri;Ii.forEach(function($i){gi($i,function(Pi){Pi&&!Ri&&(Ri=Pi),Di()})})}function vi(Oi,Di,Ii,Ni,Ri,$i,Pi,Fi){function Bi(){function Gi(td,nd){function sd(){return++ad===od.length&&nd(),!1}function rd(cd){var ud=[Vi._attachments[cd].digest,td];Ai.executeSql("INSERT INTO "+qo+" (digest, seq) VALUES (?,?)",ud,sd,sd)}var ad=0,od=Object.keys(Vi._attachments||{});if(!od.length)return nd();for(var dd=0;dd<od.length;dd++)rd(od[dd])}var Vi=Oi.data,Ki=Ni?1:0,Qi=Vi._id,Ji=Vi._rev,Yi=hs(Vi);Ai.executeSql("INSERT INTO "+bo+" (doc_id, rev, json, deleted) VALUES (?, ?, ?, ?);",[Qi,Ji,Yi,Ki],function(td,nd){var sd=nd.insertId;Gi(sd,function(){Wi(td,sd)})},function(){var td=gs("seq",bo,null,"doc_id=? AND rev=?");return Ai.executeSql(td,[Qi,Ji],function(nd,sd){var rd=sd.rows.item(0).seq;nd.executeSql("UPDATE "+bo+" SET json=?, deleted=? WHERE doc_id=? AND rev=?;",[Yi,Ki,Qi,Ji],function(dd){Gi(rd,function(){Wi(dd,rd)})})}),!1})}function Ui(Gi){Hi||(Gi?(Hi=Gi,Fi(Hi)):zi===Xi.length&&Bi())}function Mi(Gi){zi++,Ui(Gi)}function Wi(Gi,Vi){var Ki=Oi.metadata.id,Qi=Oi.stemmedRevs||[];Ri&&ui.auto_compaction&&(Qi=je(Oi.metadata).concat(Qi)),Qi.length&&ys(Qi,Ki,Gi),Oi.metadata.seq=Vi;var Ji=Oi.metadata.rev;delete Oi.metadata.rev;var Yi=Ri?"UPDATE "+vo+" SET json=?, max_seq=?, winningseq=(SELECT seq FROM "+bo+" WHERE doc_id="+vo+".id AND rev=?) WHERE id=?":"INSERT INTO "+vo+" (id, winningseq, max_seq, json) VALUES (?,?,?,?);",Zi=Nn(Oi.metadata),ed=Ri?[Zi,Vi,Di,Ki]:[Ki,Vi,Vi,Zi];Gi.executeSql(Yi,ed,function(){Ci[Pi]={ok:!0,id:Oi.metadata.id,rev:Ji},Li.set(Ki,Oi.metadata),Fi()})}var Hi=null,zi=0;Oi.data._id=Oi.metadata.id,Oi.data._rev=Oi.metadata.rev;var Xi=Object.keys(Oi.data._attachments||{});Ni&&(Oi.data._deleted=!0),Xi.forEach(function(Gi){var Vi=Oi.data._attachments[Gi];if(!Vi.stub){var Ki=Vi.data;delete Vi.data,Vi.revpos=parseInt(Di,10);var Qi=Vi.digest;Si(Qi,Ki,Mi)}else zi++,Ui()}),Xi.length||Bi()}function Ei(){Dn(di.revs_limit,xi,ui,Li,Ai,Ci,vi,li)}function ki(Oi){function Di(){++Ii===xi.length&&Oi()}if(!xi.length)return Oi();var Ii=0;xi.forEach(function(Ni){if(Ni._id&&ze(Ni._id))return Di();var Ri=Ni.metadata.id;Ai.executeSql("SELECT json FROM "+vo+" WHERE id = ?",[Ri],function($i,Pi){if(Pi.rows.length){var Fi=In(Pi.rows.item(0).json);Li.set(Ri,Fi)}Di()})})}function Si(Oi,Di,Ii){var Ni="SELECT digest FROM "+Eo+" WHERE digest=?";Ai.executeSql(Ni,[Oi],function(Ri,$i){return $i.rows.length?Ii():void(Ni="INSERT INTO "+Eo+" (digest, body, escaped) VALUES (?,?,1)",Ri.executeSql(Ni,[Oi,us(Di)],function(){Ii()},function(){return Ii(),!1}))})}var qi=li.new_edits,wi=ci.docs,xi=wi.map(function(Oi){if(Oi._id&&ze(Oi._id))return Oi;var Di=ln(Oi,qi);return Di}),Ti=xi.filter(function(Oi){return Oi.error});if(Ti.length)return _i(Ti[0]);var Ai,Ci=Array(xi.length),Li=new ra,ji;Ln(xi,"binary",function(Oi){return Oi?_i(Oi):void pi.transaction(function(Di){Ai=Di,yi(function(Ii){Ii?ji=Ii:ki(Ei)})},vs(_i),mi)})}function ks(di){return di.websql(di.name,di.version,di.description,di.size)}function Ss(di){try{return{db:ks(di)}}catch(ci){return{error:ci}}}function qs(di){var ci=wo.get(di.name);return ci||(ci=Ss(di),wo.set(di.name,ci)),ci}function ws(di,ci,li,ui,pi){function fi(){++gi===mi.length&&pi&&pi()}function _i(yi,vi){var Ei=yi._attachments[vi],ki={binary:ci.binary,ctx:ui};li._getAttachment(yi._id,vi,Ei,ki,function(Si,qi){yi._attachments[vi]=da(K(Ei,["digest","content_type"]),{data:qi}),fi()})}var mi=Object.keys(di._attachments||{});if(!mi.length)return pi&&pi();var gi=0;mi.forEach(function(yi){ci.attachments&&ci.include_docs?_i(di,yi):(di._attachments[yi].stub=!0,fi())})}function xs(di,ci){function li(){te()&&(window.localStorage["_pouch__websqldb_"+Ti._name]=!0),ci(null,Ti)}function ui(Ni,Ri){Ni.executeSql(Lo),Ni.executeSql("ALTER TABLE "+bo+" ADD COLUMN deleted TINYINT(1) DEFAULT 0",[],function(){Ni.executeSql(Ao),Ni.executeSql("ALTER TABLE "+vo+" ADD COLUMN local TINYINT(1) DEFAULT 0",[],function(){Ni.executeSql("CREATE INDEX IF NOT EXISTS 'doc-store-local-idx' ON "+vo+" (local, id)");Ni.executeSql("SELECT "+vo+".winningseq AS seq, "+vo+".json AS metadata FROM "+bo+" JOIN "+vo+" ON "+bo+".seq = "+vo+".winningseq",[],function(Pi,Fi){for(var Bi=[],Ui=[],Mi=0;Mi<Fi.rows.length;Mi++){var Wi=Fi.rows.item(Mi),Hi=Wi.seq,zi=JSON.parse(Wi.metadata);He(zi)&&Bi.push(Hi),ze(zi.id)&&Ui.push(zi.id)}Pi.executeSql("UPDATE "+vo+"SET local = 1 WHERE id IN "+_s(Ui.length),Ui,function(){Pi.executeSql("UPDATE "+bo+" SET deleted = 1 WHERE seq IN "+_s(Bi.length),Bi,Ri)})})})})}function pi(Ni,Ri){Ni.executeSql("CREATE TABLE IF NOT EXISTS "+ko+" (id UNIQUE, rev, json)",[],function(){Ni.executeSql("SELECT "+vo+".id AS id, "+bo+".json AS data FROM "+bo+" JOIN "+vo+" ON "+bo+".seq = "+vo+".winningseq WHERE local = 1",[],function(Fi,Bi){function Ui(){if(!Mi.length)return Ri(Fi);var Hi=Mi.shift(),zi=JSON.parse(Hi.data)._rev;Fi.executeSql("INSERT INTO "+ko+" (id, rev, json) VALUES (?,?,?)",[Hi.id,zi,Hi.data],function(Xi){Xi.executeSql("DELETE FROM "+vo+" WHERE id=?",[Hi.id],function(Gi){Gi.executeSql("DELETE FROM "+bo+" WHERE seq=?",[Hi.seq],function(){Ui()})})})}for(var Mi=[],Wi=0;Wi<Bi.rows.length;Wi++)Mi.push(Bi.rows.item(Wi));Ui()})})}function fi(Ni,Ri){function $i(Fi){function Bi(){if(!Fi.length)return Ri(Ni);var Ui=Fi.shift(),Mi=cs(Ui.hex,ji),Wi=Mi.lastIndexOf("::"),Hi=Mi.substring(0,Wi),zi=Mi.substring(Wi+2);Ni.executeSql("UPDATE "+bo+" SET doc_id=?, rev=? WHERE doc_id_rev=?",[Hi,zi,Mi],function(){Bi()})}Bi()}Ni.executeSql("ALTER TABLE "+bo+" ADD COLUMN doc_id",[],function(Fi){Fi.executeSql("ALTER TABLE "+bo+" ADD COLUMN rev",[],function(Ui){Ui.executeSql(Co,[],function(Mi){Mi.executeSql("SELECT hex(doc_id_rev) as hex FROM "+bo,[],function(Hi,zi){for(var Xi=[],Gi=0;Gi<zi.rows.length;Gi++)Xi.push(zi.rows.item(Gi));$i(Xi)})})})})}function _i(Ni,Ri){function $i(Fi){Fi.executeSql("SELECT COUNT(*) AS cnt FROM "+Eo,[],function(Ui,Mi){function Wi(){var Gi=gs(Io+", "+vo+".id AS id",[vo,bo],Do,null,vo+".id ");Gi+=" LIMIT "+Xi+" OFFSET "+zi,zi+=Xi,Ui.executeSql(Gi,[],function(Vi,Ki){function Qi(od,dd){var cd=Ji[od]=Ji[od]||[];-1===cd.indexOf(dd)&&cd.push(dd)}if(!Ki.rows.length)return Ri(Vi);for(var Ji={},Yi=0;Yi<Ki.rows.length;Yi++)for(var Zi=Ki.rows.item(Yi),ed=fs(Zi.data,Zi.id,Zi.rev),td=Object.keys(ed._attachments||{}),nd=0,sd;nd<td.length;nd++)sd=ed._attachments[td[nd]],Qi(sd.digest,Zi.seq);var rd=[];if(Object.keys(Ji).forEach(function(od){var dd=Ji[od];dd.forEach(function(cd){rd.push([od,cd])})}),!rd.length)return Wi();var ad=0;rd.forEach(function(od){Vi.executeSql("INSERT INTO "+qo+" (digest, seq) VALUES (?,?)",od,function(){++ad===rd.length&&Wi()})})})}var Hi=Mi.rows.item(0).cnt;if(!Hi)return Ri(Ui);var zi=0,Xi=10;Wi()})}Ni.executeSql("CREATE TABLE IF NOT EXISTS "+qo+" (digest, seq INTEGER)",[],function(Fi){Fi.executeSql(Oo,[],function(Bi){Bi.executeSql(jo,[],$i)})})}function mi(Ni,Ri){Ni.executeSql("ALTER TABLE "+Eo+" ADD COLUMN escaped TINYINT(1) DEFAULT 0",[],Ri)}function gi(Ni,Ri){Ni.executeSql("ALTER TABLE "+vo+" ADD COLUMN max_seq INTEGER",[],function(Pi){Pi.executeSql("UPDATE "+vo+" SET max_seq=(SELECT MAX(seq) FROM "+bo+" WHERE doc_id=id)",[],function(Bi){Bi.executeSql("CREATE UNIQUE INDEX IF NOT EXISTS 'doc-max-seq-idx' ON "+vo+" (max_seq)",[],Ri)})})}function yi(Ni,Ri){Ni.executeSql("SELECT HEX(\"a\") AS hex",[],function($i,Pi){var Fi=Pi.rows.item(0).hex;ji=2===Fi.length?"UTF-8":"UTF-16",Ri()})}function vi(){for(;0<Li.length;){var Ni=Li.pop();Ni(null,Ai)}}function Ei(Ni,Ri){if(0===Ri){Ni.executeSql("CREATE TABLE IF NOT EXISTS "+Eo+" (digest UNIQUE, escaped TINYINT(1), body BLOB)"),Ni.executeSql("CREATE TABLE IF NOT EXISTS "+ko+" (id UNIQUE, rev, json)"),Ni.executeSql("CREATE TABLE IF NOT EXISTS "+qo+" (digest, seq INTEGER)",[],function(){Ni.executeSql(jo),Ni.executeSql(Oo)}),Ni.executeSql("CREATE TABLE IF NOT EXISTS "+vo+" (id unique, json, winningseq, max_seq INTEGER UNIQUE)",[],function(){Ni.executeSql(Lo),Ni.executeSql("CREATE TABLE IF NOT EXISTS "+bo+" (seq INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, json, deleted TINYINT(1), doc_id, rev)",[],function(){Ni.executeSql(Ao),Ni.executeSql(Co),Ni.executeSql("CREATE TABLE IF NOT EXISTS "+So+" (dbid, db_version INTEGER)",[],function(){Ai=Ba();var Vi=[yo,Ai];Ni.executeSql("INSERT INTO "+So+" (db_version, dbid) VALUES (?,?)",Vi,function(){vi()})})})})}else{var Wi=function(){Ri<yo&&Ni.executeSql("UPDATE "+So+" SET db_version = "+yo);Ni.executeSql("SELECT dbid FROM "+So,[],function(Qi,Ji){Ai=Ji.rows.item(0).dbid,vi()})},Hi=[ui,pi,fi,_i,mi,gi,Wi],zi=Ri,Xi=function Gi(Vi){Hi[zi-1](Vi,Gi),zi++};Xi(Ni)}}function Si(Ni){Ni.executeSql("SELECT sql FROM sqlite_master WHERE tbl_name = "+So,[],function($i,Pi){Pi.rows.length?/db_version/.test(Pi.rows.item(0).sql)?$i.executeSql("SELECT db_version FROM "+So,[],function(Fi,Bi){var Ui=Bi.rows.item(0).db_version;Ei(Fi,Ui)}):$i.executeSql("ALTER TABLE "+So+" ADD COLUMN db_version INTEGER",[],function(){Ei($i,1)}):Ei($i,0)})}function qi(Ni,Ri){Ni.executeSql("SELECT MAX(seq) AS seq FROM "+bo,[],function(Pi,Fi){var Bi=Fi.rows.item(0).seq||0;Ri(Bi)})}function wi(Ni,Ri){var $i=gs("COUNT("+vo+".id) AS 'num'",[vo,bo],Do,bo+".deleted=0");Ni.executeSql($i,[],function(Pi,Fi){Ri(Fi.rows.item(0).num)})}function xi(Ni,Ri,$i,Pi,Fi){var Bi=gs(Io,[vo,bo],Do,vo+".id=?");Ni.executeSql(Bi,[Ri],function(Mi,Wi){if(!Wi.rows.length){var Hi=le(pa,"missing");return Fi(Hi)}var zi=Wi.rows.item(0),Xi=In(zi.metadata);Pi(Xe($i,Xi))})}var Ti=this,Ai=null,Ci=bs(di),Li=[],ji;Ti._name=di.name;var Oi=da({},di,{version:To,description:di.name,size:Ci}),Di=qs(Oi);if(Di.error)return vs(ci)(Di.error);var Ii=Di.db;"function"!==typeof Ii.readTransaction&&(Ii.readTransaction=Ii.transaction),function(){Ii.transaction(function(Ni){yi(Ni,function(){Si(Ni)})},vs(ci),li)}(),Ti._remote=!1,Ti.type=function(){return"websql"},Ti._id=U(function(Ni){Ni(null,Ai)}),Ti._info=function(Ni){var Ri,$i;Ii.readTransaction(function(Pi){qi(Pi,function(Fi){Ri=Fi}),wi(Pi,function(Fi){$i=Fi})},vs(Ni),function(){Ni(null,{doc_count:$i,update_seq:Ri,websql_encoding:ji})})},Ti._bulkDocs=function(Ni,Ri,$i){Es(di,Ni,Ri,Ti,Ii,xo,$i)},Ti._get=function(Ni,Ri,$i){function Pi(Hi){$i(Hi,{doc:Fi,metadata:Bi,ctx:Ui})}var Fi,Bi,Ui=Ri.ctx;if(!Ui)return Ii.readTransaction(function(Hi){Ti._get(Ni,da({ctx:Hi},Ri),$i)});var Mi,Wi;if(!Ri.rev)Mi=gs(Io,[vo,bo],Do,vo+".id=?"),Wi=[Ni];else{if(Ri.latest)return void xi(Ui,Ni,Ri.rev,function(Hi){Ri.latest=!1,Ri.rev=Hi,Ti._get(Ni,Ri,$i)},Pi);Mi=gs(Io,[vo,bo],vo+".id="+bo+".doc_id",[bo+".doc_id=?",bo+".rev=?"]),Wi=[Ni,Ri.rev]}Ui.executeSql(Mi,Wi,function(Hi,zi){if(!zi.rows.length){var Xi=le(pa,"missing");return Pi(Xi)}var Gi=zi.rows.item(0);if(Bi=In(Gi.metadata),Gi.deleted&&!Ri.rev){var Vi=le(pa,"deleted");return Pi(Vi)}Fi=fs(Gi.data,Bi.id,Gi.rev),Pi()})},Ti._allDocs=function(Ni,Ri){var $i=[],Pi,Fi=!!("startkey"in Ni)&&Ni.startkey,Bi=!!("endkey"in Ni)&&Ni.endkey,Ui=!!("key"in Ni)&&Ni.key,Mi=!!("descending"in Ni)&&Ni.descending,Wi="limit"in Ni?Ni.limit:-1,Hi="skip"in Ni?Ni.skip:0,zi=!1!==Ni.inclusive_end,Xi=[],Gi=[];if(!1!==Ui)Gi.push(vo+".id = ?"),Xi.push(Ui);else if(!1!==Fi||!1!==Bi){if(!1!==Fi&&(Gi.push(vo+".id "+(Mi?"<=":">=")+" ?"),Xi.push(Fi)),!1!==Bi){var Vi=Mi?">":"<";zi&&(Vi+="="),Gi.push(vo+".id "+Vi+" ?"),Xi.push(Bi)}!1!==Ui&&(Gi.push(vo+".id = ?"),Xi.push(Ui))}"ok"!==Ni.deleted&&Gi.push(bo+".deleted = 0"),Ii.readTransaction(function(Ki){if(wi(Ki,function(Ji){Pi=Ji}),0!==Wi){var Qi=gs(Io,[vo,bo],Do,Gi,vo+".id "+(Mi?"DESC":"ASC"));Qi+=" LIMIT "+Wi+" OFFSET "+Hi,Ki.executeSql(Qi,Xi,function(Ji,Yi){for(var Zi=0,ed=Yi.rows.length;Zi<ed;Zi++){var td=Yi.rows.item(Zi),nd=In(td.metadata),sd=nd.id,rd=fs(td.data,sd,td.rev),ad=rd._rev,od={id:sd,key:sd,value:{rev:ad}};if(Ni.include_docs){if(od.doc=rd,od.doc._rev=ad,Ni.conflicts){var dd=Le(nd);dd.length&&(od.doc._conflicts=dd)}ws(od.doc,Ni,Ti,Ji)}if(td.deleted)if("ok"===Ni.deleted)od.value.deleted=!0,od.doc=null;else continue;$i.push(od)}})}},vs(Ri),function(){Ri(null,{total_rows:Pi,offset:Ni.skip,rows:$i})})},Ti._changes=function(Ni){if(Ni=F(Ni),Ni.continuous){var $i=Ti._name+":"+Ba();return xo.addListener(Ti._name,$i,Ti,Ni),xo.notify(Ti._name),{cancel:function(){xo.removeListener(Ti._name,$i)}}}var Pi=Ni.descending;Ni.since=Ni.since&&!Pi?Ni.since:0;var Fi="limit"in Ni?Ni.limit:-1;0===Fi&&(Fi=1);var Bi="return_docs"in Ni?Ni.return_docs:!("returnDocs"in Ni)||Ni.returnDocs;var Ui=[],Mi=0;(function(){var Xi=["maxSeq > ?"],Gi=[Ni.since];Ni.doc_ids&&(Xi.push(vo+".id IN "+_s(Ni.doc_ids.length)),Gi=Gi.concat(Ni.doc_ids));var Vi="maxSeq "+(Pi?"DESC":"ASC"),Ki=gs(vo+".json AS metadata, "+vo+".max_seq AS maxSeq, "+bo+".json AS winningDoc, "+bo+".rev AS winningRev ",vo+" JOIN "+bo,vo+".id="+bo+".doc_id AND "+vo+".winningseq="+bo+".seq",Xi,Vi),Qi=he(Ni);Ni.view||Ni.filter||(Ki+=" LIMIT "+Fi);var Ji=Ni.since||0;Ii.readTransaction(function(Yi){Yi.executeSql(Ki,Gi,function(Zi,ed){function td(ld){return function(){Ni.onChange(ld)}}for(var nd=0,sd=ed.rows.length;nd<sd;nd++){var rd=ed.rows.item(nd),ad=In(rd.metadata);Ji=rd.maxSeq;var od=fs(rd.winningDoc,ad.id,rd.winningRev),dd=Ni.processChange(od,ad,Ni);dd.seq=rd.maxSeq;var cd=Qi(dd);if("object"===("undefined"===typeof cd?"undefined":babelHelpers.typeof(cd)))return Ni.complete(cd);if(cd&&(Mi++,Bi&&Ui.push(dd),Ni.attachments&&Ni.include_docs?ws(od,Ni,Ti,Zi,td(dd)):td(dd)()),Mi===Fi)break}})},vs(Ni.complete),function(){Ni.continuous||Ni.complete(null,{results:Ui,last_seq:Ji})})})()},Ti._close=function(Ni){Ni()},Ti._getAttachment=function(Ni,Ri,$i,Pi,Fi){var Bi,Ui=Pi.ctx,Mi=$i.digest,Wi=$i.content_type;Ui.executeSql("SELECT escaped, CASE WHEN escaped = 1 THEN body ELSE HEX(body) END AS body FROM "+Eo+" WHERE digest=?",[Mi],function(zi,Xi){var Gi=Xi.rows.item(0),Vi=Gi.escaped?ps(Gi.body):cs(Gi.body,ji);Bi=Pi.binary?hn(Vi,Wi):Ja(Vi),Fi(null,Bi)})},Ti._getRevisionTree=function(Ni,Ri){Ii.readTransaction(function($i){$i.executeSql("SELECT json AS metadata FROM "+vo+" WHERE id = ?",[Ni],function(Fi,Bi){if(!Bi.rows.length)Ri(le(pa));else{var Ui=In(Bi.rows.item(0).metadata);Ri(null,Ui.rev_tree)}})})},Ti._doCompaction=function(Ni,Ri,$i){return Ri.length?void Ii.transaction(function(Pi){Pi.executeSql("SELECT json AS metadata FROM "+vo+" WHERE id = ?",[Ni],function(Bi,Ui){var Mi=In(Ui.rows.item(0).metadata);Te(Mi.rev_tree,function(Hi,zi,Xi,Gi,Vi){-1!==Ri.indexOf(zi+"-"+Xi)&&(Vi.status="missing")});Bi.executeSql("UPDATE "+vo+" SET json = ? WHERE id = ?",[Nn(Mi),Ni])}),ys(Ri,Ni,Pi)},vs($i),function(){$i()}):$i()},Ti._getLocal=function(Ni,Ri){Ii.readTransaction(function($i){$i.executeSql("SELECT json, rev FROM "+ko+" WHERE id=?",[Ni],function(Fi,Bi){if(Bi.rows.length){var Ui=Bi.rows.item(0),Mi=fs(Ui.json,Ni,Ui.rev);Ri(null,Mi)}else Ri(le(pa))})})},Ti._putLocal=function(Ni,Ri,$i){function Pi(Hi){var zi,Xi;Fi?(zi="UPDATE "+ko+" SET rev=?, json=? WHERE id=? AND rev=?",Xi=[Ui,Mi,Bi,Fi]):(zi="INSERT INTO "+ko+" (id, rev, json) VALUES (?,?,?)",Xi=[Bi,Ui,Mi]),Hi.executeSql(zi,Xi,function(Gi,Vi){Vi.rowsAffected?(Wi={ok:!0,id:Bi,rev:Ui},Ri.ctx&&$i(null,Wi)):$i(le(ha))},function(){return $i(le(ha)),!1})}"function"===typeof Ri&&($i=Ri,Ri={}),delete Ni._revisions;var Fi=Ni._rev,Bi=Ni._id,Ui;Ui=Fi?Ni._rev="0-"+(parseInt(Fi.split("-")[1],10)+1):Ni._rev="0-1";var Mi=hs(Ni),Wi;Ri.ctx?Pi(Ri.ctx):Ii.transaction(Pi,vs($i),function(){Wi&&$i(null,Wi)})},Ti._removeLocal=function(Ni,Ri,$i){function Pi(Bi){var Mi=[Ni._id,Ni._rev];Bi.executeSql("DELETE FROM "+ko+" WHERE id=? AND rev=?",Mi,function(Wi,Hi){return Hi.rowsAffected?void(Fi={ok:!0,id:Ni._id,rev:"0-0"},Ri.ctx&&$i(null,Fi)):$i(le(pa))})}"function"===typeof Ri&&($i=Ri,Ri={});var Fi;Ri.ctx?Pi(Ri.ctx):Ii.transaction(Pi,vs($i),function(){Fi&&$i(null,Fi)})},Ti._destroy=function(Ni,Ri){xo.removeAllListeners(Ti._name),Ii.transaction(function($i){[vo,bo,Eo,So,ko,qo].forEach(function(Fi){$i.executeSql("DROP TABLE IF EXISTS "+Fi,[])})},vs(Ri),function(){te()&&(delete window.localStorage["_pouch__websqldb_"+Ti._name],delete window.localStorage[Ti._name]),Ri(null,{ok:!0})})}}function Ts(){try{return openDatabase("_pouch_validate_websql",1,"",1),!0}catch(di){return!1}}function As(){if("undefined"===typeof indexedDB||null===indexedDB||!/iP(hone|od|ad)/.test(navigator.userAgent))return!0;var di=te(),ci="_pouch__websqldb_valid_"+navigator.userAgent;if(di&&localStorage[ci])return"1"===localStorage[ci];var li=Ts();return di&&(localStorage[ci]=li?"1":"0"),li}function Ls(di,ci,li,ui){return openDatabase(di,ci,li,ui)}function js(di,ci){var li=da({websql:Ls},di);xs.call(this,li,ci)}function Os(){for(var di={},ci=new ea(function(pi,fi){di.resolve=pi,di.reject=fi}),li=Array(arguments.length),ui=0;ui<li.length;ui++)li[ui]=arguments[ui];return di.promise=ci,ea.resolve().then(function(){return fetch.apply(null,li)}).then(function(pi){di.resolve(pi)})["catch"](function(pi){di.reject(pi)}),di}function Ds(di,ci){var fi=new Headers,_i={method:di.method,credentials:"include",headers:fi},li,ui,pi;return di.json&&(fi.set("Accept","application/json"),fi.set("Content-Type",di.headers["Content-Type"]||"application/json")),_i.body=di.body&&di.processData&&"string"!==typeof di.body?JSON.stringify(di.body):"body"in di?di.body:null,Object.keys(di.headers).forEach(function(mi){di.headers.hasOwnProperty(mi)&&fi.set(mi,di.headers[mi])}),li=Os(di.url,_i),0<di.timeout&&(ui=setTimeout(function(){li.reject(new Error("Load timeout for resource: "+di.url))},di.timeout)),li.promise.then(function(mi){return pi={statusCode:mi.status},0<di.timeout&&clearTimeout(ui),200<=pi.statusCode&&300>pi.statusCode?di.binary?mi.blob():mi.text():mi.json()}).then(function(mi){200<=pi.statusCode&&300>pi.statusCode?ci(null,pi,mi):(mi.status=pi.statusCode,ci(mi))})["catch"](function(mi){mi||(mi=new Error("canceled")),ci(mi)}),{abort:li.reject}}function Is(di,ci){var pi=!1,_i=function(){pi=!0,li.abort(),gi()},mi={abort:function(){li.abort(),gi()}},gi=function(){clearTimeout(ui),mi.abort=function(){},li&&(li.onprogress=void 0,li.upload&&(li.upload.onprogress=void 0),li.onreadystatechange=void 0,li=void 0)},li,ui;li=di.xhr?new di.xhr:new XMLHttpRequest;try{li.open(di.method,di.url)}catch(vi){return ci(new Error(vi.name||"Url is invalid"))}for(var yi in li.withCredentials=!("withCredentials"in di)||di.withCredentials,"GET"===di.method?delete di.headers["Content-Type"]:di.json&&(di.headers.Accept="application/json",di.headers["Content-Type"]=di.headers["Content-Type"]||"application/json",di.body&&di.processData&&"string"!==typeof di.body&&(di.body=JSON.stringify(di.body))),di.binary&&(li.responseType="arraybuffer"),"body"in di||(di.body=null),di.headers)di.headers.hasOwnProperty(yi)&&li.setRequestHeader(yi,di.headers[yi]);return 0<di.timeout&&(ui=setTimeout(_i,di.timeout),li.onprogress=function(){clearTimeout(ui),4!==li.readyState&&(ui=setTimeout(_i,di.timeout))},"undefined"!==typeof li.upload&&(li.upload.onprogress=li.onprogress)),li.onreadystatechange=function(){if(4===li.readyState){var vi={statusCode:li.status};if(200<=li.status&&300>li.status){var Ei;Ei=di.binary?un([li.response||""],{type:li.getResponseHeader("Content-Type")}):li.responseText,ci(null,vi,Ei)}else{var ki={};if(pi)ki=new Error("ETIMEDOUT"),ki.code="ETIMEDOUT";else if("string"===typeof li.response)try{ki=JSON.parse(li.response)}catch(Si){}ki.status=li.status,ci(ki)}gi()}},di.body&&di.body instanceof Blob?vn(di.body,function(vi){li.send(vi)}):li.send(di.body),mi}function Rs(di,ci){return Ro||di.xhr?Is(di,ci):Ds(di,ci)}function $s(){return""}function Ps(di,ci){function li(pi,fi,_i){if(!di.binary&&di.json&&"string"===typeof pi)try{pi=JSON.parse(pi)}catch(mi){return _i(mi)}Array.isArray(pi)&&(pi=pi.map(function(mi){return mi.error||mi.missing?ue(mi):mi})),di.binary&&$o(pi,fi),_i(null,pi,fi)}di=F(di);return di=da({method:"GET",headers:{},json:!0,processData:!0,timeout:1e4,cache:!1},di),di.json&&(!di.binary&&(di.headers.Accept="application/json"),di.headers["Content-Type"]=di.headers["Content-Type"]||"application/json"),di.binary&&(di.encoding=null,di.json=!1),di.processData||(di.json=!1),Rs(di,function(pi,fi,_i){if(pi)return ci(ue(pi));var gi=fi.headers&&fi.headers["content-type"],yi=_i||$s(),mi;if(!di.binary&&(di.json||!di.processData)&&"object"!==("undefined"===typeof yi?"undefined":babelHelpers.typeof(yi))&&(/json/.test(gi)||/^[\s]*\{/.test(yi)&&/\}[\s]*$/.test(yi)))try{yi=JSON.parse(yi.toString())}catch(vi){}200<=fi.statusCode&&300>fi.statusCode?li(yi,fi,ci):(mi=ue(yi),mi.status=fi.statusCode,ci(mi))})}function Fs(di,ci){var li=navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",ui=-1!==li.indexOf("safari")&&-1===li.indexOf("chrome"),pi=-1!==li.indexOf("msie"),fi=-1!==li.indexOf("edge"),_i=ui||(pi||fi)&&"GET"===di.method,mi=!("cache"in di)||di.cache,gi=/^blob:/.test(di.url);if(!gi&&(_i||!mi)){var yi=-1!==di.url.indexOf("?");di.url+=(yi?"&":"?")+"_nonce="+Date.now()}return Ps(di,ci)}function Bs(di,ci){return new ea(function(li,ui){function pi(){yi++,di[vi++]().then(_i,mi)}function fi(){++Ei===ki?Si?ui(Si):li():gi()}function _i(){yi--,fi()}function mi(qi){yi--,Si=Si||qi,fi()}function gi(){for(;yi<ci&&vi<ki;)pi()}var yi=0,vi=0,Ei=0,ki=di.length,Si;gi()})}function Us(di){var ci=di.doc&&di.doc._attachments;ci&&Object.keys(ci).forEach(function(li){var ui=ci[li];ui.data=fn(ui.data,ui.content_type)})}function Ms(di){return /^_design/.test(di)?"_design/"+encodeURIComponent(di.slice(8)):/^_local/.test(di)?"_local/"+encodeURIComponent(di.slice(7)):encodeURIComponent(di)}function Ws(di){return di._attachments&&Object.keys(di._attachments)?ea.all(Object.keys(di._attachments).map(function(ci){var li=di._attachments[ci];if(li.data&&"string"!==typeof li.data)return new ea(function(ui){yn(li.data,ui)}).then(function(ui){li.data=ui})})):ea.resolve()}function Hs(di){if(!di.prefix)return!1;var ci=Ee(di.prefix).protocol;return"http"===ci||"https"===ci}function zs(di,ci){if(Hs(ci)){var li=ci.name.substr(ci.prefix.length);di=ci.prefix+encodeURIComponent(li)}var ui=Ee(di);(ui.user||ui.password)&&(ui.auth={username:ui.user,password:ui.password});var pi=ui.path.replace(/(^\/|\/$)/g,"").split("/");return ui.db=pi.pop(),-1===ui.db.indexOf("%")&&(ui.db=encodeURIComponent(ui.db)),ui.path=pi.join("/"),ui}function Xs(di,ci){return Gs(di,di.db+"/"+ci)}function Gs(di,ci){var li=di.path?"/":"";return di.protocol+"://"+di.host+(di.port?":"+di.port:"")+"/"+di.path+li+ci}function Vs(di){return"?"+Object.keys(di).map(function(ci){return ci+"="+encodeURIComponent(di[ci])}).join("&")}function Ks(di,ci){function li(wi,xi,Ti){var Ai=wi.ajax||{},Ci=da(F(vi),Ai,xi),Li=F(vi.headers||{});return Ci.headers=da(Li,Ai.headers,xi.headers||{}),mi.constructor.listeners("debug").length&&mi.constructor.emit("debug",["http",Ci.method,Ci.url]),mi._ajax(Ci,Ti)}function ui(wi,xi){return new ea(function(Ti,Ai){li(wi,xi,function(Ci,Li){return Ci?Ai(Ci):void Ti(Li)})})}function pi(wi,xi){return W(wi,Gr(function(Ti){fi().then(function(){return xi.apply(this,Ti)})["catch"](function(Ai){var Ci=Ti.pop();Ci(Ai)})}))}function fi(){if(di.skipSetup||di.skip_setup)return ea.resolve();if(qi)return qi;return qi=ui({},{method:"GET",url:yi})["catch"](function(xi){return xi&&xi.status&&404===xi.status?(de(404,"PouchDB is just detecting if the remote exists."),ui({},{method:"PUT",url:yi})):ea.reject(xi)})["catch"](function(xi){return xi&&xi.status&&412===xi.status||ea.reject(xi)}),qi["catch"](function(){qi=null}),qi}function _i(wi){return wi.split("/").map(encodeURIComponent).join("/")}var mi=this,gi=zs(di.name,di),yi=Xs(gi,"");di=F(di);var vi=di.ajax||{};if(di.auth||gi.auth){var Ei=di.auth||gi.auth,ki=Ei.username+":"+Ei.password,Si=Ja(unescape(encodeURIComponent(ki)));vi.headers=vi.headers||{},vi.headers.Authorization="Basic "+Si}mi._ajax=Fs;var qi;Qr(function(){ci(null,mi)}),mi._remote=!0,mi.type=function(){return"http"},mi.id=pi("id",function(wi){li({},{method:"GET",url:Gs(gi,"")},function(xi,Ti){var Ai=Ti&&Ti.uuid?Ti.uuid+gi.db:Xs(gi,"");wi(null,Ai)})}),mi.request=pi("request",function(wi,xi){wi.url=Xs(gi,wi.url),li({},wi,xi)}),mi.compact=pi("compact",function(wi,xi){"function"===typeof wi&&(xi=wi,wi={}),wi=F(wi),li(wi,{url:Xs(gi,"_compact"),method:"POST"},function(){function Ti(){mi.info(function(Ai,Ci){Ci&&!Ci.compact_running?xi(null,{ok:!0}):setTimeout(Ti,wi.interval||200)})}Ti()})}),mi.bulkGet=W("bulkGet",function(wi,xi){function Ti(Oi){var Di={};wi.revs&&(Di.revs=!0),wi.attachments&&(Di.attachments=!0),wi.latest&&(Di.latest=!0),li(wi,{url:Xs(gi,"_bulk_get"+Vs(Di)),method:"POST",body:{docs:wi.docs}},Oi)}function Ai(){function Oi(Fi){return function(Bi,Ui){Ri[Fi]=Ui.results,++Ni===Ii&&xi(null,{results:fe(Ri)})}}for(var Di=Fo,Ii=Math.ceil(wi.docs.length/Di),Ni=0,Ri=Array(Ii),$i=0,Pi;$i<Ii;$i++)Pi=K(wi,["revs","attachments","latest"]),Pi.ajax=vi,Pi.docs=wi.docs.slice($i*Di,Math.min(wi.docs.length,($i+1)*Di)),Y(Ci,Pi,Oi($i))}var Ci=this,Li=Gs(gi,""),ji=Mo[Li];"boolean"===typeof ji?ji?Ti(xi):Ai():Ti(function(Oi,Di){Oi?(Mo[Li]=!1,de(Oi.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),Ai()):(Mo[Li]=!0,xi(null,Di))})}),mi._info=function(wi){fi().then(function(){li({},{method:"GET",url:Xs(gi,"")},function(xi,Ti){return xi?wi(xi):void(Ti.host=Xs(gi,""),wi(null,Ti))})})["catch"](wi)},mi.get=pi("get",function(wi,xi,Ti){function Ai(Oi){function Di($i){var Pi=Ii[$i],Fi=Ms(Oi._id)+"/"+_i($i)+"?rev="+Oi._rev;return ui(xi,{method:"GET",url:Xs(gi,Fi),binary:!0}).then(function(Bi){return xi.binary?Bi:new ea(function(Ui){yn(Bi,Ui)})}).then(function(Bi){delete Pi.stub,delete Pi.length,Pi.data=Bi})}var Ii=Oi._attachments,Ni=Ii&&Object.keys(Ii);if(Ii&&Ni.length){var Ri=Ni.map(function($i){return function(){return Di($i)}});return Bs(Ri,5)}}function Ci(Oi){return Array.isArray(Oi)?ea.all(Oi.map(function(Di){if(Di.ok)return Ai(Di.ok)})):Ai(Oi)}"function"===typeof xi&&(Ti=xi,xi={}),xi=F(xi);var Li={};xi.revs&&(Li.revs=!0),xi.revs_info&&(Li.revs_info=!0),xi.latest&&(Li.latest=!0),xi.open_revs&&("all"!==xi.open_revs&&(xi.open_revs=JSON.stringify(xi.open_revs)),Li.open_revs=xi.open_revs),xi.rev&&(Li.rev=xi.rev),xi.conflicts&&(Li.conflicts=xi.conflicts),wi=Ms(wi);var ji={method:"GET",url:Xs(gi,wi+Vs(Li))};ui(xi,ji).then(function(Oi){return ea.resolve().then(function(){if(xi.attachments)return Ci(Oi)}).then(function(){Ti(null,Oi)})})["catch"](function(Oi){Oi.docId=wi,Ti(Oi)})}),mi.remove=pi("remove",function(wi,xi,Ti,Ai){var Ci;"string"===typeof xi?(Ci={_id:wi,_rev:xi},"function"===typeof Ti&&(Ai=Ti,Ti={})):(Ci=wi,"function"===typeof xi?(Ai=xi,Ti={}):(Ai=Ti,Ti=xi));var Li=Ci._rev||Ti.rev;li(Ti,{method:"DELETE",url:Xs(gi,Ms(Ci._id))+"?rev="+Li},Ai)}),mi.getAttachment=pi("getAttachment",function(wi,xi,Ti,Ai){"function"===typeof Ti&&(Ai=Ti,Ti={});var Ci=Ti.rev?"?rev="+Ti.rev:"",Li=Xs(gi,Ms(wi))+"/"+_i(xi)+Ci;li(Ti,{method:"GET",url:Li,binary:!0},Ai)}),mi.removeAttachment=pi("removeAttachment",function(wi,xi,Ti,Ai){var Ci=Xs(gi,Ms(wi)+"/"+_i(xi))+"?rev="+Ti;li({},{method:"DELETE",url:Ci},Ai)}),mi.putAttachment=pi("putAttachment",function(wi,xi,Ti,Ai,Ci,Li){"function"===typeof Ci&&(Li=Ci,Ci=Ai,Ai=Ti,Ti=null);var ji=Ms(wi)+"/"+_i(xi),Oi=Xs(gi,ji);if(Ti&&(Oi+="?rev="+Ti),"string"===typeof Ai){var Di;try{Di=Qa(Ai)}catch(Ni){return Li(le(va,"Attachment is not a valid base64 string"))}Ai=Di?hn(Di,Ci):""}var Ii={headers:{"Content-Type":Ci},method:"PUT",url:Oi,processData:!1,body:Ai,timeout:vi.timeout||6e4};li({},Ii,Li)}),mi._bulkDocs=function(wi,xi,Ti){wi.new_edits=xi.new_edits,fi().then(function(){return ea.all(wi.docs.map(Ws))}).then(function(){li(xi,{method:"POST",url:Xs(gi,"_bulk_docs"),timeout:xi.timeout,body:wi},function(Ai,Ci){return Ai?Ti(Ai):void(Ci.forEach(function(Li){Li.ok=!0}),Ti(null,Ci))})})["catch"](Ti)},mi._put=function(wi,xi,Ti){fi().then(function(){return Ws(wi)}).then(function(){li(xi,{method:"PUT",url:Xs(gi,Ms(wi._id)),body:wi},function(Ai,Ci){return Ai?(Ai.docId=wi&&wi._id,Ti(Ai)):void Ti(null,Ci)})})["catch"](Ti)},mi.allDocs=pi("allDocs",function(wi,xi){"function"===typeof wi&&(xi=wi,wi={}),wi=F(wi);var Ti={},Ai,Ci="GET";wi.conflicts&&(Ti.conflicts=!0),wi.descending&&(Ti.descending=!0),wi.include_docs&&(Ti.include_docs=!0),wi.attachments&&(Ti.attachments=!0),wi.key&&(Ti.key=JSON.stringify(wi.key)),wi.start_key&&(wi.startkey=wi.start_key),wi.startkey&&(Ti.startkey=JSON.stringify(wi.startkey)),wi.end_key&&(wi.endkey=wi.end_key),wi.endkey&&(Ti.endkey=JSON.stringify(wi.endkey)),"undefined"!==typeof wi.inclusive_end&&(Ti.inclusive_end=!!wi.inclusive_end),"undefined"!==typeof wi.limit&&(Ti.limit=wi.limit),"undefined"!==typeof wi.skip&&(Ti.skip=wi.skip);var Li=Vs(Ti);"undefined"!==typeof wi.keys&&(Ci="POST",Ai={keys:wi.keys}),ui(wi,{method:Ci,url:Xs(gi,"_all_docs"+Li),body:Ai}).then(function(ji){wi.include_docs&&wi.attachments&&wi.binary&&ji.rows.forEach(Us),xi(null,ji)})["catch"](xi)}),mi._changes=function(wi){var xi="batch_size"in wi?wi.batch_size:Po;wi=F(wi),wi.continuous&&!("heartbeat"in wi)&&(wi.heartbeat=Uo);var Ti="timeout"in wi?wi.timeout:"timeout"in vi?vi.timeout:30000;"timeout"in wi&&wi.timeout&&Ti-wi.timeout<Bo&&(Ti=wi.timeout+Bo),"heartbeat"in wi&&wi.heartbeat&&Ti-wi.heartbeat<Bo&&(Ti=wi.heartbeat+Bo);var Ai={};"timeout"in wi&&wi.timeout&&(Ai.timeout=wi.timeout);var Ci="undefined"!==typeof wi.limit&&wi.limit,Li;Li="return_docs"in wi?wi.return_docs:!("returnDocs"in wi)||wi.returnDocs;var ji=Ci;if(wi.style&&(Ai.style=wi.style),(wi.include_docs||wi.filter&&"function"===typeof wi.filter)&&(Ai.include_docs=!0),wi.attachments&&(Ai.attachments=!0),wi.continuous&&(Ai.feed="longpoll"),wi.conflicts&&(Ai.conflicts=!0),wi.descending&&(Ai.descending=!0),"heartbeat"in wi&&wi.heartbeat&&(Ai.heartbeat=wi.heartbeat),wi.filter&&"string"===typeof wi.filter&&(Ai.filter=wi.filter),wi.view&&"string"===typeof wi.view&&(Ai.filter="_view",Ai.view=wi.view),wi.query_params&&"object"===babelHelpers.typeof(wi.query_params))for(var Oi in wi.query_params)wi.query_params.hasOwnProperty(Oi)&&(Ai[Oi]=wi.query_params[Oi]);var Di="GET",Ii;wi.doc_ids?(Ai.filter="_doc_ids",Di="POST",Ii={doc_ids:wi.doc_ids}):wi.selector&&(Ai.filter="_selector",Di="POST",Ii={selector:wi.selector});var $i=function(Ui,Mi){if(!wi.aborted){Ai.since=Ui,"object"===babelHelpers.typeof(Ai.since)&&(Ai.since=JSON.stringify(Ai.since)),wi.descending?Ci&&(Ai.limit=ji):Ai.limit=!Ci||ji>xi?xi:ji;var Wi={method:Di,url:Xs(gi,"_changes"+Vs(Ai)),timeout:Ti,body:Ii};Ri=Ui,wi.aborted||fi().then(function(){Ni=li(wi,Wi,Mi)})["catch"](Mi)}},Pi={results:[]},Ni,Ri;return $i(wi.since||0,function Bi(Ui,Mi){if(!wi.aborted){var Wi=0;if(Mi&&Mi.results){Wi=Mi.results.length,Pi.last_seq=Mi.last_seq;({}).query=wi.query_params,Mi.results=Mi.results.filter(function(Xi){ji--;var Gi=he(wi)(Xi);return Gi&&(wi.include_docs&&wi.attachments&&wi.binary&&Us(Xi),Li&&Pi.results.push(Xi),wi.onChange(Xi)),Gi})}else if(Ui)return wi.aborted=!0,void wi.complete(Ui);Mi&&Mi.last_seq&&(Ri=Mi.last_seq);var zi=Ci&&0>=ji||Mi&&Wi<xi||wi.descending;(!wi.continuous||Ci&&0>=ji)&&zi?wi.complete(null,Pi):Qr(function(){$i(Ri,Bi)})}}),{cancel:function(){wi.aborted=!0,Ni&&Ni.abort()}}},mi.revsDiff=pi("revsDiff",function(wi,xi,Ti){"function"===typeof xi&&(Ti=xi,xi={}),li(xi,{method:"POST",url:Xs(gi,"_revs_diff"),body:wi},Ti)}),mi._close=function(wi){wi()},mi._destroy=function(wi,xi){li(wi,{url:Xs(gi,""),method:"DELETE"},function(Ti,Ai){return Ti&&Ti.status&&404!==Ti.status?xi(Ti):void xi(null,Ai)})}}function Qs(di){this.status=400,this.name="query_parse_error",this.message=di,this.error=!0;try{Error.captureStackTrace(this,Qs)}catch(ci){}}function Js(di){this.status=404,this.name="not_found",this.message=di,this.error=!0;try{Error.captureStackTrace(this,Js)}catch(ci){}}function Ys(di){this.status=500,this.name="invalid_value",this.message=di,this.error=!0;try{Error.captureStackTrace(this,Ys)}catch(ci){}}function Zs(di,ci){return ci&&di.then(function(li){Qr(function(){ci(null,li)})},function(li){Qr(function(){ci(li)})}),di}function tr(di){return Gr(function(ci){var li=ci.pop(),ui=di.apply(this,ci);return"function"===typeof li&&Zs(ui,li),ui})}function nr(di,ci){return di.then(function(li){return ci().then(function(){return li})},function(li){return ci().then(function(){throw li})})}function sr(di,ci){return function(){var li=arguments,ui=this;return di.add(function(){return ci.apply(ui,li)})}}function rr(di){var ci=new sa(di),li=Array(ci.size),ui=-1;return ci.forEach(function(pi){li[++ui]=pi}),li}function ar(di){var ci=Array(di.size),li=-1;return di.forEach(function(ui,pi){ci[++li]=pi}),ci}function or(di){return new Ys("builtin "+di+" function requires map values to be numbers or number arrays")}function ir(di){for(var ci=0,li=0,ui=di.length,pi;li<ui;li++)if(pi=di[li],"number"===typeof pi)"number"===typeof ci?ci+=pi:ci[0]+=pi;else if(Array.isArray(pi)){ci="number"===typeof ci?[ci]:ci;for(var fi=0,_i=pi.length,mi;fi<_i;fi++)if(mi=pi[fi],"number"!==typeof mi)throw or("_sum");else"undefined"===typeof ci[fi]?ci.push(mi):ci[fi]+=mi}else throw or("_sum");return ci}function dr(di,ci){return ke("return ("+di.replace(/;\s*$/,"")+");",{emit:ci,sum:ir,log:Ho,isArray:zo,toJSON:Xo})}function cr(){this.promise=new ea(function(di){di()})}function lr(di){if(!di)return"undefined";switch("undefined"===typeof di?"undefined":babelHelpers.typeof(di)){case"function":return di.toString();case"string":return di.toString();default:return JSON.stringify(di);}}function ur(di,ci){return lr(di)+lr(ci)+"undefined"}function pr(di,ci,li,ui,pi,fi){var _i=ur(li,ui),mi;if(!pi&&(mi=di._cachedViews=di._cachedViews||{},mi[_i]))return mi[_i];var gi=di.info().then(function(yi){var Ei=yi.db_name+"-mrview-"+(pi?"temp":wn(_i));return Se(di,"_local/"+fi,function(ki){ki.views=ki.views||{};var Si=ci;-1===Si.indexOf("/")&&(Si=ci+"/"+ci);var qi=ki.views[Si]=ki.views[Si]||{};if(!qi[Ei])return qi[Ei]=!0,ki}).then(function(){return di.registerDependentDatabase(Ei).then(function(ki){var Si=ki.db;Si.auto_compaction=!0;var qi={name:Ei,db:Si,sourceDB:di,adapter:di.adapter,mapFun:li,reduceFun:ui};return qi.db.get("_local/lastSeq")["catch"](function(wi){if(404!==wi.status)throw wi}).then(function(wi){return qi.seq=wi?wi.seq:0,mi&&qi.db.once("destroyed",function(){delete mi[_i]}),qi})})})});return mi&&(mi[_i]=gi),gi}function hr(di){return-1===di.indexOf("/")?[di,di]:di.split("/")}function fr(di){return 1===di.length&&/^1-/.test(di[0].rev)}function _r(di,ci){try{di.emit("error",ci)}catch(li){ae("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),ae("error",ci)}}function gr(di){if(/^_sum/.test(di))return Qo._sum;if(/^_count/.test(di))return Qo._count;if(/^_stats/.test(di))return Qo._stats;if(/^_/.test(di))throw new Error(di+" is not a supported reduce function.")}function Sr(di){return /^1-/.test(di)}function qr(di,ci,li){return!di._attachments||!di._attachments[li]||di._attachments[li].digest!==ci._attachments[li].digest}function wr(di,ci){var li=Object.keys(ci._attachments);return ea.all(li.map(function(ui){return di.getAttachment(ci._id,ui,{rev:ci._rev})}))}function xr(di,ci,li){var ui=ge(ci)&&!ge(di),pi=Object.keys(li._attachments);return ui?di.get(li._id).then(function(fi){return ea.all(pi.map(function(_i){return qr(fi,li,_i)?ci.getAttachment(li._id,_i):di.getAttachment(fi._id,_i)}))})["catch"](function(fi){if(404!==fi.status)throw fi;return wr(ci,li)}):wr(ci,li)}function Tr(di){var ci=[];return Object.keys(di).forEach(function(li){var ui=di[li].missing;ui.forEach(function(pi){ci.push({id:li,rev:pi})})}),{docs:ci,revs:!0,latest:!0}}function Ar(di,ci,li,ui){function fi(ki){return ki._attachments&&0<Object.keys(ki._attachments).length}function _i(ki){return ki._conflicts&&0<ki._conflicts.length}function mi(ki){return di.allDocs({keys:ki,include_docs:!0,conflicts:!0}).then(function(Si){if(ui.cancelled)throw new Error("cancelled");Si.rows.forEach(function(qi){qi.deleted||!qi.doc||!Sr(qi.value.rev)||fi(qi.doc)||_i(qi.doc)||(qi.doc._conflicts&&delete qi.doc._conflicts,vi.push(qi.doc),delete li[qi.id])})})}li=F(li);var vi=[],Ei=!0;return ea.resolve().then(function(){var ki=Object.keys(li).filter(function(Si){var qi=li[Si].missing;return 1===qi.length&&Sr(qi[0])});if(0<ki.length)return mi(ki)}).then(function(){var ki=Tr(li);return ki.docs.length?di.bulkGet(ki).then(function(Si){if(ui.cancelled)throw new Error("cancelled");return ea.all(Si.results.map(function(qi){return ea.all(qi.docs.map(function(wi){var xi=wi.ok;return wi.error&&(Ei=!1),xi&&xi._attachments?xr(ci,di,xi).then(function(Ti){var Ai=Object.keys(xi._attachments);return Ti.forEach(function(Ci,Li){var ji=xi._attachments[Ai[Li]];delete ji.stub,delete ji.length,ji.data=Ci}),xi}):xi}))})).then(function(qi){vi=vi.concat(fe(qi).filter(Boolean))})}):void 0}).then(function(){return{ok:Ei,docs:vi}})}function Cr(di,ci,li,ui,pi){return di.get(ci)["catch"](function(fi){if(404===fi.status)return("http"===di.adapter||"https"===di.adapter)&&de(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:ui,_id:ci,history:[],replicator:ti,version:ei};throw fi}).then(function(fi){if(!pi.cancelled)return fi.last_seq===li?void 0:(fi.history=(fi.history||[]).filter(function(_i){return _i.session_id!==ui}),fi.history.unshift({last_seq:li,session_id:ui}),fi.history=fi.history.slice(0,ni),fi.version=ei,fi.replicator=ti,fi.session_id=ui,fi.last_seq=li,di.put(fi)["catch"](function(_i){if(409===_i.status)return Cr(di,ci,li,ui,pi);throw _i}))})}function Lr(di,ci,li,ui,pi){this.src=di,this.target=ci,this.id=li,this.returnValue=ui,this.opts=pi}function jr(di,ci){return di.session_id===ci.session_id?{last_seq:di.last_seq,history:di.history}:Or(di.history,ci.history)}function Or(di,ci){var li=di[0],ui=di.slice(1),pi=ci[0],fi=ci.slice(1);if(!li||0===ci.length)return{last_seq:si,history:[]};var _i=li.session_id;if(Dr(_i,ci))return{last_seq:li.last_seq,history:di};var mi=pi.session_id;return Dr(mi,ui)?{last_seq:pi.last_seq,history:fi}:Or(ui,fi)}function Dr(di,ci){var li=ci[0],ui=ci.slice(1);return di&&0!==ci.length&&(!(di!==li.session_id)||Dr(di,ui))}function Ir(di){return"number"===typeof di.status&&4===Math.floor(di.status/100)}function Nr(di,ci,li,ui){if(!1===di.retry)return ci.emit("error",li),void ci.removeAllListeners();if("function"!==typeof di.back_off_function&&(di.back_off_function=ie),ci.emit("requestError",li),"active"===ci.state||"pending"===ci.state){ci.emit("paused",li),ci.state="stopped";var pi=function(){di.current_back_off=oi},fi=function(){ci.removeListener("active",pi)};ci.once("paused",fi),ci.once("active",pi)}di.current_back_off=di.current_back_off||oi,di.current_back_off=di.back_off_function(di.current_back_off),setTimeout(ui,di.current_back_off)}function Rr(di){return Object.keys(di).sort(xt).reduce(function(ci,li){return ci[li]=di[li],ci},{})}function $r(di,ci,li){var ui=li.doc_ids?li.doc_ids.sort(xt):"",pi=li.filter?li.filter.toString():"",fi="",_i="",mi="";return li.selector&&(mi=JSON.stringify(li.selector)),li.filter&&li.query_params&&(fi=JSON.stringify(Rr(li.query_params))),li.filter&&"_view"===li.filter&&(_i=li.view.toString()),ea.all([di.id(),ci.id()]).then(function(gi){var yi=gi[0]+gi[1]+pi+_i+fi+ui+mi;return new ea(function(vi){qn(yi,vi)})}).then(function(gi){return gi=gi.replace(/\//g,".").replace(/\+/g,"_"),"_local/"+gi})}function Pr(di,ci,li,ui,pi){function fi(){return Hi?ea.resolve():$r(di,ci,li).then(function(Vi){Wi=Vi;var Ki={};Ki=!1===li.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:"source"===li.checkpoint?{writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:"target"===li.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:{writeSourceCheckpoint:!0,writeTargetCheckpoint:!0},Hi=new Lr(di,ci,Wi,ui,Ki)})}function _i(){if(zi=[],0!==ji.docs.length){var Vi=ji.docs,Ki={timeout:li.timeout};return ci.bulkDocs({docs:Vi,new_edits:!1},Ki).then(function(Qi){if(ui.cancelled)throw Si(),new Error("cancelled");var Ji=Object.create(null);Qi.forEach(function(Zi){Zi.error&&(Ji[Zi.id]=Zi)});var Yi=Object.keys(Ji).length;pi.doc_write_failures+=Yi,pi.docs_written+=Vi.length-Yi,Vi.forEach(function(Zi){var ed=Ji[Zi._id];if(!ed)zi.push(Zi);else if(pi.errors.push(ed),"unauthorized"===ed.name||"forbidden"===ed.name)ui.emit("denied",F(ed));else throw ed})},function(Qi){throw pi.doc_write_failures+=Vi.length,Qi})}}function mi(){if(ji.error)throw new Error("There was a problem getting docs.");pi.last_seq=Ri=ji.seq;var Vi=F(pi);return zi.length&&(Vi.docs=zi,ui.emit("change",Vi)),Di=!0,Hi.writeCheckpoint(ji.seq,Xi).then(function(){if(Di=!1,ui.cancelled)throw Si(),new Error("cancelled");ji=void 0,Ti()})["catch"](function(Ki){throw Ci(Ki),Ki})}function gi(){var Vi={};return ji.changes.forEach(function(Ki){"_user/"===Ki.id||(Vi[Ki.id]=Ki.changes.map(function(Qi){return Qi.rev}))}),ci.revsDiff(Vi).then(function(Ki){if(ui.cancelled)throw Si(),new Error("cancelled");ji.diffs=Ki})}function yi(){return Ar(di,ci,ji.diffs,ui).then(function(Vi){ji.error=!Vi.ok,Vi.docs.forEach(function(Ki){delete ji.diffs[Ki._id],pi.docs_read++,ji.docs.push(Ki)})})}function vi(){return ui.cancelled||ji?void 0:0===Li.length?void Ei(!0):void(ji=Li.shift(),gi().then(yi).then(_i).then(mi).then(vi)["catch"](function(Vi){ki("batch processing terminated with error",Vi)}))}function Ei(Vi){return 0===Oi.changes.length?void(0!==Li.length||ji||(($i&&Gi.live||Ii)&&(ui.state="pending",ui.emit("paused")),Ii&&Si())):void((Vi||Ii||Oi.changes.length>=Pi)&&(Li.push(Oi),Oi={seq:0,changes:[],docs:[]},("pending"===ui.state||"stopped"===ui.state)&&(ui.state="active",ui.emit("active")),vi()))}function ki(Vi,Ki){Ni||(!Ki.message&&(Ki.message=Vi),pi.ok=!1,pi.status="aborting",Li=[],Oi={seq:0,changes:[],docs:[]},Si(Ki))}function Si(Vi){Ni||ui.cancelled&&(pi.status="cancelled",Di)||(pi.status=pi.status||"complete",pi.end_time=new Date,pi.last_seq=Ri,Ni=!0,Vi?(Vi=le(Vi),Vi.result=pi,"unauthorized"===Vi.name||"forbidden"===Vi.name?(ui.emit("error",Vi),ui.removeAllListeners()):Nr(li,ui,Vi,function(){Pr(di,ci,li,ui)})):(ui.emit("complete",pi),ui.removeAllListeners()))}function qi(Vi){if(ui.cancelled)return Si();var Ki=he(li)(Vi);Ki&&(Oi.seq=Vi.seq,Oi.changes.push(Vi),Ei(0===Li.length&&Gi.live))}function wi(Vi){if(Bi=!1,ui.cancelled)return Si();if(0<Vi.results.length)Gi.since=Vi.last_seq,Ti(),Ei(!0);else{var Ki=function(){$i?(Gi.live=!0,Ti()):Ii=!0,Ei(!0)};ji||0!==Vi.results.length?Ki():(Di=!0,Hi.writeCheckpoint(Vi.last_seq,Xi).then(function(){Di=!1,pi.last_seq=Ri=Vi.last_seq,Ki()})["catch"](Ci))}}function xi(Vi){return Bi=!1,ui.cancelled?Si():void ki("changes rejected",Vi)}function Ti(){function Vi(){Qi.cancel()}function Ki(){ui.removeListener("cancel",Vi)}if(!(Bi||Ii||!(Li.length<Fi))){Bi=!0,ui._changes&&(ui.removeListener("cancel",ui._abortChanges),ui._changes.cancel()),ui.once("cancel",Vi);var Qi=di.changes(Gi).on("change",qi);Qi.then(Ki,Ki),Qi.then(wi)["catch"](xi),li.retry&&(ui._changes=Qi,ui._abortChanges=Vi)}}function Ai(){fi().then(function(){return ui.cancelled?void Si():Hi.getCheckpoint().then(function(Vi){Ri=Vi,Gi={since:Ri,limit:Pi,batch_size:Pi,style:"all_docs",doc_ids:Ui,selector:Mi,return_docs:!0},li.filter&&("string"===typeof li.filter?Gi.filter=li.filter:Gi.include_docs=!0),"heartbeat"in li&&(Gi.heartbeat=li.heartbeat),"timeout"in li&&(Gi.timeout=li.timeout),li.query_params&&(Gi.query_params=li.query_params),li.view&&(Gi.view=li.view),Ti()})})["catch"](function(Vi){ki("getCheckpoint rejected with ",Vi)})}function Ci(Vi){Di=!1,ki("writeCheckpoint completed with error",Vi)}var Li=[],Oi={seq:0,changes:[],docs:[]},Di=!1,Ii=!1,Ni=!1,Ri=0,$i=li.continuous||li.live||!1,Pi=li.batch_size||100,Fi=li.batches_limit||10,Bi=!1,Ui=li.doc_ids,Mi=li.selector,zi=[],Xi=Ba(),ji,Wi,Hi;pi=pi||{ok:!0,start_time:new Date,docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var Gi={};return ui.ready(di,ci),ui.cancelled?void Si():void(!ui._addedListeners&&(ui.once("cancel",Si),"function"===typeof li.complete&&(ui.once("error",li.complete),ui.once("complete",function(Vi){li.complete(null,Vi)})),ui._addedListeners=!0),"undefined"===typeof li.since?Ai():fi().then(function(){return Di=!0,Hi.writeCheckpoint(li.since,Xi)}).then(function(){return Di=!1,ui.cancelled?void Si():void(Ri=li.since,Ai())})["catch"](Ci))}function Fr(){Vr.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var di=this,ci=new ea(function(li,ui){di.once("complete",li),di.once("error",ui)});di.then=function(li,ui){return ci.then(li,ui)},di["catch"]=function(li){return ci["catch"](li)},di["catch"](function(){})}function Br(di,ci){var li=ci.PouchConstructor;return"string"===typeof di?new li(di,ci):di}function Ur(di,ci,li,ui){if("function"===typeof li&&(ui=li,li={}),"undefined"===typeof li&&(li={}),li.doc_ids&&!Array.isArray(li.doc_ids))throw le(Sa,"`doc_ids` filter parameter is not a list.");li.complete=ui,li=F(li),li.continuous=li.continuous||li.live,li.retry=!!("retry"in li)&&li.retry,li.PouchConstructor=li.PouchConstructor||this;var pi=new Fr(li),fi=Br(di,li),_i=Br(ci,li);return Pr(fi,_i,li,pi),pi}function Mr(di,ci,li,ui){return"function"===typeof li&&(ui=li,li={}),"undefined"===typeof li&&(li={}),li=F(li),li.PouchConstructor=li.PouchConstructor||this,di=Br(di,li),ci=Br(ci,li),new Wr(di,ci,li,ui)}function Wr(di,ci,li,ui){function pi(Ci){qi.emit("change",{direction:"pull",change:Ci})}function fi(Ci){qi.emit("change",{direction:"push",change:Ci})}function _i(Ci){qi.emit("denied",{direction:"push",doc:Ci})}function mi(Ci){qi.emit("denied",{direction:"pull",doc:Ci})}function gi(){qi.pushPaused=!0,qi.pullPaused&&qi.emit("paused")}function yi(){qi.pullPaused=!0,qi.pushPaused&&qi.emit("paused")}function vi(){qi.pushPaused=!1,qi.pullPaused&&qi.emit("active",{direction:"push"})}function Ei(){qi.pullPaused=!1,qi.pushPaused&&qi.emit("active",{direction:"pull"})}function ki(Ci){return function(Li,ji){("change"===Li&&(ji===pi||ji===fi)||"denied"===Li&&(ji===mi||ji===_i)||"paused"===Li&&(ji===yi||ji===gi)||"active"===Li&&(ji===Ei||ji===vi))&&(!(Li in Ti)&&(Ti[Li]={}),Ti[Li][Ci]=!0,2===Object.keys(Ti[Li]).length&&qi.removeAllListeners(Li))}}function Si(Ci,Li,ji){-1==Ci.listeners(Li).indexOf(ji)&&Ci.on(Li,ji)}var qi=this;this.canceled=!1;var wi=li.push?da({},li,li.push):li,xi=li.pull?da({},li,li.pull):li;this.push=Ur(di,ci,wi),this.pull=Ur(ci,di,xi),this.pushPaused=!0,this.pullPaused=!0;var Ti={};li.live&&(this.push.on("complete",qi.pull.cancel.bind(qi.pull)),this.pull.on("complete",qi.push.cancel.bind(qi.push))),this.on("newListener",function(Ci){"change"===Ci?(Si(qi.pull,"change",pi),Si(qi.push,"change",fi)):"denied"===Ci?(Si(qi.pull,"denied",mi),Si(qi.push,"denied",_i)):"active"===Ci?(Si(qi.pull,"active",Ei),Si(qi.push,"active",vi)):"paused"===Ci&&(Si(qi.pull,"paused",yi),Si(qi.push,"paused",gi))}),this.on("removeListener",function(Ci){"change"===Ci?(qi.pull.removeListener("change",pi),qi.push.removeListener("change",fi)):"denied"===Ci?(qi.pull.removeListener("denied",mi),qi.push.removeListener("denied",_i)):"active"===Ci?(qi.pull.removeListener("active",Ei),qi.push.removeListener("active",vi)):"paused"===Ci&&(qi.pull.removeListener("paused",yi),qi.push.removeListener("paused",gi))}),this.pull.on("removeListener",ki("pull")),this.push.on("removeListener",ki("push"));var Ai=ea.all([this.push,this.pull]).then(function(Ci){var Li={push:Ci[0],pull:Ci[1]};return qi.emit("complete",Li),ui&&ui(null,Li),qi.removeAllListeners(),Li},function(Ci){if(qi.cancel(),ui?ui(Ci):qi.emit("error",Ci),qi.removeAllListeners(),ui)throw Ci});this.then=function(Ci,Li){return Ai.then(Ci,Li)},this["catch"]=function(Ci){return Ai["catch"](Ci)}}var zr=I(C(11)),Xr=I(C(7)),Gr=I(C(1)),Vr=C(4),Kr=I(C(6)),Qr=I(C(5)),Jr=I(C(2)),Yr=I(C(10)),Zr=I(C(16)),ea="function"===typeof Promise?Promise:Xr,ta=Function.prototype.toString,na=ta.call(Object);X.prototype.get=function(di){var ci=H(di);return this._store[ci]},X.prototype.set=function(di,ci){var li=H(di);return this._store[li]=ci,!0},X.prototype.has=function(di){var ci=H(di);return ci in this._store},X.prototype["delete"]=function(di){var ci=H(di),li=ci in this._store;return delete this._store[ci],li},X.prototype.forEach=function(di){for(var ci=Object.keys(this._store),li=0,ui=ci.length;li<ui;li++){var pi=ci[li],fi=this._store[pi];pi=z(pi),di(fi,pi)}},Object.defineProperty(X.prototype,"size",{get:function(){return Object.keys(this._store).length}}),G.prototype.add=function(di){return this._store.set(di,!0)},G.prototype.has=function(di){return this._store.has(di)},G.prototype.forEach=function(di){this._store.forEach(function(ci,li){di(li)})},Object.defineProperty(G.prototype,"size",{get:function(){return this._store.size}});var sa,ra;(function(){if("undefined"===typeof Symbol||"undefined"===typeof Map||"undefined"===typeof Set)return!1;var di=Object.getOwnPropertyDescriptor(Map,Symbol.species);return di&&"get"in di&&Map[Symbol.species]===Map})()?(sa=Set,ra=Map):(sa=G,ra=X);var aa=6,oa;if(Z())oa=!1;else try{localStorage.setItem("_pouch_check_localstorage",1),oa=!!localStorage.getItem("_pouch_check_localstorage")}catch(di){oa=!1}Kr(se,Vr.EventEmitter),se.prototype.addListener=function(di,ci,li,ui){function pi(){function mi(){_i=!1}if(fi._listeners[ci]){if(_i)return void(_i="waiting");_i=!0;var gi=K(ui,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary"]);li.changes(gi).on("change",function(yi){yi.seq>ui.since&&!ui.cancelled&&(ui.since=yi.seq,ui.onChange(yi))}).on("complete",function(){"waiting"===_i&&Qr(pi),_i=!1}).on("error",mi)}}if(!this._listeners[ci]){var fi=this,_i=!1;this._listeners[ci]=pi,this.on(di,pi)}},se.prototype.removeListener=function(di,ci){ci in this._listeners&&(Vr.EventEmitter.prototype.removeListener.call(this,di,this._listeners[ci]),delete this._listeners[ci])},se.prototype.notifyLocalWindows=function(di){Z()?chrome.storage.local.set({dbName:di}):te()&&(localStorage[di]="a"===localStorage[di]?"b":"a")},se.prototype.notify=function(di){this.emit(di),this.notifyLocalWindows(di)};var ia="function"===typeof Object.assign?Object.assign:function(ci){for(var li=Object(ci),ui=1,pi;ui<arguments.length;ui++)if(pi=arguments[ui],null!=pi)for(var fi in pi)Object.prototype.hasOwnProperty.call(pi,fi)&&(li[fi]=pi[fi]);return li};var da=ia;Kr(ce,Error),ce.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var ca=new ce(401,"unauthorized","Name or password is incorrect."),la=new ce(400,"bad_request","Missing JSON list of 'docs'"),pa=new ce(404,"not_found","missing"),ha=new ce(409,"conflict","Document update conflict"),fa=new ce(400,"bad_request","_id field must contain a string"),_a=new ce(412,"missing_id","_id is required for puts"),ma=new ce(400,"bad_request","Only reserved document ids may start with underscore."),ga=new ce(412,"precondition_failed","Database not open"),ya=new ce(500,"unknown_error","Database encountered an unknown error"),va=new ce(500,"badarg","Some query argument is invalid"),ba=new ce(400,"invalid_request","Request was invalid"),Ea=new ce(400,"query_parse_error","Some query parameter is invalid"),ka=new ce(500,"doc_validation","Bad special document member"),Sa=new ce(400,"bad_request","Something wrong with the request"),qa=new ce(400,"bad_request","Document must be a JSON object"),wa=new ce(404,"not_found","Database not found"),xa=new ce(500,"indexed_db_went_bad","unknown"),Ta=new ce(500,"web_sql_went_bad","unknown"),Aa=new ce(500,"levelDB_went_went_bad","unknown"),Ca=new ce(403,"forbidden","Forbidden by design doc validate_doc_update function"),La=new ce(400,"bad_request","Invalid rev format"),ja=new ce(412,"file_exists","The database could not be created, the file already exists."),Oa=new ce(412,"missing_stub","A pre-existing attachment stub wasn't found"),Da=new ce(413,"invalid_url","Provided URL is invalid"),Ia=function(){}.name;Ia?function(ci){return ci.name}:function(ci){return ci.toString().match(/^\s*function\s*(\S*)\s*\(/)[1]};var Ra=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],$a="queryKey",Pa=/(?:^|&)([^&=]*)=?([^&]*)/g,Fa=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Ba=zr.v4;Kr(Ve,Vr.EventEmitter),Ve.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},Ve.prototype.validateChanges=function(di){var ci=di.complete,li=this;ct._changesFilterPlugin?ct._changesFilterPlugin.validate(di,function(ui){return ui?ci(ui):void li.doChanges(di)}):li.doChanges(di)},Ve.prototype.doChanges=function(di){var ci=this,li=di.complete;if(di=F(di),"live"in di&&!("continuous"in di)&&(di.continuous=di.live),di.processChange=Ke,"latest"===di.since&&(di.since="now"),di.since||(di.since=0),"now"===di.since)return void this.db.info().then(function(fi){return ci.isCancelled?void li(null,{status:"cancelled"}):void(di.since=fi.update_seq,ci.doChanges(di))},li);if(!ct._changesFilterPlugin)["doc_ids","filter","selector","view"].forEach(function(fi){fi in di&&ae("warn","The \""+fi+"\" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.")});else if(ct._changesFilterPlugin.normalize(di),ct._changesFilterPlugin.shouldFilter(this,di))return ct._changesFilterPlugin.filter(this,di);"descending"in di||(di.descending=!1),di.limit=0===di.limit?1:di.limit,di.complete=li;var ui=this.db._changes(di);if(ui&&"function"===typeof ui.cancel){var pi=ci.cancel;ci.cancel=Gr(function(fi){ui.cancel(),pi.apply(this,fi)})}},Kr(rt,Vr.EventEmitter),rt.prototype.post=W("post",function(di,ci,li){return"function"===typeof ci&&(li=ci,ci={}),"object"!==("undefined"===typeof di?"undefined":babelHelpers.typeof(di))||Array.isArray(di)?li(le(qa)):void this.bulkDocs({docs:[di]},ci,Je(li,di._id))}),rt.prototype.put=W("put",function(di,ci,li){function pi(_i){"function"===typeof fi._put&&!1!==ci.new_edits?fi._put(di,ci,_i):fi.bulkDocs({docs:[di]},ci,Je(_i,di._id))}if("function"===typeof ci&&(li=ci,ci={}),"object"!==("undefined"===typeof di?"undefined":babelHelpers.typeof(di))||Array.isArray(di))return li(le(qa));if(me(di._id),ze(di._id)&&"function"===typeof this._putLocal)return di._deleted?this._removeLocal(di,li):this._putLocal(di,li);var fi=this;ci.force&&di._rev?(function(){var _i=di._rev.split("-"),mi=_i[1],gi=parseInt(_i[0],10),yi=gi+1,vi=we();di._revisions={start:yi,ids:[vi,mi]},di._rev=yi+"-"+vi,ci.new_edits=!1}(),pi(function(_i){var mi=_i?null:{ok:!0,id:di._id,rev:di._rev};li(_i,mi)})):pi(li)}),rt.prototype.putAttachment=W("putAttachment",function(di,ci,li,ui,pi){function fi(mi){var gi="_rev"in mi?parseInt(mi._rev,10):0;return mi._attachments=mi._attachments||{},mi._attachments[ci]={content_type:pi,data:ui,revpos:++gi},_i.put(mi)}var _i=this;return"function"===typeof pi&&(pi=ui,ui=li,li=null),"undefined"===typeof pi&&(pi=ui,ui=li,li=null),pi||ae("warn","Attachment",ci,"on document",di,"is missing content_type"),_i.get(di).then(function(mi){if(mi._rev!==li)throw le(ha);return fi(mi)},function(mi){if(mi.reason===pa.message)return fi({_id:di});throw mi})}),rt.prototype.removeAttachment=W("removeAttachment",function(di,ci,li,ui){var pi=this;pi.get(di,function(fi,_i){return fi?void ui(fi):_i._rev===li?_i._attachments?void(delete _i._attachments[ci],0===Object.keys(_i._attachments).length&&delete _i._attachments,pi.put(_i,ui)):ui():void ui(le(ha))})}),rt.prototype.remove=W("remove",function(di,ci,li,ui){var pi;"string"===typeof ci?(pi={_id:di,_rev:ci},"function"===typeof li&&(ui=li,li={})):(pi=di,"function"===typeof ci?(ui=ci,li={}):(ui=li,li=ci)),li=li||{},li.was_delete=!0;var fi={_id:pi._id,_rev:pi._rev||li.rev,_deleted:!0};return ze(fi._id)&&"function"===typeof this._removeLocal?this._removeLocal(pi,ui):void this.bulkDocs({docs:[fi]},li,Je(ui,fi._id))}),rt.prototype.revsDiff=W("revsDiff",function(di,ci,li){function ui(gi,yi){mi.has(gi)||mi.set(gi,{missing:[]}),mi.get(gi).missing.push(yi)}function pi(gi,yi){var vi=di[gi].slice(0);Te(yi,function(Ei,ki,Si,qi,wi){var xi=ki+"-"+Si,Ti=vi.indexOf(xi);-1===Ti||(vi.splice(Ti,1),"available"!==wi.status&&ui(gi,xi))}),vi.forEach(function(Ei){ui(gi,Ei)})}"function"===typeof ci&&(li=ci,ci={});var fi=Object.keys(di);if(!fi.length)return li(null,{});var _i=0,mi=new ra;fi.map(function(gi){this._getRevisionTree(gi,function(yi,vi){if(yi&&404===yi.status&&"missing"===yi.message)mi.set(gi,{missing:di[gi]});else{if(yi)return li(yi);pi(gi,vi)}if(++_i===fi.length){var Ei={};return mi.forEach(function(ki,Si){Ei[Si]=ki}),li(null,Ei)}})},this)}),rt.prototype.bulkGet=W("bulkGet",function(di,ci){Y(this,di,ci)}),rt.prototype.compactDocument=W("compactDocument",function(di,ci,li){var ui=this;this._getRevisionTree(di,function(pi,fi){if(pi)return li(pi);var _i=et(fi),mi=[],gi=[];Object.keys(_i).forEach(function(yi){_i[yi]>ci&&mi.push(yi)}),Te(fi,function(yi,vi,Ei,ki,Si){var qi=vi+"-"+Ei;"available"===Si.status&&-1!==mi.indexOf(qi)&&gi.push(qi)}),ui._doCompaction(di,gi,li)})}),rt.prototype.compact=W("compact",function(di,ci){"function"===typeof di&&(ci=di,di={});var li=this;di=di||{},li._compactionQueue=li._compactionQueue||[],li._compactionQueue.push({opts:di,callback:ci}),1===li._compactionQueue.length&&nt(li)}),rt.prototype._compact=function(di,ci){var pi=this,fi={return_docs:!1,last_seq:di.last_seq||0},_i=[];pi.changes(fi).on("change",function(mi){_i.push(pi.compactDocument(mi.id,0))}).on("complete",function(mi){var gi=mi.last_seq;ea.all(_i).then(function(){return Se(pi,"_local/compaction",function(vi){return(!vi.last_seq||vi.last_seq<gi)&&(vi.last_seq=gi,vi)})}).then(function(){ci(null,{ok:!0})})["catch"](ci)}).on("error",ci)},rt.prototype.get=W("get",function(di,ci,li){function ui(){var gi=[],yi=pi.length;return yi?void pi.forEach(function(vi){fi.get(di,{rev:vi,revs:ci.revs,latest:ci.latest,attachments:ci.attachments},function(Ei,ki){if(!Ei){for(var qi=0,wi=gi.length,Si;qi<wi;qi++)if(gi[qi].ok&&gi[qi].ok._rev===ki._rev){Si=!0;break}Si||gi.push({ok:ki})}else gi.push({missing:vi});yi--,yi||li(null,gi)})}):li(null,gi)}if("function"===typeof ci&&(li=ci,ci={}),"string"!==typeof di)return li(le(fa));if(ze(di)&&"function"===typeof this._getLocal)return this._getLocal(di,li);var pi=[],fi=this;if(ci.open_revs){if("all"===ci.open_revs)this._getRevisionTree(di,function(gi,yi){return gi?li(gi):void(pi=Ce(yi).map(function(vi){return vi.rev}),ui())});else if(Array.isArray(ci.open_revs)){pi=ci.open_revs;for(var _i=0,mi;_i<pi.length;_i++)if(mi=pi[_i],!("string"===typeof mi&&/^\d+-/.test(mi)))return li(le(La));ui()}else return li(le(ya,"function_clause"));return}return this._get(di,ci,function(gi,yi){if(gi)return gi.docId=di,li(gi);var vi=yi.doc,Ei=yi.metadata,ki=yi.ctx;if(ci.conflicts){var Si=Le(Ei);Si.length&&(vi._conflicts=Si)}if(He(Ei,vi._rev)&&(vi._deleted=!0),ci.revs||ci.revs_info){for(var qi=vi._rev.split("-"),wi=parseInt(qi[0],10),xi=qi[1],Ti=Oe(Ei.rev_tree),Ai=null,Ci=0;Ci<Ti.length;Ci++){var Li=Ti[Ci],ji=Li.ids.map(function(Fi){return Fi.id}).indexOf(xi);(ji===wi-1||!Ai&&-1!==ji)&&(Ai=Li)}var Di=Ai.ids.map(function(Fi){return Fi.id}).indexOf(vi._rev.split("-")[1])+1,Ii=Ai.ids.length-Di;if(Ai.ids.splice(Di,Ii),Ai.ids.reverse(),ci.revs&&(vi._revisions={start:Ai.pos+Ai.ids.length-1,ids:Ai.ids.map(function(Fi){return Fi.id})}),ci.revs_info){var Ni=Ai.pos+Ai.ids.length;vi._revs_info=Ai.ids.map(function(Fi){return Ni--,{rev:Ni+"-"+Fi.id,status:Fi.opts.status}})}}if(ci.attachments&&vi._attachments){var Ri=vi._attachments,$i=Object.keys(Ri).length;if(0===$i)return li(null,vi);Object.keys(Ri).forEach(function(Fi){this._getAttachment(vi._id,Fi,Ri[Fi],{rev:vi._rev,binary:ci.binary,ctx:ki},function(Bi,Ui){var Mi=vi._attachments[Fi];Mi.data=Ui,delete Mi.stub,delete Mi.length,--$i||li(null,vi)})},fi)}else{if(vi._attachments)for(var Pi in vi._attachments)vi._attachments.hasOwnProperty(Pi)&&(vi._attachments[Pi].stub=!0);li(null,vi)}})}),rt.prototype.getAttachment=W("getAttachment",function(di,ci,li,ui){var pi=this;li instanceof Function&&(ui=li,li={}),this._get(di,li,function(fi,_i){return fi?ui(fi):_i.doc._attachments&&_i.doc._attachments[ci]?void(li.ctx=_i.ctx,li.binary=!0,pi._getAttachment(di,ci,_i.doc._attachments[ci],li,ui)):ui(le(pa))})}),rt.prototype.allDocs=W("allDocs",function(di,ci){if("function"===typeof di&&(ci=di,di={}),di.skip="undefined"===typeof di.skip?0:di.skip,di.start_key&&(di.startkey=di.start_key),di.end_key&&(di.endkey=di.end_key),"keys"in di){if(!Array.isArray(di.keys))return ci(new TypeError("options.keys must be an array"));var li=["startkey","endkey","key"].filter(function(ui){return ui in di})[0];if(li)return void ci(le(Ea,"Query parameter `"+li+"` is not compatible with multi-get"));if(!ge(this))return tt(this,di,ci)}return this._allDocs(di,ci)}),rt.prototype.changes=function(di,ci){return"function"===typeof di&&(ci=di,di={}),new Ve(this,di,ci)},rt.prototype.close=W("close",function(di){return this._closed=!0,this.emit("closed"),this._close(di)}),rt.prototype.info=W("info",function(di){var ci=this;this._info(function(li,ui){return li?di(li):void(ui.db_name=ui.db_name||ci.name,ui.auto_compaction=!(!ci.auto_compaction||ge(ci)),ui.adapter=ci.adapter,di(null,ui))})}),rt.prototype.id=W("id",function(di){return this._id(di)}),rt.prototype.type=function(){return"function"===typeof this._type?this._type():this.adapter},rt.prototype.bulkDocs=W("bulkDocs",function(di,ci,li){if("function"===typeof ci&&(li=ci,ci={}),ci=ci||{},Array.isArray(di)&&(di={docs:di}),!di||!di.docs||!Array.isArray(di.docs))return li(le(la));for(var ui=0;ui<di.docs.length;++ui)if("object"!==babelHelpers.typeof(di.docs[ui])||Array.isArray(di.docs[ui]))return li(le(qa));var pi;if(di.docs.forEach(function(mi){mi._attachments&&Object.keys(mi._attachments).forEach(function(gi){pi=pi||st(gi),mi._attachments[gi].content_type||ae("warn","Attachment",gi,"on document",mi._id,"is missing content_type")})}),pi)return li(le(Sa,pi));"new_edits"in ci||("new_edits"in di?ci.new_edits=di.new_edits:ci.new_edits=!0);var fi=this;ci.new_edits||ge(fi)||di.docs.sort(Ze),Ye(di.docs);var _i=di.docs.map(function(mi){return mi._id});return this._bulkDocs(di,ci,function(mi,gi){if(mi)return li(mi);if(ci.new_edits||(gi=gi.filter(function(Ei){return Ei.error})),!ge(fi))for(var yi=0,vi=gi.length;yi<vi;yi++)gi[yi].id=gi[yi].id||_i[yi];li(null,gi)})}),rt.prototype.registerDependentDatabase=W("registerDependentDatabase",function(di,ci){var ui=new this.constructor(di,this.__opts);Se(this,"_local/_pouch_dependentDbs",function(pi){return(pi.dependentDbs=pi.dependentDbs||{},!pi.dependentDbs[di])&&(pi.dependentDbs[di]=!0,pi)}).then(function(){ci(null,{db:ui})})["catch"](ci)}),rt.prototype.destroy=W("destroy",function(di,ci){function li(){ui._destroy(di,function(fi,_i){return fi?ci(fi):void(ui._destroyed=!0,ui.emit("destroyed"),ci(null,_i||{ok:!0}))})}"function"===typeof di&&(ci=di,di={});var ui=this,pi=!("use_prefix"in ui)||ui.use_prefix;return ge(ui)?li():void ui.get("_local/_pouch_dependentDbs",function(fi,_i){if(fi)return 404===fi.status?li():ci(fi);var mi=_i.dependentDbs,gi=ui.constructor,yi=Object.keys(mi).map(function(vi){var Ei=pi?vi.replace(new RegExp("^"+gi.prefix),""):vi;return new gi(Ei,ui.__opts).destroy()});ea.all(yi).then(li,ci)})}),at.prototype.execute=function(){var di;if(this.failed)for(;di=this.queue.shift();)di(this.failed);else for(;di=this.queue.shift();)di()},at.prototype.fail=function(di){this.failed=di,this.execute()},at.prototype.ready=function(di){this.isReady=!0,this.db=di,this.execute()},at.prototype.addTask=function(di){this.queue.push(di),this.failed&&this.execute()},Kr(ct,rt),ct.adapters={},ct.preferredAdapters=[],ct.prefix="_pouch_";var Ua=new Vr.EventEmitter;(function(di){Object.keys(Vr.EventEmitter.prototype).forEach(function(li){"function"===typeof Vr.EventEmitter.prototype[li]&&(di[li]=Ua[li].bind(Ua))});var ci=di._destructionListeners=new ra;di.on("ref",function(ui){ci.has(ui.name)||ci.set(ui.name,[]),ci.get(ui.name).push(ui)}),di.on("unref",function(ui){if(ci.has(ui.name)){var pi=ci.get(ui.name),fi=pi.indexOf(ui);0>fi||(pi.splice(fi,1),1<pi.length?ci.set(ui.name,pi):ci["delete"](ui.name))}}),di.on("destroyed",function(ui){if(ci.has(ui)){var pi=ci.get(ui);ci["delete"](ui),pi.forEach(function(fi){fi.emit("destroyed",!0)})}})})(ct),ct.adapter=function(di,ci,li){ci.valid()&&(ct.adapters[di]=ci,li&&ct.preferredAdapters.push(di))},ct.plugin=function(di){if("function"===typeof di)di(ct);else if("object"!==("undefined"===typeof di?"undefined":babelHelpers.typeof(di))||0===Object.keys(di).length)throw new Error("Invalid plugin: got \""+di+"\", expected an object or a function");else Object.keys(di).forEach(function(ci){ct.prototype[ci]=di[ci]});return this.__defaults&&(ct.__defaults=da({},this.__defaults)),ct},ct.defaults=function(di){function ci(li,ui){return this instanceof ci?void(ui=ui||{},li&&"object"===("undefined"===typeof li?"undefined":babelHelpers.typeof(li))&&(ui=li,li=ui.name,delete ui.name),ui=da({},ci.__defaults,ui),ct.call(this,li,ui)):new ci(li,ui)}return Kr(ci,ct),ci.preferredAdapters=ct.preferredAdapters.slice(),Object.keys(ct).forEach(function(li){li in ci||(ci[li]=ct[li])}),ci.__defaults=da({},this.__defaults,di),ci};var Wa=["$or","$nor","$not"],Ha=-324,za=3,Xa="",Ga={$elemMatch:function(ci,li,ui,pi){return!!Array.isArray(pi)&&0!==pi.length&&("object"===babelHelpers.typeof(pi[0])?pi.some(function(fi){return Bt(fi,li,Object.keys(li))}):pi.some(function(fi){return Ut(li,ci,ui,fi)}))},$allMatch:function(ci,li,ui,pi){return!!Array.isArray(pi)&&0!==pi.length&&("object"===babelHelpers.typeof(pi[0])?pi.every(function(fi){return Bt(fi,li,Object.keys(li))}):pi.every(function(fi){return Ut(li,ci,ui,fi)}))},$eq:function(ci,li,ui,pi){return zt(pi)&&0===xt(pi,li)},$gte:function(ci,li,ui,pi){return zt(pi)&&0<=xt(pi,li)},$gt:function(ci,li,ui,pi){return zt(pi)&&0<xt(pi,li)},$lte:function(ci,li,ui,pi){return zt(pi)&&0>=xt(pi,li)},$lt:function(ci,li,ui,pi){return zt(pi)&&0>xt(pi,li)},$exists:function(ci,li,ui,pi){return li?zt(pi):!zt(pi)},$mod:function(ci,li,ui,pi){return Ht(pi)&&Xt(pi,li)},$ne:function(ci,li,ui,pi){return li.every(function(fi){return 0!==xt(pi,fi)})},$in:function(ci,li,ui,pi){return Ht(pi)&&Gt(pi,li)},$nin:function(ci,li,ui,pi){return Ht(pi)&&!Gt(pi,li)},$size:function(ci,li,ui,pi){return Ht(pi)&&Kt(pi,li)},$all:function(ci,li,ui,pi){return Array.isArray(pi)&&Vt(pi,li)},$regex:function(ci,li,ui,pi){return Ht(pi)&&Qt(pi,li)},$type:function(ci,li,ui,pi){return Jt(pi,li)}};ct.plugin(function(di){di.debug=Jr;var ci={};di.on("debug",function(li){var ui=li[0],pi=li.slice(1);ci[ui]||(ci[ui]=Jr("pouchdb:"+ui)),ci[ui].apply(null,pi)})}),ct.plugin(function(di){di._changesFilterPlugin={validate:tn,normalize:nn,shouldFilter:sn,filter:rn}}),ct.version="6.3.4";var Va=on(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),Ka=on(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]),Qa=function(ci){return atob(ci)},Ja=function(ci){return btoa(ci)},Ya=D.setImmediate||D.setTimeout,Za=32768,eo=5,no="document-store",so="by-sequence",ro="attach-store",ao="attach-seq-store",oo="meta-store",io="local-store",co="detect-blob-support",uo=new se,po=!1,ho=[],fo=new ra,_o,mo=new ra;ns.valid=function(){var di="undefined"!==typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);return!di&&"undefined"!==typeof indexedDB&&"undefined"!==typeof IDBKeyRange};var yo=7,vo=ls("document-store"),bo=ls("by-sequence"),Eo=ls("attach-store"),ko=ls("local-store"),So=ls("metadata-store"),qo=ls("attach-seq-store"),wo=new ra,xo=new se,To=1,Ao="CREATE INDEX IF NOT EXISTS 'by-seq-deleted-idx' ON "+bo+" (seq, deleted)",Co="CREATE UNIQUE INDEX IF NOT EXISTS 'by-seq-doc-id-rev' ON "+bo+" (doc_id, rev)",Lo="CREATE INDEX IF NOT EXISTS 'doc-winningseq-idx' ON "+vo+" (winningseq)",jo="CREATE INDEX IF NOT EXISTS 'attach-seq-seq-idx' ON "+qo+" (seq)",Oo="CREATE UNIQUE INDEX IF NOT EXISTS 'attach-seq-digest-idx' ON "+qo+" (digest, seq)",Do=bo+".seq = "+vo+".winningseq",Io=bo+".seq AS seq, "+bo+".deleted AS deleted, "+bo+".json AS data, "+bo+".rev AS rev, "+vo+".json AS metadata";js.valid=function(){return!("function"!==typeof openDatabase)&&As()},js.use_prefix=!0;var Ro=function(){try{return new XMLHttpRequest,!0}catch(di){return!1}}(),$o=function(){},Po=25,Fo=50,Bo=5e3,Uo=1e4,Mo={};Ks.valid=function(){return!0};Kr(Qs,Error),Kr(Js,Error),Kr(Ys,Error);var Ho=ae.bind(null,"log"),zo=Array.isArray,Xo=JSON.parse;cr.prototype.add=function(di){return this.promise=this.promise["catch"](function(){}).then(function(){return di()}),this.promise},cr.prototype.finish=function(){return this.promise};var Go={},Vo=new cr,Ko=50,Qo={_sum:function(ci,li){return ir(li)},_count:function(ci,li){return li.length},_stats:function(ci,li){return{sum:ir(li),min:Math.min.apply(null,li),max:Math.max.apply(null,li),count:li.length,sumsqr:function(pi){for(var fi=0,_i=0,mi=pi.length,gi;_i<mi;_i++)gi=pi[_i],fi+=gi*gi;return fi}(li)}}},Yo=function(di,ci,li,ui){function pi(Wi,Hi,zi){try{Hi(zi)}catch(Xi){_r(Wi,Xi)}}function fi(Wi,Hi,zi,Xi,Gi){try{return{output:Hi(zi,Xi,Gi)}}catch(Vi){return _r(Wi,Vi),{error:Vi}}}function _i(Wi,Hi){var zi=xt(Wi.key,Hi.key);return 0===zi?xt(Wi.value,Hi.value):zi}function mi(Wi,Hi,zi){return(zi=zi||0,"number"===typeof Hi)?Wi.slice(zi,Hi+zi):0<zi?Wi.slice(zi):Wi}function gi(Wi){var Hi=Wi.value,zi=Hi&&"object"===("undefined"===typeof Hi?"undefined":babelHelpers.typeof(Hi))&&Hi._id||Wi.id;return zi}function yi(Wi){Wi.rows.forEach(function(Hi){var zi=Hi.doc&&Hi.doc._attachments;zi&&Object.keys(zi).forEach(function(Xi){var Gi=zi[Xi];zi[Xi].data=fn(Gi.data,Gi.content_type)})})}function vi(Wi){return function(Hi){return Wi.include_docs&&Wi.attachments&&Wi.binary&&yi(Hi),Hi}}function Ei(Wi,Hi,zi,Xi){var Gi=Hi[Wi];"undefined"!==typeof Gi&&(Xi&&(Gi=encodeURIComponent(JSON.stringify(Gi))),zi.push(Wi+"="+Gi))}function ki(Wi){if("undefined"!==typeof Wi){var Hi=+Wi;return isNaN(Hi)||Hi!==parseInt(Wi,10)?Wi:Hi}}function Si(Wi){return Wi.group_level=ki(Wi.group_level),Wi.limit=ki(Wi.limit),Wi.skip=ki(Wi.skip),Wi}function qi(Wi){if(Wi){if("number"!==typeof Wi)return new Qs("Invalid value for integer: \""+Wi+"\"");if(0>Wi)return new Qs("Invalid value for positive integer: \""+Wi+"\"")}}function wi(Wi,Hi){var zi=Wi.descending?"endkey":"startkey",Xi=Wi.descending?"startkey":"endkey";if("undefined"!==typeof Wi[zi]&&"undefined"!==typeof Wi[Xi]&&0<xt(Wi[zi],Wi[Xi]))throw new Qs("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");else if(Hi.reduce&&!1!==Wi.reduce)if(Wi.include_docs)throw new Qs("{include_docs:true} is invalid for reduce");else if(Wi.keys&&1<Wi.keys.length&&!Wi.group&&!Wi.group_level)throw new Qs("Multi-key fetches for reduce views must use {group: true}");["group_level","limit","skip"].forEach(function(Gi){var Vi=qi(Wi[Gi]);if(Vi)throw Vi})}function xi(Wi,Hi,zi){var Xi=[],Vi="GET",Gi;if(Ei("reduce",zi,Xi),Ei("include_docs",zi,Xi),Ei("attachments",zi,Xi),Ei("limit",zi,Xi),Ei("descending",zi,Xi),Ei("group",zi,Xi),Ei("group_level",zi,Xi),Ei("skip",zi,Xi),Ei("stale",zi,Xi),Ei("conflicts",zi,Xi),Ei("startkey",zi,Xi,!0),Ei("start_key",zi,Xi,!0),Ei("endkey",zi,Xi,!0),Ei("end_key",zi,Xi,!0),Ei("inclusive_end",zi,Xi),Ei("key",zi,Xi,!0),Xi=Xi.join("&"),Xi=""===Xi?"":"?"+Xi,"undefined"!==typeof zi.keys){var Qi="keys="+encodeURIComponent(JSON.stringify(zi.keys));Qi.length+Xi.length+1<=2e3?Xi+=("?"===Xi[0]?"&":"?")+Qi:(Vi="POST","string"===typeof Hi?Gi={keys:zi.keys}:Hi.keys=zi.keys)}if("string"===typeof Hi){var Ji=hr(Hi);return Wi.request({method:Vi,url:"_design/"+Ji[0]+"/_view/"+Ji[1]+Xi,body:Gi}).then(function(Yi){return Yi.rows.forEach(function(Zi){if(Zi.value&&Zi.value.error&&"builtin_reduce_error"===Zi.value.error)throw new Error(Zi.reason)}),Yi}).then(vi(zi))}return Gi=Gi||{},Object.keys(Hi).forEach(function(Yi){Gi[Yi]=Array.isArray(Hi[Yi])?Hi[Yi]:Hi[Yi].toString()}),Wi.request({method:"POST",url:"_temp_view"+Xi,body:Gi}).then(vi(zi))}function Ti(Wi,Hi,zi){return new ea(function(Xi,Gi){Wi._query(Hi,zi,function(Vi,Ki){return Vi?Gi(Vi):void Xi(Ki)})})}function Ai(Wi){return new ea(function(Hi,zi){Wi._viewCleanup(function(Xi,Gi){return Xi?zi(Xi):void Hi(Gi)})})}function Ci(Wi){return function(Hi){if(404===Hi.status)return Wi;throw Hi}}function Li(Wi,Hi,zi){function Gi(ed){return ed.keys.length?Hi.db.allDocs({keys:ed.keys,include_docs:!0}):ea.resolve({rows:[]})}function Vi(ed,td){for(var nd=[],sd=new sa,rd=0,ad=td.rows.length;rd<ad;rd++){var od=td.rows[rd],dd=od.doc;if(dd&&(nd.push(dd),sd.add(dd._id),dd._deleted=!Yi.has(dd._id),!dd._deleted)){var cd=Yi.get(dd._id);"value"in cd&&(dd.value=cd.value)}}var ld=ar(Yi);return ld.forEach(function(ud){if(!sd.has(ud)){var pd={_id:ud},hd=Yi.get(ud);"value"in hd&&(pd.value=hd.value),nd.push(pd)}}),ed.keys=rr(ld.concat(ed.keys)),nd.push(ed),nd}var Ki="_local/doc_"+Wi,Qi={_id:Ki,keys:[]},Ji=zi.get(Wi),Yi=Ji[0],Zi=Ji[1];return function(){return fr(Zi)?ea.resolve(Qi):Hi.db.get(Ki)["catch"](Ci(Qi))}().then(function(ed){return Gi(ed).then(function(td){return Vi(ed,td)})})}function ji(Wi,Hi,zi){var Xi="_local/lastSeq";return Wi.db.get(Xi)["catch"](Ci({_id:Xi,seq:0})).then(function(Gi){var Vi=ar(Hi);return ea.all(Vi.map(function(Ki){return Li(Ki,Wi,Hi)})).then(function(Ki){var Qi=fe(Ki);return Gi.seq=zi,Qi.push(Gi),Wi.db.bulkDocs({docs:Qi})})})}function Oi(Wi){var Hi="string"===typeof Wi?Wi:Wi.name,zi=Go[Hi];return zi||(zi=Go[Hi]=new cr),zi}function Di(Wi){return sr(Oi(Wi),function(){return Ii(Wi)})()}function Ii(Wi){function zi(td,nd){return function(){return ji(Wi,td,nd)}}function Xi(){return Wi.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:Zi,limit:Ko}).then(Gi)}function Gi(td){var nd=td.results;if(nd.length){var sd=Vi(nd);return ed.add(zi(sd,Zi)),nd.length<Ko?void 0:Xi()}}function Vi(td){for(var nd=new ra,sd=0,rd=td.length,ad;sd<rd;sd++){if(ad=td[sd],"_"!==ad.doc._id[0]){Qi=[],Ji=ad.doc,Ji._deleted||pi(Wi.sourceDB,Yi,Ji),Qi.sort(_i);var od=Ki(Qi);nd.set(ad.doc._id,[od,ad.changes])}Zi=ad.seq}return nd}function Ki(td){for(var nd=new ra,rd=0,ad=td.length,sd;rd<ad;rd++){var od=td[rd],dd=[od.key,od.id];0<rd&&0===xt(od.key,sd)&&dd.push(rd),nd.set(Ct(dd),od),sd=od.key}return nd}var Qi,Ji,Yi=ci(Wi.mapFun,function(td,nd){var sd={id:Ji._id,key:Tt(td)};"undefined"!==typeof nd&&null!==nd&&(sd.value=Tt(nd)),Qi.push(sd)}),Zi=Wi.seq||0,ed=new cr;return Xi().then(function(){return ed.finish()}).then(function(){Wi.seq=Zi})}function Ni(Wi,Hi,zi){0===zi.group_level&&delete zi.group_level;var Xi=zi.group||zi.group_level,Gi=li(Wi.reduceFun),Vi=[],Ki=isNaN(zi.group_level)?Number.POSITIVE_INFINITY:zi.group_level;Hi.forEach(function(ed){var td=Vi[Vi.length-1],nd=Xi?ed.key:null;return Xi&&Array.isArray(nd)&&(nd=nd.slice(0,Ki)),td&&0===xt(td.groupKey,nd)?(td.keys.push([ed.key,ed.id]),void td.values.push(ed.value)):void Vi.push({keys:[[ed.key,ed.id]],values:[ed.value],groupKey:nd})}),Hi=[];for(var Qi=0,Ji=Vi.length;Qi<Ji;Qi++){var Yi=Vi[Qi],Zi=fi(Wi.sourceDB,Gi,Yi.keys,Yi.values,!1);if(Zi.error&&Zi.error instanceof Ys)throw Zi.error;Hi.push({value:Zi.error?null:Zi.output,key:Yi.groupKey})}return{rows:mi(Hi,zi.limit,zi.skip)}}function Ri(Wi,Hi){return sr(Oi(Wi),function(){return $i(Wi,Hi)})()}function $i(Wi,Hi){function zi(rd){return rd.include_docs=!0,Wi.db.allDocs(rd).then(function(ad){return Gi=ad.total_rows,ad.rows.map(function(od){if("value"in od.doc&&"object"===babelHelpers.typeof(od.doc.value)&&null!==od.doc.value){var dd=Object.keys(od.doc.value).sort(),cd=["id","key","value"];if(!(dd<cd||dd>cd))return od.doc.value}var ld=Ot(od.doc._id);return{key:ld[0],id:ld[1],value:"value"in od.doc?od.doc.value:null}})})}function Xi(rd){var ad;if(ad=Vi?Ni(Wi,rd,Hi):{total_rows:Gi,offset:Ki,rows:rd},Hi.include_docs){var od=rr(rd.map(gi));return Wi.sourceDB.allDocs({keys:od,include_docs:!0,conflicts:Hi.conflicts,attachments:Hi.attachments,binary:Hi.binary}).then(function(dd){var cd=new ra;return dd.rows.forEach(function(ld){cd.set(ld.id,ld.doc)}),rd.forEach(function(ld){var ud=gi(ld),pd=cd.get(ud);pd&&(ld.doc=pd)}),ad})}return ad}var Vi=Wi.reduceFun&&!1!==Hi.reduce,Ki=Hi.skip||0,Gi;if("undefined"===typeof Hi.keys||Hi.keys.length||(Hi.limit=0,delete Hi.keys),"undefined"!==typeof Hi.keys){var Qi=Hi.keys,Ji=Qi.map(function(rd){var ad={startkey:Ct([rd]),endkey:Ct([rd,{}])};return zi(ad)});return ea.all(Ji).then(fe).then(Xi)}var Yi={descending:Hi.descending},Zi,ed;if("start_key"in Hi&&(Zi=Hi.start_key),"startkey"in Hi&&(Zi=Hi.startkey),"end_key"in Hi&&(ed=Hi.end_key),"endkey"in Hi&&(ed=Hi.endkey),"undefined"!==typeof Zi&&(Yi.startkey=Hi.descending?Ct([Zi,{}]):Ct([Zi])),"undefined"!==typeof ed){var td=!1!==Hi.inclusive_end;Hi.descending&&(td=!td),Yi.endkey=Ct(td?[ed,{}]:[ed])}if("undefined"!==typeof Hi.key){var nd=Ct([Hi.key]),sd=Ct([Hi.key,{}]);Yi.descending?(Yi.endkey=nd,Yi.startkey=sd):(Yi.startkey=nd,Yi.endkey=sd)}return Vi||("number"===typeof Hi.limit&&(Yi.limit=Hi.limit),Yi.skip=Ki),zi(Yi).then(Xi)}function Pi(Wi){return Wi.request({method:"POST",url:"_view_cleanup"})}function Fi(Wi){return Wi.get("_local/"+di).then(function(Hi){var zi=new ra;Object.keys(Hi.views).forEach(function(Gi){var Vi=hr(Gi),Ki="_design/"+Vi[0],Qi=Vi[1],Ji=zi.get(Ki);Ji||(Ji=new sa,zi.set(Ki,Ji)),Ji.add(Qi)});var Xi={keys:ar(zi),include_docs:!0};return Wi.allDocs(Xi).then(function(Gi){var Vi={};Gi.rows.forEach(function(Ji){var Yi=Ji.key.substring(8);zi.get(Ji.key).forEach(function(Zi){var ed=Yi+"/"+Zi;Hi.views[ed]||(ed=Zi);var td=Object.keys(Hi.views[ed]),nd=Ji.doc&&Ji.doc.views&&Ji.doc.views[Zi];td.forEach(function(sd){Vi[sd]=Vi[sd]||nd})})});var Ki=Object.keys(Vi).filter(function(Ji){return!Vi[Ji]}),Qi=Ki.map(function(Ji){return sr(Oi(Ji),function(){return new Wi.constructor(Ji,Wi.__opts).destroy()})()});return ea.all(Qi).then(function(){return{ok:!0}})})},Ci({ok:!0}))}function Bi(Wi,Hi,zi){if("function"===typeof Wi._query)return Ti(Wi,Hi,zi);if(ge(Wi))return xi(Wi,Hi,zi);if("string"!==typeof Hi)return wi(zi,Hi),Vo.add(function(){var Qi=pr(Wi,"temp_view/temp_view",Hi.map,Hi.reduce,!0,di);return Qi.then(function(Ji){return nr(Di(Ji).then(function(){return Ri(Ji,zi)}),function(){return Ji.db.destroy()})})}),Vo.finish();var Xi=Hi,Gi=hr(Xi),Vi=Gi[0],Ki=Gi[1];return Wi.get("_design/"+Vi).then(function(Qi){var Ji=Qi.views&&Qi.views[Ki];if(!Ji)throw new Js("ddoc "+Qi._id+" has no view named "+Ki);ui(Qi,Ki),wi(zi,Ji);var Yi=pr(Wi,Xi,Ji.map,Ji.reduce,!1,di);return Yi.then(function(Zi){return"ok"===zi.stale||"update_after"===zi.stale?("update_after"===zi.stale&&Qr(function(){Di(Zi)}),Ri(Zi,zi)):Di(Zi).then(function(){return Ri(Zi,zi)})})})}var Mi=tr(function(){var Wi=this;return"function"===typeof Wi._viewCleanup?Ai(Wi):ge(Wi)?Pi(Wi):Fi(Wi)});return{query:function(Wi,Hi,zi){var Xi=this;"function"===typeof Hi&&(zi=Hi,Hi={}),Hi=Hi?Si(Hi):{},"function"===typeof Wi&&(Wi={map:Wi});var Gi=ea.resolve().then(function(){return Bi(Xi,Wi,Hi)});return Zs(Gi,zi),Gi},viewCleanup:Mi}}("mrviews",function(di,ci){if("function"===typeof di&&2===di.length){return function(ui){return di(ui,ci)}}return dr(di.toString(),ci)},function(di){var ci=di.toString(),li=gr(ci);return li?li:dr(ci)},function(di,ci){var li=di.views&&di.views[ci];if("string"!==typeof li.map)throw new Js("ddoc "+di._id+" has no string view named "+ci+", instead found object of type: "+babelHelpers.typeof(li.map))}),ei=1,ti="pouchdb",ni=5,si=0;Lr.prototype.writeCheckpoint=function(di,ci){var li=this;return this.updateTarget(di,ci).then(function(){return li.updateSource(di,ci)})},Lr.prototype.updateTarget=function(di,ci){return this.opts.writeTargetCheckpoint?Cr(this.target,this.id,di,ci,this.returnValue):ea.resolve(!0)},Lr.prototype.updateSource=function(di,ci){if(this.opts.writeSourceCheckpoint){var li=this;return this.readOnlySource?ea.resolve(!0):Cr(this.src,this.id,di,ci,this.returnValue)["catch"](function(ui){if(Ir(ui))return li.readOnlySource=!0,!0;throw ui})}return ea.resolve(!0)};var ri={undefined:function(ci,li){return 0===xt(ci.last_seq,li.last_seq)?li.last_seq:0},1:function(ci,li){return jr(li,ci).last_seq}};Lr.prototype.getCheckpoint=function(){var di=this;return di.target.get(di.id).then(function(ci){return di.readOnlySource?ea.resolve(ci.last_seq):di.src.get(di.id).then(function(li){if(ci.version!==li.version)return si;var ui;return ui=ci.version?ci.version.toString():"undefined",ui in ri?ri[ui](ci,li):si},function(li){if(404===li.status&&ci.last_seq)return di.src.put({_id:di.id,last_seq:si}).then(function(){return si},function(ui){return Ir(ui)?(di.readOnlySource=!0,ci.last_seq):si});throw li})})["catch"](function(ci){if(404!==ci.status)throw ci;return si})};var oi=0;Kr(Fr,Vr.EventEmitter),Fr.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},Fr.prototype.ready=function(di,ci){function li(){pi.cancel()}var pi=this;pi._readyCalled||(pi._readyCalled=!0,di.once("destroyed",li),ci.once("destroyed",li),pi.once("complete",function(){di.removeListener("destroyed",li),ci.removeListener("destroyed",li)}))},Kr(Wr,Vr.EventEmitter),Wr.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},ct.plugin(function(ci){ci.adapter("idb",ns,!0)}).plugin(function(ci){ci.adapter("websql",js,!0)}).plugin(function(ci){ci.adapter("http",Ks,!1),ci.adapter("https",Ks,!1)}).plugin({query:function(di,ci,li){return Yo.query.call(this,di,ci,li)},viewCleanup:function(di){return Yo.viewCleanup.call(this,di)}}).plugin(function(di){di.replicate=Ur,di.sync=Mr,Object.defineProperty(di.prototype,"replicate",{get:function(){var li=this;return{from:function(pi,fi,_i){return li.constructor.replicate(pi,li,fi,_i)},to:function(pi,fi,_i){return li.constructor.replicate(li,pi,fi,_i)}}}}),di.prototype.sync=function(ci,li,ui){return this.constructor.sync(this,ci,li,ui)}}),L.exports=ct}).call(this,"undefined"===typeof global?"undefined"===typeof self?"undefined"===typeof window?{}:window:self:global)},{1:1,2:2,4:4,5:5,6:6,7:7,10:10,11:11,16:16}]},{},[17])(17)});</script><script>(function(p){if("object"===("undefined"===typeof exports?"undefined":babelHelpers.typeof(exports))&&"undefined"!==typeof module)module.exports=p();else if("function"===typeof define&&define.amd)define([],p);else{var _;_="undefined"===typeof window?"undefined"===typeof global?"undefined"===typeof self?this:self:global:window,_.pouchdbFind=p()}})(function(){var p;return function w(A,O,F){function D(N,E){if(!O[N]){if(!A[N]){var C="function"==typeof require&&require;if(!E&&C)return C(N,!0);if(S)return S(N,!0);var B=new Error("Cannot find module '"+N+"'");throw B.code="MODULE_NOT_FOUND",B}var M=O[N]={exports:{}};A[N][0].call(M.exports,function(T){var P=A[N][1][T];return D(P?P:T)},M,M.exports,w,A,O,F)}return O[N].exports}for(var S="function"==typeof require&&require,I=0;I<F.length;I++)D(F[I]);return D}({1:[function(w,A){"use strict";function F(N){if(!N)return"undefined";switch("undefined"===typeof N?"undefined":babelHelpers.typeof(N)){case"function":return N.toString();case"string":return N.toString();default:return JSON.stringify(N);}}var D=w(4),S=w(5),I=S.Promise;A.exports=function(N){var E=N.db,C=N.viewName,B=N.map,M=N.reduce,T=N.temporary,P=N.pluginName,V=F(B)+F(M)+"undefined";if(!T&&E._cachedViews){var L=E._cachedViews[V];if(L)return I.resolve(L)}return E.info().then(function(K){var U=K.db_name+"-mrview-"+(T?"temp":S.MD5(V));return D(E,"_local/"+P,function(R){R.views=R.views||{};var X=C;-1===X.indexOf("/")&&(X=C+"/"+C);var W=R.views[X]=R.views[X]||{};if(!W[U])return W[U]=!0,R}).then(function(){return E.registerDependentDatabase(U).then(function(R){var X=R.db;X.auto_compaction=!0;var W={name:U,db:X,sourceDB:E,adapter:E.adapter,mapFun:B,reduceFun:M};return W.db.get("_local/lastSeq")["catch"](function(H){if(404!==H.status)throw H}).then(function(H){return W.seq=H?H.seq:0,T||(E._cachedViews=E._cachedViews||{},E._cachedViews[V]=W,W.db.on("destroyed",function(){delete E._cachedViews[V]})),W})})})})}},{4:4,5:5}],2:[function(w,A){(function(F){"use strict";function D(ee){this.status=400,this.name="query_parse_error",this.message=ee,this.error=!0;try{Error.captureStackTrace(this,D)}catch(te){}}function S(ee){this.status=404,this.name="not_found",this.message=ee,this.error=!0;try{Error.captureStackTrace(this,S)}catch(te){}}function I(ee){return-1===ee.indexOf("/")?[ee,ee]:ee.split("/")}function N(ee){return 1===ee.length&&/^1-/.test(ee[0].rev)}function E(ee,te){var ne=U(ee.key,te.key);return 0===ne?U(ee.value,te.value):ne}function C(ee,te,ne){return(ne=ne||0,"number"===typeof te)?ee.slice(ne,te+ne):0<ne?ee.slice(ne):ee}function B(ee){var te=ee.value,ne=te&&"object"===("undefined"===typeof te?"undefined":babelHelpers.typeof(te))&&te._id||ee.id;return ne}function M(ee,te){try{ee.emit("error",te)}catch(ne){console.error("The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),console.error(te)}}function T(ee,te,ne){try{return{output:te.apply(null,ne)}}catch(se){return M(ee,se),{error:se}}}function P(ee,te){var ne=ee.descending?"endkey":"startkey",se=ee.descending?"startkey":"endkey";if("undefined"!==typeof ee[ne]&&"undefined"!==typeof ee[se]&&0<U(ee[ne],ee[se]))throw new D("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");else if(te.reduce&&!1!==ee.reduce)if(ee.include_docs)throw new D("{include_docs:true} is invalid for reduce");else if(ee.keys&&1<ee.keys.length&&!ee.group&&!ee.group_level)throw new D("Multi-key fetches for reduce views must use {group: true}");if(ee.group_level){if("number"!==typeof ee.group_level)throw new D("Invalid value for integer: \""+ee.group_level+"\"");if(0>ee.group_level)throw new D("Invalid value for positive integer: \""+ee.group_level+"\"")}}function V(ee){return function(te){if(404===te.status)return ee;throw te}}var K=w(26),z=w(3),U=K.collate,R=K.toIndexableString,X=K.normalizeKey,W=w(1);"undefined"!==typeof console&&"function"===typeof console.log?Function.prototype.bind.call(console.log,console):function(){};var G=w(5),J=G.Promise,Y={},Z=new z,Q=50;G.inherits(D,Error),G.inherits(S,Error),A.exports=function(ee){function te(ke,be,ve){function xe(Fe){return Fe.keys.length?be.db.allDocs({keys:Fe.keys,include_docs:!0}):J.resolve({rows:[]})}function $e(Fe,De){for(var Se=[],Ie={},Ne=0,Ee=De.rows.length;Ne<Ee;Ne++){var Ce=De.rows[Ne],Be=Ce.doc;if(Be&&(Se.push(Be),Ie[Be._id]=!0,Be._deleted=!Ae[Be._id],!Be._deleted)){var Me=Ae[Be._id];"value"in Me&&(Be.value=Me.value)}}var Te=Object.keys(Ae);return Te.forEach(function(Pe){if(!Ie[Pe]){var Ve={_id:Pe},Le=Ae[Pe];"value"in Le&&(Ve.value=Le.value),Se.push(Ve)}}),Fe.keys=G.uniq(Te.concat(Fe.keys)),Se.push(Fe),Se}var we="_local/doc_"+ke,je={_id:we,keys:[]},qe=ve[ke],Ae=qe.indexableKeysToKeyValues,Oe=qe.changes;return function(){return N(Oe)?J.resolve(je):be.db.get(we)["catch"](V(je))}().then(function(Fe){return xe(Fe).then(function(De){return $e(Fe,De)})})}function ne(ke,be,ve){var _e="_local/lastSeq";return ke.db.get(_e)["catch"](V({_id:_e,seq:0})).then(function(xe){var $e=Object.keys(be);return J.all($e.map(function(we){return te(we,ke,be)})).then(function(we){var je=G.flatten(we);return xe.seq=ve,je.push(xe),ke.db.bulkDocs({docs:je})})})}function se(ke){var be="string"===typeof ke?ke:ke.name,ve=Y[be];return ve||(ve=Y[be]=new z),ve}function ie(ke){return G.sequentialize(se(ke),function(){return de(ke)})()}function de(ke){function ve(qe,Ae){return function(){return ne(ke,qe,Ae)}}var _e,xe,$e=pe(ke.mapFun,function(qe,Ae){var Oe={id:xe._id,key:X(qe)};"undefined"!==typeof Ae&&null!==Ae&&(Oe.value=X(Ae)),_e.push(Oe)}),we=ke.seq||0,je=new z;return new J(function(qe,Ae){function Oe(){je.finish().then(function(){ke.seq=we,qe()})}function Fe(){ke.sourceDB.changes({conflicts:!0,include_docs:!0,style:"all_docs",since:we,limit:Q}).on("complete",function(Se){var Ie=Se.results;if(!Ie.length)return Oe();for(var Be,Ne={},Ee=0,Ce=Ie.length;Ee<Ce;Ee++){if(Be=Ie[Ee],"_"!==Be.doc._id[0]){_e=[],xe=Be.doc,xe._deleted||T(ke.sourceDB,$e,[xe]),_e.sort(E);for(var Te,Me={},Pe=0,Ve=_e.length;Pe<Ve;Pe++){var Le=_e[Pe],Ke=[Le.key,Le.id];0===U(Le.key,Te)&&Ke.push(Pe);var ze=R(Ke);Me[ze]=Le,Te=Le.key}Ne[Be.doc._id]={indexableKeysToKeyValues:Me,changes:Be.changes}}we=Be.seq}return je.add(ve(Ne,we)),Ie.length<Q?Oe():Fe()}).on("error",function(Se){Ae(Se)})}Fe()})}function oe(ke,be,ve){0===ve.group_level&&delete ve.group_level;var _e=ve.group||ve.group_level,xe=ye(ke.reduceFun),$e=[],we=ve.group_level;be.forEach(function(Fe){var De=$e[$e.length-1],Se=_e?Fe.key:null;return _e&&Array.isArray(Se)&&"number"===typeof we&&(Se=Se.length>we?Se.slice(0,we):Se),De&&0===U(De.key[0][0],Se)?(De.key.push([Se,Fe.id]),void De.value.push(Fe.value)):void $e.push({key:[[Se,Fe.id]],value:[Fe.value]})});for(var je=0,qe=$e.length;je<qe;je++){var Ae=$e[je],Oe=T(ke.sourceDB,xe,[Ae.key,Ae.value,!1]);if(Oe.error&&/BuiltInError/.test(Oe.error.constructor))throw Oe.error;Ae.value=Oe.error?null:Oe.output,Ae.key=Ae.key[0][0]}return{rows:C($e,ve.limit,ve.skip)}}function le(ke,be){return G.sequentialize(se(ke),function(){return ae(ke,be)})()}function ae(ke,be){function ve(Ie){return Ie.include_docs=!0,ke.db.allDocs(Ie).then(function(Ne){return xe=Ne.total_rows,Ne.rows.map(function(Ee){if("value"in Ee.doc&&"object"===babelHelpers.typeof(Ee.doc.value)&&null!==Ee.doc.value){var Ce=Object.keys(Ee.doc.value).sort(),Be=["id","key","value"];if(!(Ce<Be||Ce>Be))return Ee.doc.value}var Me=K.parseIndexableString(Ee.doc._id);return{key:Me[0],id:Me[1],value:"value"in Ee.doc?Ee.doc.value:null}})})}function _e(Ie){var Ne;if(Ne=$e?oe(ke,Ie,be):{total_rows:xe,offset:we,rows:Ie},be.include_docs){var Ee=G.uniq(Ie.map(B));return ke.sourceDB.allDocs({keys:Ee,include_docs:!0,conflicts:be.conflicts,attachments:be.attachments,binary:be.binary}).then(function(Ce){var Be={};return Ce.rows.forEach(function(Me){Me.doc&&(Be["$"+Me.id]=Me.doc)}),Ie.forEach(function(Me){var Te=B(Me),Pe=Be["$"+Te];Pe&&(Me.doc=Pe)}),Ne})}return Ne}var xe,$e=ke.reduceFun&&!1!==be.reduce,we=be.skip||0;"undefined"===typeof be.keys||be.keys.length||(be.limit=0,delete be.keys);var je=function(Ne){return Ne.reduce(function(Ee,Ce){return Ee.concat(Ce)})};if("undefined"!==typeof be.keys){var qe=be.keys,Ae=qe.map(function(Ie){var Ne={startkey:R([Ie]),endkey:R([Ie,{}])};return ve(Ne)});return J.all(Ae).then(je).then(_e)}var Oe={descending:be.descending};if("undefined"!==typeof be.startkey&&(Oe.startkey=be.descending?R([be.startkey,{}]):R([be.startkey])),"undefined"!==typeof be.endkey){var Fe=!1!==be.inclusive_end;be.descending&&(Fe=!Fe),Oe.endkey=R(Fe?[be.endkey,{}]:[be.endkey])}if("undefined"!==typeof be.key){var De=R([be.key]),Se=R([be.key,{}]);Oe.descending?(Oe.endkey=De,Oe.startkey=Se):(Oe.startkey=De,Oe.endkey=Se)}return $e||("number"===typeof be.limit&&(Oe.limit=be.limit),Oe.skip=we),ve(Oe).then(_e)}function ue(ke){return ke.get("_local/"+fe).then(function(be){var ve={};Object.keys(be.views).forEach(function(xe){var $e=I(xe),we="_design/"+$e[0],je=$e[1];ve[we]=ve[we]||{},ve[we][je]=!0});var _e={keys:Object.keys(ve),include_docs:!0};return ke.allDocs(_e).then(function(xe){var $e={};xe.rows.forEach(function(qe){var Ae=qe.key.substring(8);Object.keys(ve[qe.key]).forEach(function(Oe){var Fe=Ae+"/"+Oe;be.views[Fe]||(Fe=Oe);var De=Object.keys(be.views[Fe]),Se=qe.doc&&qe.doc.views&&qe.doc.views[Oe];De.forEach(function(Ie){$e[Ie]=$e[Ie]||Se})})});var we=Object.keys($e).filter(function(qe){return!$e[qe]}),je=we.map(function(qe){return G.sequentialize(se(qe),function(){return new ke.constructor(qe,ke.__opts).destroy()})()});return J.all(je).then(function(){return{ok:!0}})})},V({ok:!0}))}function ce(ke,be,ve){if("string"!==typeof be){P(ve,be);var _e={db:ke,viewName:"temp_view/temp_view",map:be.map,reduce:be.reduce,temporary:!0,pluginName:fe};return Z.add(function(){return W(_e).then(function(qe){return G.fin(ie(qe).then(function(){return le(qe,ve)}),function(){return qe.db.destroy()})})}),Z.finish()}var xe=be,$e=I(xe),we=$e[0],je=$e[1];return ke.get("_design/"+we).then(function(qe){var Ae=qe.views&&qe.views[je];if(!Ae)throw new S("ddoc "+qe._id+" has no view named "+je);ge(qe,je),P(ve,Ae);var Oe={db:ke,viewName:xe,map:Ae.map,reduce:Ae.reduce,pluginName:fe};return W(Oe).then(function(Fe){return"ok"===ve.stale||"update_after"===ve.stale?("update_after"===ve.stale&&F.nextTick(function(){ie(Fe)}),le(Fe,ve)):ie(Fe).then(function(){return le(Fe,ve)})})})}var fe=ee.name,pe=ee.mapper,ye=ee.reducer,ge=ee.ddocValidator,me=G.callbackify(function(){var ke=this;return ue(ke)});return{query:function(be,ve,_e){var xe=this;"function"===typeof ve&&(_e=ve,ve={}),ve=G.extend(!0,{},ve),"function"===typeof be&&(be={map:be});var $e=J.resolve().then(function(){return ce(xe,be,ve)});return G.promisedCallback($e,_e),$e},viewCleanup:me}}}).call(this,w(34))},{1:1,3:3,5:5,26:26,34:34}],3:[function(w,A){"use strict";function F(){this.promise=new D(function(S){S()})}var D=w(5).Promise;F.prototype.add=function(S){return this.promise=this.promise["catch"](function(){}).then(function(){return S()}),this.promise},F.prototype.finish=function(){return this.promise},A.exports=F},{5:5}],4:[function(w,A){"use strict";var F=w(31).upsert;A.exports=function(D,S,I){return F.apply(D,[S,I])}},{31:31}],5:[function(w,A,O){(function(F){"use strict";O.Promise=w(29),O.inherits=w(23),O.extend=w(28);var D=w(18);O.promisedCallback=function(N,E){return E&&N.then(function(C){F.nextTick(function(){E(null,C)})},function(C){F.nextTick(function(){E(C)})}),N},O.callbackify=function(N){return D(function(E){var C=E.pop(),B=N.apply(this,E);return"function"===typeof C&&O.promisedCallback(B,C),B})},O.fin=function(N,E){return N.then(function(C){var B=E();return"function"===typeof B.then?B.then(function(){return C}):C},function(C){var B=E();if("function"===typeof B.then)return B.then(function(){throw C});throw C})},O.sequentialize=function(N,E){return function(){var C=arguments,B=this;return N.add(function(){return E.apply(B,C)})}},O.flatten=function(N){for(var E=[],C=0,B=N.length;C<B;C++)E=E.concat(N[C]);return E},O.uniq=function(N){for(var E={},C=0,B=N.length;C<B;C++)E["$"+N[C]]=!0;var M=Object.keys(E),T=Array(M.length);for(C=0,B=M.length;C<B;C++)T[C]=M[C].substring(1);return T};var S=w(19),I=w(35);O.MD5=function(N){return F.browser?I.hash(N):S.createHash("md5").update(N).digest("hex")}}).call(this,w(34))},{18:18,19:19,23:23,28:28,29:29,34:34,35:35}],6:[function(w,A,O){"use strict";var N=w(16);O.createIndex=function(E,C,B){C=N(C),E.request({method:"POST",url:"_index",body:C},B)},O.find=function(E,C,B){E.request({method:"POST",url:"_find",body:C},B)},O.getIndexes=function(E,C){E.request({method:"GET",url:"_index"},C)},O.deleteIndex=function(E,C,B){var M=C.ddoc,T=C.type||"json",P=C.name;if(!M)return B(new Error("you must provide an index's ddoc"));if(!P)return B(new Error("you must provide an index's name"));var V="_index/"+[M,T,P].map(encodeURIComponent).join("/");E.request({method:"DELETE",url:V},B)}},{16:16}],7:[function(w,A){"use strict";function F(K,z){return function(U){for(var R=[],X=0,W=K.length;X<W;X++){for(var Z,H=V(K[X]),G=U,J=0,Y=H.length;J<Y&&(Z=H[J],G=G[Z],!!G);J++);R.push(G)}z(R)}}function D(K,z){var U=V(K);return function(R){for(var G,X=R,W=0,H=U.length;W<H;W++)if(G=U[W],X=X[G],!X)return;z(X)}}function S(K,z){return function(U){z(U[K])}}function I(K,z){return function(U){for(var R=[],X=0,W=K.length;X<W;X++)R.push(U[K[X]]);z(R)}}function N(K){for(var R,z=0,U=K.length;z<U;z++)if(R=K[z],-1!==R.indexOf("."))return!1;return!0}function E(K,z){var U=N(K),R=1===K.length;return U?R?S(K[0],z):I(K,z):R?D(K[0],z):F(K,z)}var T=w(15),P=w(2),V=T.parseField,L=P({name:"indexes",mapper:function(K,z){var U=Object.keys(K.fields);return E(U,z)},reducer:function(){throw new Error("reduce not supported")},ddocValidator:function(K,z){var U=K.views[z];if(!U.map||!U.map.fields)throw new Error("ddoc "+K._id+" with view "+z+" doesn't have map.fields defined. maybe it wasn't created by this plugin?")}});A.exports=L},{2:2,15:15}],8:[function(w,A){"use strict";function F(P,V,L){return N.upsert.call(P,V,L)}var S=w(17),I=S.log,N=w(31),E=w(7),C=w(15),B=C.validateIndex,M=C.massageIndexDef,T=w(16);A.exports=function(P,V){V=T(V);var K=S.clone(V.index);V.index=M(V.index),B(V.index);var z=S.MD5(JSON.stringify(V)),U=V.name||"idx-"+z,R=V.ddoc||"idx-"+z,X="_design/"+R,W=!1,H=!1;return I("creating index",X),F(P,X,function(G){return(G._rev&&"query"!==G.language&&(W=!0),G.language="query",G.views=G.views||{},H=!!G.views[U],!H)&&(G.views[U]={map:{fields:S.mergeObjects(V.index.fields)},reduce:"_count",options:{def:K}},G)}).then(function(){if(W)throw new Error("invalid language for ddoc with id \""+X+"\" (should be \"query\")")}).then(function(){return E.query.call(P,R+"/"+U,{limit:0,reduce:!1}).then(function(){return{id:X,name:U,result:H?"exists":"created"}})})}},{7:7,15:15,16:16,17:17,31:31}],9:[function(w,A){"use strict";var D=w(7),S=w(4);A.exports=function(I,N){if(!N.ddoc)throw new Error("you must supply an index.ddoc when deleting");if(!N.name)throw new Error("you must supply an index.name when deleting");var C=N.ddoc,B=N.name;return S(I,C,function(M){return 1===Object.keys(M.views).length&&M.views[B]?{_id:C,_deleted:!0}:(delete M.views[B],M)}).then(function(){return D.viewCleanup.apply(I)}).then(function(){return{ok:!0}})}},{4:4,7:7}],10:[function(w,A){"use strict";function F(Q){function ee(te){return Q.map(function(ne){var se=W(ne),ie=G(se),de=Y(te,ie);return de})}return function(te,ne){var se=ee(te.doc),ie=ee(ne.doc),de=U(se,ie);return 0===de?J.compare(te.doc._id,ne.doc._id):de}}function S(Q,ee,te){return te.every(function(ne){var se=ee[ne],ie=G(ne),de=Y(Q,ie);return X(ne)?N(ne,se,Q):I(se,Q,ie,de)})}function I(Q,ee,te,ne){return!Q||Object.keys(Q).every(function(se){var ie=Q[se];return E(se,ee,ie,te,ne)})}function N(Q,ee,te){return"$or"===Q?ee.some(function(ne){return S(te,ne,Object.keys(ne))}):"$not"===Q?!S(te,ee,Object.keys(ee)):!ee.find(function(ne){return S(te,ne,Object.keys(ne))})}function E(Q,ee,te,ne,se){if(!Z[Q])throw new Error("unknown operator \""+Q+"\" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type or $all");return Z[Q](ee,te,ne,se)}function C(Q){return"undefined"!==typeof Q&&null!==Q}function B(Q){return"undefined"!==typeof Q}function M(Q,ee){var te=ee[0],ne=ee[1];if(0===te)throw new Error("Bad divisor, cannot divide by zero");if(parseInt(te,10)!==te)throw new Error("Divisor is not an integer");if(parseInt(ne,10)!==ne)throw new Error("Modulus is not an integer");return parseInt(Q,10)===Q&&Q%te===ne}function T(Q,ee){return ee.some(function(te){return Q instanceof Array?-1<Q.indexOf(te):Q===te})}function P(Q,ee){return ee.every(function(te){return-1<Q.indexOf(te)})}function V(Q,ee){return Q.length===ee}function L(Q,ee){var te=new RegExp(ee);return te.test(Q)}function K(Q,ee){switch(ee){case"null":return null===Q;case"boolean":return"boolean"===typeof Q;case"number":return"number"===typeof Q;case"string":return"string"===typeof Q;case"array":return Q instanceof Array;case"object":return"[object Object]"==={}.toString.call(Q);}throw new Error(ee+" not supported as a type.Please use one of object, string, array, number, boolean or null.")}var z=w(24),U=w(26).collate,R=w(15),X=R.isCombinationalField,W=R.getKey,H=R.getValue,G=R.parseField,J=w(17),Y=J.getFieldFromDoc,Z={$elemMatch:function(ee,te,ne,se){return!!z(se)&&0!==se.length&&("object"===babelHelpers.typeof(se[0])?se.some(function(ie){return S(ie,te,Object.keys(te))}):se.some(function(ie){return I(te,ee,ne,ie)}))},$eq:function(ee,te,ne,se){return B(se)&&0===U(se,te)},$gte:function(ee,te,ne,se){return B(se)&&0<=U(se,te)},$gt:function(ee,te,ne,se){return B(se)&&0<U(se,te)},$lte:function(ee,te,ne,se){return B(se)&&0>=U(se,te)},$lt:function(ee,te,ne,se){return B(se)&&0>U(se,te)},$exists:function(ee,te,ne,se){return te?B(se):!B(se)},$mod:function(ee,te,ne,se){return C(se)&&M(se,te)},$ne:function(ee,te,ne,se){return te.every(function(ie){return 0!==U(se,ie)})},$in:function(ee,te,ne,se){return C(se)&&T(se,te)},$nin:function(ee,te,ne,se){return C(se)&&!T(se,te)},$size:function(ee,te,ne,se){return C(se)&&V(se,te)},$all:function(ee,te,ne,se){return z(se)&&P(se,te)},$regex:function(ee,te,ne,se){return C(se)&&L(se,te)},$type:function(ee,te,ne,se){return K(se,te)}};A.exports=function(Q,ee,te){if(Q=Q.filter(function(de){return S(de.doc,ee.selector,te)}),ee.sort){var ne=F(ee.sort);Q=Q.sort(ne),"string"!==typeof ee.sort[0]&&"desc"===H(ee.sort[0])&&(Q=Q.reverse())}if("limit"in ee||"skip"in ee){var se=ee.skip||0,ie=("limit"in ee?ee.limit:Q.length)+se;Q=Q.slice(se,ie)}return Q}},{15:15,17:17,24:24,26:26}],11:[function(w,A){"use strict";function F(H){return H.ddoc.substring(8)+"/"+H.name}function D(H,G){var J=N(G);return J.descending?("endkey"in J&&"string"!==typeof J.endkey&&(J.endkey=""),"startkey"in J&&"string"!==typeof J.startkey&&(J.limit=0)):("startkey"in J&&"string"!==typeof J.startkey&&(J.startkey=""),"endkey"in J&&"string"!==typeof J.endkey&&(J.limit=0)),"key"in J&&"string"!==typeof J.key&&(J.limit=0),H.allDocs(J)}var I=w(17),N=I.clone,E=w(13),C=w(26).collate,B=w(7),M=w(12),T=w(15),P=w(10),V=T.massageSelector,L=T.massageSort,K=T.getValue,z=T.validateFindRequest,U=T.validateSort,R=T.reverseOptions,X=T.filterInclusiveStart,W=I.Promise;A.exports=function(H,G){return G.selector&&(G.selector=V(G.selector)),G.sort&&(G.sort=L(G.sort)),z(G),E(H).then(function(J){var Y=M(G,J.indexes),Z=Y.index;U(G,Z);var Q=I.extend(!0,{include_docs:!0,reduce:!1},Y.queryOpts);if("startkey"in Q&&"endkey"in Q&&0<C(Q.startkey,Q.endkey))return{docs:[]};var ee=G.sort&&"string"!==typeof G.sort[0]&&"desc"===K(G.sort[0]);return ee&&(Q.descending=!0,Q=R(Q)),Y.inMemoryFields.length||("limit"in G&&(Q.limit=G.limit),"skip"in G&&(Q.skip=G.skip)),W.resolve().then(function(){if("_all_docs"===Z.name)return D(H,Q);var te=F(Z);return B.query.call(H,te,Q)}).then(function(te){!1===Q.inclusive_start&&(te.rows=X(te.rows,Q.startkey,Z)),Y.inMemoryFields.length&&(te.rows=P(te.rows,G,Y.inMemoryFields));var ne={docs:te.rows.map(function(se){var ie=se.doc;return G.fields?I.pick(ie,G.fields):ie})};return Z.defaultUsed&&(ne.warning="no matching index found, create an index to optimize query time"),ne})})}},{7:7,10:10,12:12,13:13,15:15,17:17,26:26}],12:[function(w,A){"use strict";function F(ne,se){for(var le,ie=ne.def.fields.map(Y),de=0,oe=ie.length;de<oe;de++)if(le=ie[de],se===le)return!0;return!1}function D(ne,se){var ie=ne[se],de=Y(ie);return"$eq"!==de}function S(ne,se){var ie=se.def.fields.map(Y);return ne.slice().sort(function(de,oe){var le=ie.indexOf(de),ae=ie.indexOf(oe);return-1===le&&(le=Number.MAX_VALUE),-1===ae&&(ae=Number.MAX_VALUE),H.compare(le,ae)})}function I(ne,se,ie){ie=S(ie,ne);for(var ae,de=!1,oe=0,le=ie.length;oe<le;oe++){if(ae=ie[oe],de||!F(ne,ae))return ie.slice(oe);oe<le-1&&D(se,ae)&&(de=!0)}return[]}function N(ne){var se=[];return Object.keys(ne).forEach(function(ie){var de=ne[ie];Object.keys(de).forEach(function(oe){"$ne"===oe&&se.push(ie)})}),se}function E(ne,se,ie,de){var oe=H.flatten(ne,I(se,ie,de),N(ie));return S(H.uniq(oe),se)}function C(ne,se,ie){if(se){var de=H.oneArrayIsStrictSubArrayOfOther(se,ne),oe=H.oneArrayIsSubArrayOfOther(ie,ne);return de&&oe}return H.oneSetIsSubArrayOfOther(ie,ne)}function B(ne){return-1===te.indexOf(ne)}function M(ne,se){var ie=ne[0],de=se[ie],oe=Object.keys(de).some(function(ae){return!B(ae)});if(!oe)return!1;var le=1===Object.keys(de).length&&"$ne"===Y(de);return!le}function T(ne,se,ie,de){var oe=ne.def.fields.map(Y),le=C(oe,se,ie);return!!le&&M(oe,de)}function P(ne,se,ie,de){return de.reduce(function(oe,le){var ae=T(le,ie,se,ne);return ae&&oe.push(le),oe},[])}function V(ne,se,ie,de){var le=P(ne,se,ie,de);if(0===le.length){var ae=de[0];return ae.defaultUsed=!0,ae}if(1===le.length)return le[0];var ue=H.arrayToObject(se);return H.max(le,function(ce){for(var he,fe=ce.def.fields.map(Y),pe=0,ye=0,ge=fe.length;ye<ge;ye++)he=fe[ye],ue[he]&&pe++;return pe})}function L(ne,se){return"$eq"===ne?{key:se}:"$lte"===ne?{endkey:se}:"$gte"===ne?{startkey:se}:"$lt"===ne?{endkey:se,inclusive_end:!1}:"$gt"===ne?{startkey:se,inclusive_start:!1}:void 0}function K(ne,se){var ae,ie=Y(se.def.fields[0]),de=ne[ie],oe=[],le=Object.keys(de);return le.forEach(function(ue){if(B(ue))return void oe.push(ie);var ce=de[ue],fe=L(ue,ce);ae=ae?H.mergeObjects([ae,fe]):fe}),{queryOpts:ae,inMemoryFields:oe}}function z(ne,se){return"$eq"===ne?{startkey:se,endkey:se}:"$lte"===ne?{endkey:se}:"$gte"===ne?{startkey:se}:"$lt"===ne?{endkey:se,inclusive_end:!1}:"$gt"===ne?{startkey:se,inclusive_start:!1}:void 0}function U(ne,se){function ie(Oe){!1!==ue&&le.push(Q),!1!==ce&&ae.push(ee),oe=de.slice(Oe)}for(var ue,ce,de=se.def.fields.map(Y),oe=[],le=[],ae=[],fe=0,pe=de.length;fe<pe;fe++){var ye=de[fe],ge=ne[ye];if(!ge){ie(fe);break}else if(0<fe){if("$ne"in ge){ie(fe);break}var me=Object.keys(ne[de[fe-1]]),ke=H.arrayEquals(me,["$eq"]),be=H.arrayEquals(me,Object.keys(ge));if(("$gt"in ge||"$gte"in ge||"$lt"in ge||"$lte"in ge)&&!ke&&!be){ie(fe);break}}for(var _e=Object.keys(ge),xe=null,$e=0;$e<_e.length;$e++){var we=_e[$e],je=ge[we],qe=z(we,je);xe=xe?H.mergeObjects([xe,qe]):qe}le.push("startkey"in xe?xe.startkey:Q),ae.push("endkey"in xe?xe.endkey:ee),"inclusive_start"in xe&&(ue=xe.inclusive_start),"inclusive_end"in xe&&(ce=xe.inclusive_end)}var Ae={startkey:le,endkey:ae};return"undefined"!==typeof ue&&(Ae.inclusive_start=ue),"undefined"!==typeof ce&&(Ae.inclusive_end=ce),{queryOpts:Ae,inMemoryFields:oe}}function R(){return{queryOpts:{startkey:null},inMemoryFields:[]}}function X(ne,se){return se.defaultUsed?R(ne,se):1===se.def.fields.length?K(ne,se):U(ne,se)}var H=w(17),G=H.log,J=w(15),Y=J.getKey,Z=J.getUserFields,Q=null,ee={"":{}},te=["$eq","$gt","$gte","$lt","$lte"];A.exports=function(ne,se){G("planning query",ne);var ie=ne.selector,de=ne.sort,oe=Z(ie,de),le=oe.fields,ae=oe.sortOrder,ue=V(ie,le,ae,se),ce=X(ie,ue),fe=ce.queryOpts,pe=ce.inMemoryFields,ye=E(pe,ue,ie,le),ge={queryOpts:fe,index:ue,inMemoryFields:ye};return G("query plan",ge),ge}},{15:15,17:17}],13:[function(w,A){"use strict";var D=w(17),S=w(15),I=S.massageIndexDef;A.exports=function(N){return N.allDocs({startkey:"_design/",endkey:"_design/\uFFFF",include_docs:!0}).then(function(E){var C={indexes:[{ddoc:null,name:"_all_docs",type:"special",def:{fields:[{_id:"asc"}]}}]};return C.indexes=D.flatten(C.indexes,E.rows.filter(function(B){return"query"===B.doc.language}).map(function(B){var M=void 0===B.doc.views?[]:Object.keys(B.doc.views);return M.map(function(T){var P=B.doc.views[T];return{ddoc:B.id,name:T,type:"json",def:I(P.options.def)}})})),C.indexes.sort(function(B,M){return D.compare(B.name,M.name)}),C.total_rows=C.indexes.length,C})}},{15:15,17:17}],14:[function(w,A,O){"use strict";var F=w(17),D=F.callbackify;O.createIndex=D(w(8)),O.find=D(w(11)),O.getIndexes=D(w(13)),O.deleteIndex=D(w(9))},{8:8,9:9,11:11,13:13,17:17}],15:[function(w,A){"use strict";function F(J){return Object.keys(J)[0]}function D(J){return J[F(J)]}function I(J){return-1<G.indexOf(J)}function N(J,Y,Z){"undefined"!==typeof Z.$eq||("undefined"===typeof Z.$gte?"undefined"===typeof Z.$gt?Z[J]=Y:"$gte"===J?Y>Z.$gt&&(delete Z.$gt,Z.$gte=Y):Y>Z.$gt&&(Z.$gt=Y):"$gte"===J?Y>Z.$gte&&(Z.$gte=Y):Y>=Z.$gte&&(delete Z.$gte,Z.$gt=Y))}function E(J,Y,Z){"undefined"!==typeof Z.$eq||("undefined"===typeof Z.$lte?"undefined"===typeof Z.$lt?Z[J]=Y:"$lte"===J?Y<Z.$lt&&(delete Z.$lt,Z.$lte=Y):Y<Z.$lt&&(Z.$lt=Y):"$lte"===J?Y<Z.$lte&&(Z.$lte=Y):Y<=Z.$lte&&(delete Z.$lte,Z.$lt=Y))}function C(J,Y){"$ne"in Y?Y.$ne.push(J):Y.$ne=[J]}function B(J,Y){delete Y.$gt,delete Y.$gte,delete Y.$lt,delete Y.$lte,delete Y.$ne,Y.$eq=J}function M(J){var Y={};return J.forEach(function(Z){Object.keys(Z).forEach(function(Q){var ee=Z[Q];if("object"!==("undefined"===typeof ee?"undefined":babelHelpers.typeof(ee))&&(ee={$eq:ee}),I(Q))Y[Q]=ee instanceof Array?ee.map(function(ne){return M([ne])}):M([ee]);else{var te=Y[Q]=Y[Q]||{};Object.keys(ee).forEach(function(ne){var se=ee[ne];return"$gt"===ne||"$gte"===ne?N(ne,se,te):"$lt"===ne||"$lte"===ne?E(ne,se,te):"$ne"===ne?C(se,te):"$eq"===ne?B(se,te):void(te[ne]=se)})}})}),Y}function V(J,Y){for(var ee,Z=[],Q=0;Q<Y.def.fields.length;Q++)ee=F(Y.def.fields[Q]),Z.push(J[ee]);return Z}var W=w(17),H=w(26),G=["$or","$nor","$not"];A.exports={getKey:F,getValue:D,massageSort:function(J){if(!Array.isArray(J))throw new Error("invalid sort json - should be an array");return J.map(function(Y){if("string"===typeof Y){var Z={};return Z[Y]="asc",Z}return Y})},massageSelector:function(J){var Y=W.clone(J),Z=!1;"$and"in Y&&(Y=M(Y.$and),Z=!0),"$not"in Y&&(Y.$not=M([Y.$not]));for(var Q=Object.keys(Y),ee=0;ee<Q.length;ee++){var te=Q[ee],ne=Y[te];"object"!==("undefined"===typeof ne?"undefined":babelHelpers.typeof(ne))||null===ne?ne={$eq:ne}:"$ne"in ne&&!Z&&(ne.$ne=[ne.$ne]),Y[te]=ne}return Y},validateIndex:function(J){var Y=J.fields.filter(function(Z){return"asc"===D(Z)});if(0!==Y.length&&Y.length!==J.fields.length)throw new Error("unsupported mixed sorting")},validateFindRequest:function(J){if("object"!==babelHelpers.typeof(J.selector))throw new Error("you must provide a selector when you find()")},validateSort:function(J,Y){if(Y.defaultUsed&&J.sort){var Z=J.sort.filter(function(Q){return"_id"!==Object.keys(Q)[0]}).map(function(Q){return Object.keys(Q)[0]});if(0<Z.length)throw new Error("Cannot sort on field(s) \""+Z.join(",")+"\" when using the default index")}Y.defaultUsed},reverseOptions:function(J){var Y=W.clone(J);return delete Y.startkey,delete Y.endkey,delete Y.inclusive_start,delete Y.inclusive_end,"endkey"in J&&(Y.startkey=J.endkey),"startkey"in J&&(Y.endkey=J.startkey),"inclusive_start"in J&&(Y.inclusive_end=J.inclusive_start),"inclusive_end"in J&&(Y.inclusive_start=J.inclusive_end),Y},filterInclusiveStart:function(J,Y,Z){for(var Q=Z.def.fields,ee=0,te=J.length;ee<te;ee++){var ne=J[ee],se=V(ne.doc,Z);if(1===Q.length)se=se[0];else for(;se.length>Y.length;)se.pop();if(0<Math.abs(H.collate(se,Y)))break}return 0<ee?J.slice(ee):J},massageIndexDef:function(J){return J.fields=J.fields.map(function(Y){if("string"===typeof Y){var Z={};return Z[Y]="asc",Z}return Y}),J},parseField:W.parseField,getUserFields:function(J,Y){var ee,Z=Object.keys(J),Q=Y?Y.map(F):[];return(ee=Z.length>=Q.length?Z:Q,0===Q.length)?{fields:ee}:(ee=ee.sort(function(te,ne){var se=Q.indexOf(te);-1===se&&(se=Number.MAX_VALUE);var ie=Q.indexOf(ne);return-1===ie&&(ie=Number.MAX_VALUE),se<ie?-1:se>ie?1:0}),{fields:ee,sortOrder:Y.map(F)})},isCombinationalField:I}},{17:17,26:26}],16:[function(w,A){"use strict";var F=w(17),D=F.clone;A.exports=function(S){return S=D(S),S.index||(S.index={}),["type","name","ddoc"].forEach(function(I){S.index[I]&&(S[I]=S.index[I],delete S.index[I])}),S.fields&&(S.index.fields=S.fields,delete S.fields),S.type||(S.type="json"),S}},{17:17}],17:[function(w,A,O){(function(F){"use strict";var D=w(29);O.once=function(N){var E=!1;return O.getArguments(function(C){if(E)throw console.trace(),new Error("once called  more than once");else E=!0,N.apply(this,C)})},O.getArguments=function(N){return function(){for(var E=arguments.length,C=Array(E),B=-1;++B<E;)C[B]=arguments[B];return N.call(this,C)}},O.toPromise=function(N){return O.getArguments(function(E){var M,C=this,B="function"===typeof E[E.length-1]&&E.pop();B&&(M=function(V,L){F.nextTick(function(){B(V,L)})});var T=new D(function(P,V){try{var L=O.once(function(K,z){K?V(K):P(z)});E.push(L),N.apply(C,E)}catch(K){V(K)}});return M&&T.then(function(P){M(null,P)},M),T.cancel=function(){return this},T})},O.inherits=w(23),O.Promise=D,O.clone=function(N){return O.extend(!0,{},N)},O.extend=w(28),O.callbackify=function(N){return O.getArguments(function(E){var C=E.pop(),B=N.apply(this,E);return O.promisedCallback(B,C),B})},O.promisedCallback=function(N,E){return N.then(function(C){F.nextTick(function(){E(null,C)})},function(C){F.nextTick(function(){E(C)})}),N};var S=w(19),I=w(35);O.MD5=function(N){return F.browser?I.hash(N):S.createHash("md5").update(N).digest("hex")},O.flatten=O.getArguments(function(N){for(var M,E=[],C=0,B=N.length;C<B;C++)M=N[C],Array.isArray(M)?E=E.concat(O.flatten.apply(null,M)):E.push(M);return E}),O.mergeObjects=function(N){for(var E={},C=0,B=N.length;C<B;C++)E=O.extend(!0,E,N[C]);return E},O.getFieldFromDoc=function(N,E){for(var T,C=N,B=0,M=E.length;B<M&&(T=E[B],C=C[T],!!C);B++);return C},O.setFieldInDoc=function(N,E,C){for(var T,B=0,M=E.length;B<M-1;B++)T=E[B],N=N[T]={};N[E[M-1]]=C},O.parseField=function(N){for(var T,E=[],C="",B=0,M=N.length;B<M;B++)T=N[B],"."===T?0<B&&"\\"===N[B-1]?C=C.substring(0,C.length-1)+".":(E.push(C),C=""):C+=T;return E.push(C),E},O.pick=function(N,E){for(var C={},B=0,M=E.length;B<M;B++){var T=O.parseField(E[B]),P=O.getFieldFromDoc(N,T);"undefined"!==typeof P&&O.setFieldInDoc(C,T,P)}return C},O.oneArrayIsSubArrayOfOther=function(N,E){for(var C=0,B=Math.min(N.length,E.length);C<B;C++)if(N[C]!==E[C])return!1;return!0},O.oneArrayIsStrictSubArrayOfOther=function(N,E){return!(N.length>E.length)&&O.oneArrayIsSubArrayOfOther(N,E)},O.oneSetIsSubArrayOfOther=function(N,E){N=N.slice();for(var M,T,C=0,B=E.length;C<B&&(M=E[C],!!N.length);C++){if(T=N.indexOf(M),-1===T)return!1;N.splice(T,1)}return!0},O.compare=function(N,E){return N<E?-1:N>E?1:0},O.arrayToObject=function(N){for(var E={},C=0,B=N.length;C<B;C++)E[N[C]]=!0;return E},O.max=function(N,E){for(var C=null,B=-1,M=0,T=N.length;M<T;M++){var P=N[M],V=E(P);V>B&&(B=V,C=P)}return C},O.arrayEquals=function(N,E){if(N.length!==E.length)return!1;for(var C=0,B=N.length;C<B;C++)if(N[C]!==E[C])return!1;return!0},O.uniq=function(N){for(var E={},C=0;C<N.length;C++)E["$"+N[C]]=!0;return Object.keys(E).map(function(B){return B.substring(1)})},O.log=w(20)("pouchdb:find")}).call(this,w(34))},{19:19,20:20,23:23,28:28,29:29,34:34,35:35}],18:[function(w,A){"use strict";A.exports=function(D){return function(){var S=arguments.length;if(S){for(var I=[],N=-1;++N<S;)I[N]=arguments[N];return D.call(this,I)}return D.call(this,[])}}},{}],19:[function(){},{}],20:[function(w,A,O){function N(){var C;try{C=O.storage.debug}catch(B){}return C}O=A.exports=w(21),O.log=function(){return"object"===("undefined"===typeof console?"undefined":babelHelpers.typeof(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},O.formatArgs=function(){var C=arguments,B=this.useColors;if(C[0]=(B?"%c":"")+this.namespace+(B?" %c":" ")+C[0]+(B?"%c ":" ")+"+"+O.humanize(this.diff),!B)return C;var M="color: "+this.color;C=[C[0],M,"color: inherit"].concat(Array.prototype.slice.call(C,1));var T=0,P=0;return C[0].replace(/%[a-z%]/g,function(V){"%%"===V||(T++,"%c"===V&&(P=T))}),C.splice(P,0,M),C},O.save=function(C){try{null==C?O.storage.removeItem("debug"):O.storage.debug=C}catch(B){}},O.load=N,O.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)},O.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(C){}}(),O.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],O.formatters.j=function(C){return JSON.stringify(C)},O.enable(N())},{21:21}],21:[function(w,A,O){function F(){return O.colors[C++%O.colors.length]}O=A.exports=function(M){function T(){}function P(){var L=P,K=+new Date,z=K-(B||K);L.diff=z,L.prev=B,L.curr=K,B=K,null==L.useColors&&(L.useColors=O.useColors()),null==L.color&&L.useColors&&(L.color=F());var U=Array.prototype.slice.call(arguments);U[0]=O.coerce(U[0]),"string"!==typeof U[0]&&(U=["%o"].concat(U));var R=0;U[0]=U[0].replace(/%([a-z%])/g,function(W,H){if("%%"===W)return W;R++;var G=O.formatters[H];if("function"===typeof G){var J=U[R];W=G.call(L,J),U.splice(R,1),R--}return W}),"function"===typeof O.formatArgs&&(U=O.formatArgs.apply(L,U));var X=P.log||O.log||console.log.bind(console);X.apply(L,U)}T.enabled=!1,P.enabled=!0;var V=O.enabled(M)?P:T;return V.namespace=M,V},O.coerce=function(M){return M instanceof Error?M.stack||M.message:M},O.disable=function(){O.enable("")},O.enable=function(M){O.save(M);for(var T=(M||"").split(/[\s,]+/),P=T.length,V=0;V<P;V++)T[V]&&(M=T[V].replace(/\*/g,".*?"),"-"===M[0]?O.skips.push(new RegExp("^"+M.substr(1)+"$")):O.names.push(new RegExp("^"+M+"$")))},O.enabled=function(M){var T,P;for(T=0,P=O.skips.length;T<P;T++)if(O.skips[T].test(M))return!1;for(T=0,P=O.names.length;T<P;T++)if(O.names[T].test(M))return!0;return!1},O.humanize=w(25),O.names=[],O.skips=[],O.formatters={};var C=0,B},{25:25}],22:[function(w,A){(function(F){"use strict";function D(){T=!0;for(var V,L,K=P.length;K;){for(L=P,P=[],V=-1;++V<K;)L[V]();K=P.length}T=!1}var I=F.MutationObserver||F.WebKitMutationObserver,N;if(I){var E=0,C=new I(D),B=F.document.createTextNode("");C.observe(B,{characterData:!0}),N=function(){B.data=E=++E%2}}else if(!F.setImmediate&&"undefined"!==typeof F.MessageChannel){var M=new F.MessageChannel;M.port1.onmessage=D,N=function(){M.port2.postMessage(0)}}else N="document"in F&&"onreadystatechange"in F.document.createElement("script")?function(){var L=F.document.createElement("script");L.onreadystatechange=function(){D(),L.onreadystatechange=null,L.parentNode.removeChild(L),L=null},F.document.documentElement.appendChild(L)}:function(){setTimeout(D,0)};var T,P=[];A.exports=function(V){1!==P.push(V)||T||N()}}).call(this,"undefined"===typeof global?"undefined"===typeof self?"undefined"===typeof window?{}:window:self:global)},{}],23:[function(w,A){A.exports="function"===typeof Object.create?function(D,S){D.super_=S,D.prototype=Object.create(S.prototype,{constructor:{value:D,enumerable:!1,writable:!0,configurable:!0}})}:function(D,S){D.super_=S;var I=function(){};I.prototype=S.prototype,D.prototype=new I,D.prototype.constructor=D}},{}],24:[function(w,A){var F=Array.isArray,D=Object.prototype.toString;A.exports=F||function(S){return!!S&&"[object Array]"==D.call(S)}},{}],25:[function(w,A){function F(T){if(T=""+T,!(1e4<T.length)){var P=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(T);if(P){var V=parseFloat(P[1]),L=(P[2]||"ms").toLowerCase();return"years"===L||"year"===L||"yrs"===L||"yr"===L||"y"===L?V*M:"days"===L||"day"===L||"d"===L?V*B:"hours"===L||"hour"===L||"hrs"===L||"hr"===L||"h"===L?V*C:"minutes"===L||"minute"===L||"mins"===L||"min"===L||"m"===L?V*E:"seconds"===L||"second"===L||"secs"===L||"sec"===L||"s"===L?V*N:"milliseconds"===L||"millisecond"===L||"msecs"===L||"msec"===L||"ms"===L?V:void 0}}}function D(T){return T>=B?Math.round(T/B)+"d":T>=C?Math.round(T/C)+"h":T>=E?Math.round(T/E)+"m":T>=N?Math.round(T/N)+"s":T+"ms"}function S(T){return I(T,B,"day")||I(T,C,"hour")||I(T,E,"minute")||I(T,N,"second")||T+" ms"}function I(T,P,V){return T<P?void 0:T<1.5*P?Math.floor(T/P)+" "+V:Math.ceil(T/P)+" "+V+"s"}var N=1e3,E=60*N,C=60*E,B=24*C,M=365.25*B;A.exports=function(T,P){return P=P||{},"string"==typeof T?F(T):P.long?S(T):D(T)}},{}],26:[function(w,A,O){"use strict";function F(L){if(null!==L)switch("undefined"===typeof L?"undefined":babelHelpers.typeof(L)){case"boolean":return L?1:0;case"number":return B(L);case"string":return L.replace(/\u0002/g,"\x02\x02").replace(/\u0001/g,"\x01\x02").replace(/\u0000/g,"\x01\x01");case"object":var K=Array.isArray(L),z=K?L:Object.keys(L),U=-1,R=z.length,X="";if(K)for(;++U<R;)X+=O.toIndexableString(z[U]);else for(;++U<R;){var W=z[U];X+=O.toIndexableString(W)+O.toIndexableString(L[W])}return X;}return""}function D(L,K){var z=K,U,R="1"===L[K];if(R)U=0,K++;else{var X="0"===L[K];K++;var W="",H=L.substring(K,K+T),G=parseInt(H,10)+M;for(X&&(G=-G),K+=T;;){var J=L[K];if("\0"===J)break;else W+=J;K++}W=W.split("."),U=1===W.length?parseInt(W,10):parseFloat(W[0]+"."+W[1]),X&&(U-=10),0!==G&&(U=parseFloat(U+"e"+G))}return{num:U,length:K-z}}function S(L,K){var z=L.pop();if(K.length){var U=K[K.length-1];z===U.element&&(K.pop(),U=K[K.length-1]);var R=U.element,X=U.index;if(Array.isArray(R))R.push(z);else if(X===L.length-2){var W=L.pop();R[W]=z}else L.push(z)}}function I(L,K){for(var R,z=Math.min(L.length,K.length),U=0;U<z;U++)if(R=O.collate(L[U],K[U]),0!==R)return R;return L.length===K.length?0:L.length>K.length?1:-1}function N(L,K){return L===K?0:L>K?1:-1}function E(L,K){for(var W,z=Object.keys(L),U=Object.keys(K),R=Math.min(z.length,U.length),X=0;X<R;X++){if(W=O.collate(z[X],U[X]),0!==W)return W;if(W=O.collate(L[z[X]],K[U[X]]),0!==W)return W}return z.length===U.length?0:z.length>U.length?1:-1}function C(L){var z=["boolean","number","string","object"].indexOf("undefined"===typeof L?"undefined":babelHelpers.typeof(L));return~z?null===L?1:Array.isArray(L)?5:3>z?z+2:z+3:Array.isArray(L)?5:void 0}function B(L){if(0===L)return"1";var K=L.toExponential().split(/e\+?/),z=parseInt(K[1],10),U=0>L,R=U?"0":"2",X=(U?-z:z)-M,W=V.padLeft(X.toString(),"0",T);R+=P+W;var H=Math.abs(parseFloat(K[0]));U&&(H=10-H);var G=H.toFixed(20);return G=G.replace(/\.?0+$/,""),R+=P+G,R}var M=-324,T=3,P="",V=w(27);O.collate=function(L,K){if(L===K)return 0;L=O.normalizeKey(L),K=O.normalizeKey(K);var z=C(L),U=C(K);if(0!==z-U)return z-U;if(null===L)return 0;switch("undefined"===typeof L?"undefined":babelHelpers.typeof(L)){case"number":return L-K;case"boolean":return L===K?0:L<K?-1:1;case"string":return N(L,K);}return Array.isArray(L)?I(L,K):E(L,K)},O.normalizeKey=function(L){switch("undefined"===typeof L?"undefined":babelHelpers.typeof(L)){case"undefined":return null;case"number":return L===Infinity||L===-Infinity||isNaN(L)?null:L;case"object":var K=L;if(Array.isArray(L)){var z=L.length;L=Array(z);for(var U=0;U<z;U++)L[U]=O.normalizeKey(K[U])}else{if(L instanceof Date)return L.toJSON();if(null!==L)for(var R in L={},K)if(K.hasOwnProperty(R)){var X=K[R];"undefined"!==typeof X&&(L[R]=O.normalizeKey(X))}}}return L},O.toIndexableString=function(L){return L=O.normalizeKey(L),C(L)+P+F(L)+"\0"},O.parseIndexableString=function(L){for(var R,K=[],z=[],U=0;;){if(R=L[U++],"\0"===R){if(1===K.length)return K.pop();S(K,z);continue}switch(R){case"1":K.push(null);break;case"2":K.push("1"===L[U]),U++;break;case"3":var X=D(L,U);K.push(X.num),U+=X.length;break;case"4":for(var H,W="";H=L[U],"\0"!==H;)W+=H,U++;W=W.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"\x01").replace(/\u0002\u0002/g,"\x02"),K.push(W);break;case"5":var G={element:[],index:K.length};K.push(G.element),z.push(G);break;case"6":var J={element:{},index:K.length};K.push(J.element),z.push(J);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+R);}}}},{27:27}],27:[function(w,A,O){"use strict";function F(D,S,I){for(var N="",E=I-D.length;N.length<E;)N+=S;return N}O.padLeft=function(D,S,I){var N=F(D,S,I);return N+D},O.padRight=function(D,S,I){var N=F(D,S,I);return D+N},O.stringLexCompare=function(D,S){var I=D.length,N=S.length,E;for(E=0;E<I;E++){if(E===N)return 1;var C=D.charAt(E),B=S.charAt(E);if(C!==B)return C<B?-1:1}return I<N?-1:0},O.intToDecimalForm=function(D){var S=0>D,I="";do{var N=S?-Math.ceil(D%10):Math.floor(D%10);I=N+I,D=S?Math.ceil(D/10):Math.floor(D/10)}while(D);return S&&"0"!==I&&(I="-"+I),I}},{}],28:[function(w,A){"use strict";function F(K){return null===K?K+"":"object"===("undefined"===typeof K?"undefined":babelHelpers.typeof(K))||"function"===typeof K?C[P.call(K)]||"object":"undefined"===typeof K?"undefined":babelHelpers.typeof(K)}function D(K){return null!==K&&K===K.window}function S(K){if(!K||"object"!==F(K)||K.nodeType||D(K))return!1;try{if(K.constructor&&!V.call(K,"constructor")&&!V.call(K.constructor.prototype,"isPrototypeOf"))return!1}catch(U){return!1}for(var z in K);return z===void 0||V.call(K,z)}function I(K){return"function"===F(K)}function E(K,z,U){var R,X,W,H,G,J,ne,Y=z[0]||{},Z=1,Q=z.length,ee=!1,te=/\d+/;for("boolean"===typeof Y&&(ee=Y,Y=z[1]||{},Z=2),"object"===("undefined"===typeof Y?"undefined":babelHelpers.typeof(Y))||I(Y)||(Y={}),Q===Z&&(Y=this,--Z);Z<Q;Z++)if(null!=(R=z[Z]))for(X in ne=L(R),R)if(!(X in Object.prototype)){if(ne&&!te.test(X))continue;if(W=Y[X],H=R[X],Y===H)continue;ee&&H&&(S(H)||(G=L(H)))?(G?(G=!1,J=W&&L(W)?W:[]):J=W&&S(W)?W:{},K.push({args:[ee,J,H],result:{container:Y,key:X}})):void 0!==H&&!(L(R)&&I(H))&&(Y[X]=H)}U.container[U.key]=Y}for(var T,C={},B=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"],M=0;M<B.length;M++)T=B[M],C["[object "+T+"]"]=T.toLowerCase();var P=C.toString,V=C.hasOwnProperty,L=Array.isArray||function(K){return"array"===F(K)};A.exports=function(){for(var K=[],z=-1,U=arguments.length,R=Array(U);++z<U;)R[z]=arguments[z];var X={};K.push({args:R,result:{container:X,key:"key"}});for(var W;W=K.pop();)E(K,W.args,W.result);return X.key}},{}],29:[function(w,A){"use strict";var D=function(I){return I&&"object"===("undefined"===typeof I?"undefined":babelHelpers.typeof(I))&&"default"in I?I["default"]:I}(w(30)),S="function"===typeof Promise?Promise:D;A.exports=S},{30:30}],30:[function(w,A){"use strict";function F(){}function D(R){if("function"!==typeof R)throw new TypeError("resolver must be a function");this.state=U,this.queue=[],this.outcome=void 0,R!==F&&E(this,R)}function S(R,X,W){this.promise=R,"function"===typeof X&&(this.onFulfilled=X,this.callFulfilled=this.otherCallFulfilled),"function"===typeof W&&(this.onRejected=W,this.callRejected=this.otherCallRejected)}function I(R,X,W){V(function(){var H;try{H=X(W)}catch(G){return L.reject(R,G)}H===R?L.reject(R,new TypeError("Cannot resolve promise with itself")):L.resolve(R,H)})}function N(R){var X=R&&R.then;if(R&&"object"===("undefined"===typeof R?"undefined":babelHelpers.typeof(R))&&"function"===typeof X)return function(){X.apply(R,arguments)}}function E(R,X){function W(Z){J||(J=!0,L.reject(R,Z))}function H(Z){J||(J=!0,L.resolve(R,Z))}var J=!1,Y=C(function(){X(H,W)});"error"===Y.status&&W(Y.value)}function C(R,X){var W={};try{W.value=R(X),W.status="success"}catch(H){W.status="error",W.value=H}return W}var V=w(22),L={},K=["REJECTED"],z=["FULFILLED"],U=["PENDING"];A.exports=D,D.prototype["catch"]=function(R){return this.then(null,R)},D.prototype.then=function(R,X){if("function"!==typeof R&&this.state===z||"function"!==typeof X&&this.state===K)return this;var W=new this.constructor(F);if(this.state!==U){var H=this.state===z?R:X;I(W,H,this.outcome)}else this.queue.push(new S(W,R,X));return W},S.prototype.callFulfilled=function(R){L.resolve(this.promise,R)},S.prototype.otherCallFulfilled=function(R){I(this.promise,this.onFulfilled,R)},S.prototype.callRejected=function(R){L.reject(this.promise,R)},S.prototype.otherCallRejected=function(R){I(this.promise,this.onRejected,R)},L.resolve=function(R,X){var W=C(N,X);if("error"===W.status)return L.reject(R,W.value);var H=W.value;if(H)E(R,H);else{R.state=z,R.outcome=X;for(var G=-1,J=R.queue.length;++G<J;)R.queue[G].callFulfilled(X)}return R},L.reject=function(R,X){R.state=K,R.outcome=X;for(var W=-1,H=R.queue.length;++W<H;)R.queue[W].callRejected(X);return R},D.resolve=function(R){return R instanceof this?R:L.resolve(new this(F),R)},D.reject=function(R){var X=new this(F);return L.reject(X,R)},D.all=function(R){function X(ee,te){W.resolve(ee).then(function(se){J[te]=se,++Y!==H||G||(G=!0,L.resolve(Q,J))},function(se){G||(G=!0,L.reject(Q,se))})}var W=this;if("[object Array]"!==Object.prototype.toString.call(R))return this.reject(new TypeError("must be an array"));var H=R.length,G=!1;if(!H)return this.resolve([]);for(var J=Array(H),Y=0,Z=-1,Q=new this(F);++Z<H;)X(R[Z],Z);return Q},D.race=function(R){function X(Z){W.resolve(Z).then(function(Q){G||(G=!0,L.resolve(Y,Q))},function(Q){G||(G=!0,L.reject(Y,Q))})}var W=this;if("[object Array]"!==Object.prototype.toString.call(R))return this.reject(new TypeError("must be an array"));var H=R.length,G=!1;if(!H)return this.resolve([]);for(var J=-1,Y=new this(F);++J<H;)X(R[J]);return Y}},{22:22}],31:[function(w,A,O){"use strict";function F(I,N,E){return"string"===typeof N?I.get(N)["catch"](function(C){if(404!==C.status)throw C;return{}}).then(function(C){var B=C._rev,M=E(C);return M?(M._id=N,M._rev=B,D(I,M,E)):{updated:!1,rev:B}}):S.reject(new Error("doc id is required"))}function D(I,N,E){return I.put(N).then(function(C){return{updated:!0,rev:C.rev}},function(C){if(409!==C.status)throw C;return F(I,N._id,E)})}var S=w(33);O.upsert=function(N,E,C){var B=this,M=F(B,N,E);return"function"===typeof C?void M.then(function(T){C(null,T)},C):M},O.putIfNotExists=function(N,E,C){var B=this;"string"!==typeof N&&(C=E,E=N,N=E._id);var T=F(B,N,function(V){return!V._rev&&E});return"function"===typeof C?void T.then(function(P){C(null,P)},C):T},"undefined"!==typeof window&&window.PouchDB&&window.PouchDB.plugin(O)},{33:33}],32:[function(w,A,O){arguments[4][30][0].apply(O,arguments)},{22:22,30:30}],33:[function(w,A,O){arguments[4][29][0].apply(O,arguments)},{29:29,32:32}],34:[function(w,A){function F(){C&&B&&(C=!1,B.length?E=B.concat(E):M=-1,E.length&&D())}function D(){if(!C){var T=setTimeout(F);C=!0;for(var P=E.length;P;){for(B=E,E=[];++M<P;)B&&B[M].run();M=-1,P=E.length}B=null,C=!1,clearTimeout(T)}}function S(T,P){this.fun=T,this.array=P}function I(){}var N=A.exports={},E=[],C=!1,B,M=-1;N.nextTick=function(T){var P=Array(arguments.length-1);if(1<arguments.length)for(var V=1;V<arguments.length;V++)P[V-1]=arguments[V];E.push(new S(T,P)),1!==E.length||C||setTimeout(D,0)},S.prototype.run=function(){this.fun.apply(null,this.array)},N.title="browser",N.browser=!0,N.env={},N.argv=[],N.version="",N.versions={},N.on=I,N.addListener=I,N.once=I,N.off=I,N.removeListener=I,N.removeAllListeners=I,N.emit=I,N.binding=function(){throw new Error("process.binding is not supported")},N.cwd=function(){return"/"},N.chdir=function(){throw new Error("process.chdir is not supported")},N.umask=function(){return 0}},{}],35:[function(w,A,O){(function(F){if("object"===("undefined"===typeof O?"undefined":babelHelpers.typeof(O)))A.exports=F();else if("function"===typeof p&&p.amd)p(F);else{var D;try{D=window}catch(S){D=self}D.SparkMD5=F()}})(function(){"use strict";var D=function(W,H){return 4294967295&W+H},S=function(W,H,G,J,Y,Z){return H=D(D(H,W),D(J,Z)),D(H<<Y|H>>>32-Y,G)},I=function(W,H,G,J,Y,Z,Q){return S(H&G|~H&J,W,H,Y,Z,Q)},N=function(W,H,G,J,Y,Z,Q){return S(H&J|G&~J,W,H,Y,Z,Q)},E=function(W,H,G,J,Y,Z,Q){return S(H^G^J,W,H,Y,Z,Q)},C=function(W,H,G,J,Y,Z,Q){return S(G^(H|~J),W,H,Y,Z,Q)},B=function(W,H){var G=W[0],J=W[1],Y=W[2],Z=W[3];G=I(G,J,Y,Z,H[0],7,-680876936),Z=I(Z,G,J,Y,H[1],12,-389564586),Y=I(Y,Z,G,J,H[2],17,606105819),J=I(J,Y,Z,G,H[3],22,-1044525330),G=I(G,J,Y,Z,H[4],7,-176418897),Z=I(Z,G,J,Y,H[5],12,1200080426),Y=I(Y,Z,G,J,H[6],17,-1473231341),J=I(J,Y,Z,G,H[7],22,-45705983),G=I(G,J,Y,Z,H[8],7,1770035416),Z=I(Z,G,J,Y,H[9],12,-1958414417),Y=I(Y,Z,G,J,H[10],17,-42063),J=I(J,Y,Z,G,H[11],22,-1990404162),G=I(G,J,Y,Z,H[12],7,1804603682),Z=I(Z,G,J,Y,H[13],12,-40341101),Y=I(Y,Z,G,J,H[14],17,-1502002290),J=I(J,Y,Z,G,H[15],22,1236535329),G=N(G,J,Y,Z,H[1],5,-165796510),Z=N(Z,G,J,Y,H[6],9,-1069501632),Y=N(Y,Z,G,J,H[11],14,643717713),J=N(J,Y,Z,G,H[0],20,-373897302),G=N(G,J,Y,Z,H[5],5,-701558691),Z=N(Z,G,J,Y,H[10],9,38016083),Y=N(Y,Z,G,J,H[15],14,-660478335),J=N(J,Y,Z,G,H[4],20,-405537848),G=N(G,J,Y,Z,H[9],5,568446438),Z=N(Z,G,J,Y,H[14],9,-1019803690),Y=N(Y,Z,G,J,H[3],14,-187363961),J=N(J,Y,Z,G,H[8],20,1163531501),G=N(G,J,Y,Z,H[13],5,-1444681467),Z=N(Z,G,J,Y,H[2],9,-51403784),Y=N(Y,Z,G,J,H[7],14,1735328473),J=N(J,Y,Z,G,H[12],20,-1926607734),G=E(G,J,Y,Z,H[5],4,-378558),Z=E(Z,G,J,Y,H[8],11,-2022574463),Y=E(Y,Z,G,J,H[11],16,1839030562),J=E(J,Y,Z,G,H[14],23,-35309556),G=E(G,J,Y,Z,H[1],4,-1530992060),Z=E(Z,G,J,Y,H[4],11,1272893353),Y=E(Y,Z,G,J,H[7],16,-155497632),J=E(J,Y,Z,G,H[10],23,-1094730640),G=E(G,J,Y,Z,H[13],4,681279174),Z=E(Z,G,J,Y,H[0],11,-358537222),Y=E(Y,Z,G,J,H[3],16,-722521979),J=E(J,Y,Z,G,H[6],23,76029189),G=E(G,J,Y,Z,H[9],4,-640364487),Z=E(Z,G,J,Y,H[12],11,-421815835),Y=E(Y,Z,G,J,H[15],16,530742520),J=E(J,Y,Z,G,H[2],23,-995338651),G=C(G,J,Y,Z,H[0],6,-198630844),Z=C(Z,G,J,Y,H[7],10,1126891415),Y=C(Y,Z,G,J,H[14],15,-1416354905),J=C(J,Y,Z,G,H[5],21,-57434055),G=C(G,J,Y,Z,H[12],6,1700485571),Z=C(Z,G,J,Y,H[3],10,-1894986606),Y=C(Y,Z,G,J,H[10],15,-1051523),J=C(J,Y,Z,G,H[1],21,-2054922799),G=C(G,J,Y,Z,H[8],6,1873313359),Z=C(Z,G,J,Y,H[15],10,-30611744),Y=C(Y,Z,G,J,H[6],15,-1560198380),J=C(J,Y,Z,G,H[13],21,1309151649),G=C(G,J,Y,Z,H[4],6,-145523070),Z=C(Z,G,J,Y,H[11],10,-1120210379),Y=C(Y,Z,G,J,H[2],15,718787259),J=C(J,Y,Z,G,H[9],21,-343485551),W[0]=D(G,W[0]),W[1]=D(J,W[1]),W[2]=D(Y,W[2]),W[3]=D(Z,W[3])},M=function(W){var G,H=[];for(G=0;64>G;G+=4)H[G>>2]=W.charCodeAt(G)+(W.charCodeAt(G+1)<<8)+(W.charCodeAt(G+2)<<16)+(W.charCodeAt(G+3)<<24);return H},T=function(W){var G,H=[];for(G=0;64>G;G+=4)H[G>>2]=W[G]+(W[G+1]<<8)+(W[G+2]<<16)+(W[G+3]<<24);return H},P=function(W){var J,Y,Z,Q,ee,te,H=W.length,G=[1732584193,-271733879,-1732584194,271733878];for(J=64;J<=H;J+=64)B(G,M(W.substring(J-64,J)));for(W=W.substring(J-64),Y=W.length,Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],J=0;J<Y;J+=1)Z[J>>2]|=W.charCodeAt(J)<<(J%4<<3);if(Z[J>>2]|=128<<(J%4<<3),55<J)for(B(G,Z),J=0;16>J;J+=1)Z[J]=0;return Q=8*H,Q=Q.toString(16).match(/(.*?)(.{0,8})$/),ee=parseInt(Q[2],16),te=parseInt(Q[1],16)||0,Z[14]=ee,Z[15]=te,B(G,Z),G},V=function(W){var J,Y,Z,Q,ee,te,H=W.length,G=[1732584193,-271733879,-1732584194,271733878];for(J=64;J<=H;J+=64)B(G,T(W.subarray(J-64,J)));for(W=J-64<H?W.subarray(J-64):new Uint8Array(0),Y=W.length,Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],J=0;J<Y;J+=1)Z[J>>2]|=W[J]<<(J%4<<3);if(Z[J>>2]|=128<<(J%4<<3),55<J)for(B(G,Z),J=0;16>J;J+=1)Z[J]=0;return Q=8*H,Q=Q.toString(16).match(/(.*?)(.{0,8})$/),ee=parseInt(Q[2],16),te=parseInt(Q[1],16)||0,Z[14]=ee,Z[15]=te,B(G,Z),G},L=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],K=function(W){var G,H="";for(G=0;4>G;G+=1)H+=L[15&W>>8*G+4]+L[15&W>>8*G];return H},z=function(W){var H;for(H=0;H<W.length;H+=1)W[H]=K(W[H]);return W.join("")},R=function(){this.reset()};return"5d41402abc4b2a76b9719d911017c592"!==function(W){return z(P(W))}("hello")&&(D=function(W,H){var G=(65535&W)+(65535&H);return(W>>16)+(H>>16)+(G>>16)<<16|65535&G}),R.prototype.append=function(X){return /[\u0080-\uFFFF]/.test(X)&&(X=unescape(encodeURIComponent(X))),this.appendBinary(X),this},R.prototype.appendBinary=function(X){this._buff+=X,this._length+=X.length;var H,W=this._buff.length;for(H=64;H<=W;H+=64)B(this._state,M(this._buff.substring(H-64,H)));return this._buff=this._buff.substr(H-64),this},R.prototype.end=function(X){var G,Y,W=this._buff,H=W.length,J=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(G=0;G<H;G+=1)J[G>>2]|=W.charCodeAt(G)<<(G%4<<3);return this._finish(J,H),Y=X?this._state:z(this._state),this.reset(),Y},R.prototype._finish=function(X,W){var G,J,Y,H=W;if(X[H>>2]|=128<<(H%4<<3),55<H)for(B(this._state,X),H=0;16>H;H+=1)X[H]=0;G=8*this._length,G=G.toString(16).match(/(.*?)(.{0,8})$/),J=parseInt(G[2],16),Y=parseInt(G[1],16)||0,X[14]=J,X[15]=Y,B(this._state,X)},R.prototype.reset=function(){return this._buff="",this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},R.prototype.destroy=function(){delete this._state,delete this._buff,delete this._length},R.hash=function(X,W){/[\u0080-\uFFFF]/.test(X)&&(X=unescape(encodeURIComponent(X)));var H=P(X);return W?H:z(H)},R.hashBinary=function(X,W){var H=P(X);return W?H:z(H)},R.ArrayBuffer=function(){this.reset()},R.ArrayBuffer.prototype.append=function(X){var G,W=this._concatArrayBuffer(this._buff,X),H=W.length;for(this._length+=X.byteLength,G=64;G<=H;G+=64)B(this._state,T(W.subarray(G-64,G)));return this._buff=G-64<H?W.subarray(G-64):new Uint8Array(0),this},R.ArrayBuffer.prototype.end=function(X){var J,Y,W=this._buff,H=W.length,G=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(J=0;J<H;J+=1)G[J>>2]|=W[J]<<(J%4<<3);return this._finish(G,H),Y=X?this._state:z(this._state),this.reset(),Y},R.ArrayBuffer.prototype._finish=R.prototype._finish,R.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},R.ArrayBuffer.prototype.destroy=R.prototype.destroy,R.ArrayBuffer.prototype._concatArrayBuffer=function(X,W){var H=X.length,G=new Uint8Array(H+W.byteLength);return G.set(X),G.set(new Uint8Array(W),H),G},R.ArrayBuffer.hash=function(X,W){var H=V(new Uint8Array(X));return W?H:z(H)},R})},{}],36:[function(w,A){"use strict";var F=w(17),D=w(6),S=w(14),I={};I.createIndex=F.toPromise(function(N,E){if("object"!==("undefined"===typeof N?"undefined":babelHelpers.typeof(N)))return E(new Error("you must provide an index to create"));var C="http"===this.type()?D:S;C.createIndex(this,N,E)}),I.find=F.toPromise(function(N,E){if("undefined"===typeof E&&(E=N,N=void 0),"object"!==("undefined"===typeof N?"undefined":babelHelpers.typeof(N)))return E(new Error("you must provide search parameters to find()"));var C="http"===this.type()?D:S;C.find(this,N,E)}),I.getIndexes=F.toPromise(function(N){var E="http"===this.type()?D:S;E.getIndexes(this,N)}),I.deleteIndex=F.toPromise(function(N,E){if("object"!==("undefined"===typeof N?"undefined":babelHelpers.typeof(N)))return E(new Error("you must provide an index to delete"));var C="http"===this.type()?D:S;C.deleteIndex(this,N,E)}),A.exports=I,"undefined"!==typeof window&&window.PouchDB&&window.PouchDB.plugin(I)},{6:6,14:14,17:17}]},{},[36])(36)});</script></dom-module></div><dom-module id="shopping-list-replicator"><template><style>:host{display:block;padding:8px 8px;}paper-card{width:100%;padding:8px;}</style><paper-card heading="Replication Target"><iron-form id="replicationForm"><paper-input id="url" name="url" label="Database URL" value="{{url}}" required="" autofocus=""></paper-input><paper-input id="username" name="username" label="Username" value="{{username}}"></paper-input><paper-input type="password" id="password" name="password" label="Password" value="{{password}}"></paper-input><paper-button on-click="_submit" id="replicationFormSubmit" raised="">Save</paper-button></iron-form></paper-card><paper-toast id="toast"></paper-toast></template><script>var ShoppingListReplicator=function(a){function b(){return babelHelpers.classCallCheck(this,b),babelHelpers.possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return babelHelpers.inherits(b,a),babelHelpers.createClass(b,[{key:"_localConfigChanged",value:function(){this.localConfig.remoteDb&&(this.url=this.localConfig.remoteDb.url,this.localConfig.remoteDb.options.auth&&(this.username=this.localConfig.remoteDb.options.auth.username,this.password=this.localConfig.remoteDb.options.auth.password))}},{key:"_remoteDb",value:function(d){return d.remoteDb?new PouchDB(d.remoteDb.url,d.remoteDb.options):void 0}},{key:"_remoteDbChanged",value:function(){this.replicationHandler&&this.replicationHandler.cancel(),this.replicationHandler=this.db.sync(this.remoteDb,{live:!0,retry:!0}),this.$.toast.text="Live replication with remote database started",this.$.toast.open()}},{key:"_findLocalConfig",value:function(){var d=this;return this.db.get(this.localConfig._id).then(function(e){d._setLocalConfig(e)}).catch(function(e){if(404!=e.status)throw e})}},{key:"ready",value:function(){babelHelpers.get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"ready",this).call(this),this._findLocalConfig()}},{key:"_submit",value:function(){var d=this,e=this.localConfig;e.remoteDb={url:this.url,options:{}},this.username&&this.password&&(e.remoteDb.options.auth={username:this.username,password:this.password}),this.db.put(e).then(function(){d._findLocalConfig()})}}],[{key:"is",get:function(){return"shopping-list-replicator"}},{key:"properties",get:function(){return{url:{type:String,notify:!0},username:{type:String,notify:!0},password:{type:String,notify:!0},localConfig:{type:Object,readOnly:!0,notify:!0,observer:"_localConfigChanged",value:function(){return{_id:"_local/config"}}},remoteDb:{type:Object,readOnly:!0,notify:!0,computed:"_remoteDb(localConfig)",observer:"_remoteDbChanged"},replicationHandler:{type:Object,notify:!1}}}}]),b}(Polymer.Element);window.customElements.define(ShoppingListReplicator.is,ShoppingListReplicator);</script></dom-module></body></html>